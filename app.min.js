!function(e){var t={};function i(n){if(t[n])return t[n].exports;var s=t[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)i.d(n,s,function(t){return e[t]}.bind(null,s));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/greenfield",i(i.s=66)}([function(e,t,i){"use strict";i.d(t,"a",function(){return s});var n=i(8);class s{static create(e,t){return new s(e,t)}constructor(e,t){this.x=e,this.y=t}toVec4(){return n.a.create(this.x,this.y,0,1)}plus(e){return s.create(this.x+e.x,this.y+e.y)}minus(e){return s.create(this.x-e.x,this.y-e.y)}}},function(e,t,i){"use strict";i.r(t);class n{static parse(e){return new n(256*e>>0)}asInt(){return this._raw/256>>0}asDouble(){return this._raw/256}constructor(e){this._raw=e}}var s=n;class r{static uint(e){return{value:e,type:"u",size:4,optional:!1,_marshallArg:function(e){new Uint32Array(e.buffer,e.bufferOffset,1)[0]=this.value,e.bufferOffset+=this.size}}}static uintOptional(e){return{value:e,type:"u",size:4,optional:!0,_marshallArg:function(t){new Uint32Array(t.buffer,t.bufferOffset,1)[0]=null===e?0:this.value,t.bufferOffset+=this.size}}}static fileDescriptor(e){return{value:e,type:"h",size:0,optional:!1,_marshallArg:function(e){e.fds.push(this.value)}}}static fileDescriptorOptional(e){return{value:e,type:"h",size:0,optional:!0,_marshallArg:function(e){e.fds.push(this.value)}}}static int(e){return{value:e,type:"i",size:4,optional:!1,_marshallArg:function(e){new Int32Array(e.buffer,e.bufferOffset,1)[0]=this.value,e.bufferOffset+=this.size}}}static intOptional(e){return{value:e,type:"i",size:4,optional:!0,_marshallArg:function(t){new Int32Array(t.buffer,t.bufferOffset,1)[0]=null===e?0:this.value,t.bufferOffset+=this.size}}}static fixed(e){return{value:e,type:"f",size:4,optional:!1,_marshallArg:function(e){new Int32Array(e.buffer,e.bufferOffset,1)[0]=this.value._raw,e.bufferOffset+=this.size}}}static fixedOptional(e){return{value:e,type:"f",size:4,optional:!0,_marshallArg:function(t){new Int32Array(t.buffer,t.bufferOffset,1)[0]=null===e?0:this.value._raw,t.bufferOffset+=this.size}}}static object(e){return{value:e,type:"o",size:4,optional:!1,_marshallArg:function(e){new Uint32Array(e.buffer,e.bufferOffset,1)[0]=this.value.id,e.bufferOffset+=this.size}}}static objectOptional(e){return{value:e,type:"o",size:4,optional:!0,_marshallArg:function(t){new Uint32Array(t.buffer,t.bufferOffset,1)[0]=null===e?0:this.value.id,t.bufferOffset+=this.size}}}static newObject(){return{value:0,type:"n",size:4,optional:!1,_marshallArg:function(e){new Uint32Array(e.buffer,e.bufferOffset,1)[0]=this.value,e.bufferOffset+=this.size}}}static string(e){return{value:`${e}\0`,type:"s",size:4+(e.length+1+3&-4),optional:!1,_marshallArg:function(e){new Uint32Array(e.buffer,e.bufferOffset,1)[0]=this.value.length;const t=this.value.length,i=new Uint8Array(e.buffer,e.bufferOffset+4,t);for(let e=0;e<t;e++)i[e]=this.value[e].codePointAt(0);e.bufferOffset+=this.size}}}static stringOptional(e){return{value:`${e}\0`,type:"s",size:4+(null===e?0:e.length+1+3&-4),optional:!0,_marshallArg:function(e){if(null===this.value)new Uint32Array(e.buffer,e.bufferOffset,1)[0]=0;else{new Uint32Array(e.buffer,e.bufferOffset,1)[0]=this.value.length;const t=this.value.length,i=new Uint8Array(e.buffer,e.bufferOffset+4,t);for(let e=0;e<t;e++)i[e]=this.value[e].codePointAt(0)}e.bufferOffset+=this.size}}}static array(e){return{value:e,type:"a",size:4+(e.byteLength+3&-4),optional:!1,_marshallArg:function(e){new Uint32Array(e.buffer,e.bufferOffset,1)[0]=this.value.byteLength;const t=this.value.byteLength;new Uint8Array(e.buffer,e.bufferOffset+4,t).set(new Uint8Array(this.value.buffer,0,t)),e.bufferOffset+=this.size}}}static arrayOptional(e){return{value:e,type:"a",size:4+(null===e?0:e.byteLength+3&-4),optional:!0,_marshallArg:function(e){if(null===this.value)new Uint32Array(e.buffer,e.bufferOffset,1)[0]=0;else{new Uint32Array(e.buffer,e.bufferOffset,1)[0]=this.value.byteLength;const t=this.value.byteLength;new Uint8Array(e.buffer,e.bufferOffset+4,t).set(new Uint8Array(this.value.buffer,0,t))}e.bufferOffset+=this.size}}}static _checkMessageSize(e,t){if(e.consumed+t>e.size)throw new Error("Request too short.");e.consumed+=t}static u(e){return r._checkMessageSize(e,4),e.buffer[e.bufferOffset++]}static i(e){r._checkMessageSize(e,4);const t=new Int32Array(e.buffer.buffer,e.buffer.byteOffset+e.bufferOffset*Uint32Array.BYTES_PER_ELEMENT,1)[0];return e.bufferOffset+=1,t}static f(e){r._checkMessageSize(e,4);const t=new Int32Array(e.buffer.buffer,e.buffer.byteOffset+e.bufferOffset*Uint32Array.BYTES_PER_ELEMENT,1)[0];return e.bufferOffset+=1,new s(t>>0)}static o(e,t,i){r._checkMessageSize(e,4);const n=e.buffer[e.bufferOffset++];if(t&&0===n)return null;{const e=i.wlObjects[n];if(e)return e;throw new Error(`Unknown object id ${n}`)}}static n(e){return r._checkMessageSize(e,4),e.buffer[e.bufferOffset++]}static s(e,t){r._checkMessageSize(e,4);const i=e.buffer[e.bufferOffset++];if(t&&0===i)return null;{const t=i+3&-4;r._checkMessageSize(e,t);const n=new Uint8Array(e.buffer.buffer,e.buffer.byteOffset+e.bufferOffset*Uint32Array.BYTES_PER_ELEMENT,i-1);return e.bufferOffset+=t/4,String.fromCharCode(...n)}}static a(e,t){r._checkMessageSize(e,4);const i=e.buffer[e.bufferOffset++];if(t&&0===i)return null;{const t=i+3&-4;r._checkMessageSize(e,t);const n=e.buffer.buffer.slice(e.buffer.byteOffset+e.bufferOffset*Uint32Array.BYTES_PER_ELEMENT,e.buffer.byteOffset+e.bufferOffset*Uint32Array.BYTES_PER_ELEMENT+i);return e.bufferOffset+=t,n}}static h(e){if(e.fds.length>0)return e.fds.shift();throw new Error("Not enough file descriptors in message object.")}constructor(){this.wlObjects={},this.closed=!1,this._outMessages=[],this._inMessages=[]}marshallMsg(e,t,i,n){const s={buffer:new ArrayBuffer(i),fds:[],bufferOffset:0},r=new Uint32Array(s.buffer),o=new Uint16Array(s.buffer);r[0]=e,o[2]=t,o[3]=i,s.bufferOffset=8,n.forEach(e=>e._marshallArg(s)),this.onSend(s)}async message(e){if(!(this.closed||this._inMessages.push(e)>1)){for(;this._inMessages.length;){const e=this._inMessages[0];for(e.bufferOffset=0,e.consumed=0,e.size=0;e.bufferOffset<e.buffer.length;){const t=e.buffer[e.bufferOffset],i=e.buffer[e.bufferOffset+1];e.size=i>>>16;const n=65535&i;if(e.size>e.buffer.byteLength)throw new Error("Request buffer too small");const s=this.wlObjects[t];if(!s)throw new Error(`invalid object ${t}`);e.bufferOffset+=2,e.consumed=8;try{await s[n](e)}catch(e){throw console.error(`\nwlObject: ${s.constructor.name}[${n}](..)\nname: ${e.name} message: ${e.message} text: ${e.text}\nerror object stack: \n${e.stack}\n`),this.close(),e}if(this.closed)return}this._inMessages.shift()}this.flush()}}onSend(e){this.closed||this._outMessages.push(e)}flush(){this.closed||0!==this._outMessages.length&&(this.onFlush(this._outMessages),this._outMessages=[])}onFlush(e){}close(){this.closed||(Object.values(this.wlObjects).sort((e,t)=>e.id-t.id).forEach(e=>e.destroy()),this._outMessages=null,this._inMessages=null,this.closed=!0)}registerWlObject(e){if(!this.closed){if(e.id in this.wlObjects)throw new Error(`Illegal object id: ${e.id}. Already registered.`);this.wlObjects[e.id]=e}}unregisterWlObject(e){this.closed||delete this.wlObjects[e.id]}}var o=r;var a=class{constructor(e,t,i,n,s){this.fd=e,this.fdType=t,this.fdDomainUUID=i,this._onGetTransferable=n,this._onClose=s}async getTransferable(){return await this._onGetTransferable(this)}close(){this._onClose(this)}};var c=class{constructor(e){this.id=e,this._destroyPromise=new Promise(e=>this._destroyResolver=e),this._destroyListeners=[],this._destroyPromise.then(()=>this._destroyListeners.forEach(e=>e(this)))}destroy(){this._destroyResolver()}addDestroyListener(e){this._destroyListeners.push(e)}removeDestroyListener(e){this._destroyListeners=this._destroyListeners.filter(t=>t!==e)}onDestroy(){return this._destroyPromise}};i.d(t,"Connection",function(){return o}),i.d(t,"Fixed",function(){return s}),i.d(t,"WebFD",function(){return a}),i.d(t,"WlObject",function(){return c})},function(e,t,i){"use strict";i.r(t);var n=i(1);var s=class extends n.WlObject{constructor(e,t,i){super(t),this.client=e,this.version=i,this.userData={},this.client.registerResource(this)}postError(e,t){this.client.displayResource.error(this,e,t),this.client.flush(),this.client.close()}destroy(){super.destroy(),this.client.unregisterResource(this)}};const{object:r,uint:o,string:a,n:c}=n.Connection;var l=class extends s{constructor(e,t,i){super(e,t,i),this.implementation=null}async 0(e){await this.implementation.sync(this,c(e))}async 1(e){await this.implementation.getRegistry(this,c(e))}error(e,t,i){this.client.marshall(this.id,0,[r(e),o(t),a(i)]),this.client.flush(),this.client.close()}deleteId(e){this.client.marshall(this.id,1,[o(e)])}};var u=class{sync(e,t){}getRegistry(e,t){}};const{uint:h}=n.Connection;var f=class extends s{constructor(e,t,i){super(e,t,i)}done(e){this.client.marshall(this.id,0,[h(e)])}};var d=class extends u{close(){this.connection.closed||(this.connection.close(),Object.values(this.connection.wlObjects).sort((e,t)=>e.id-t.id).forEach(e=>e.destroy()),this.displayResource=null,this._display=null,this._destroyedResolver())}onClose(){return this._destroyPromise}registerResource(e){this.connection.registerWlObject(e)}unregisterResource(e){this.connection.closed||(this.connection.unregisterWlObject(e),this.displayResource.deleteId(e.id),this._resourceDestroyListeners.forEach(t=>t(e)))}addResourceDestroyListener(e){this._resourceDestroyListeners.push(e)}removeResourceDestroyListener(e){const t=this._resourceDestroyListeners.indexOf(e);-1!==t&&this._resourceDestroyListeners.splice(t,1)}marshallConstructor(e,t,i){const n=this._display.nextId;this._display.nextId++;let s=8;return i.forEach(e=>{"n"===e.type&&(e.value=n),s+=e.size}),this.connection.marshallMsg(e,t,s,i),n}marshall(e,t,i){let n=8;i.forEach(e=>n+=e.size),this.connection.marshallMsg(e,t,n,i)}sync(e,t){const i=new f(e.client,t,1);i.done(++this._syncEventSerial),i.destroy()}getRegistry(e,t){this._display.registry.publishGlobals(this._display.registry.createRegistryResource(this,t))}constructor(e){super(),this.connection=new n.Connection,this._display=e,this._syncEventSerial=0,this._destroyedResolver=null,this._destroyPromise=new Promise(e=>{this._destroyedResolver=e}),this.displayResource=new l(this,1,0),this.displayResource.implementation=this,this._resourceDestroyListeners=[]}};const{string:p,uint:m,u:_,s:g,n:y}=n.Connection;var w=class extends s{constructor(e,t,i){super(e,t,i),this.implementation=null}global(e,t,i){this.client.marshall(this.id,0,[m(e),p(t),m(i)])}globalRemove(e){this.client.marshall(this.id,1,[m(e)])}async 0(e){await this.implementation.bind(this.client,this,_(e),g(e,!1),_(e),y(e))}};var b=class{bind(e,t,i,n,s,r){}};var v=class{constructor(e,t,i,n,s,r){this.registry=e,this.implementation=t,this._bindCallback=r,this.interface_=i,this.version=n,this.name=s}bindClient(e,t,i){this._bindCallback(e,t,i)}destroy(){this.registry&&(this.registry.destroyGlobal(this),this.registry=null)}};var x=class extends b{constructor(){super(),this._registryResources=[],this._globals={},this._nextGlobalName=4294901760}createGlobal(e,t,i,n){const s=++this._nextGlobalName,r=new v(this,e,t,i,s,n);return this._globals[s]=r,this._registryResources.forEach(e=>e.global(r.name,r.interface_,r.version)),r}destroyGlobal(e){this._globals[e.name]&&(delete this._globals[e.name],this._registryResources.forEach(t=>t.globalRemove(e.name)))}publishGlobals(e){Object.entries(this._globals).forEach(([t,i])=>e.global(Number.parseInt(t),i.interface_,i.version))}createRegistryResource(e,t){const i=new w(e,t,1);return i.implementation=this,this._registryResources.push(i),i}bind(e,t,i,n,s,r){this._globals[i].bindClient(e,r,s)}};var S=class{constructor(){this.registry=new x,this.clients=[],this.nextId=4278190080}getNextObjectId(){return++this.nextId}createClient(e){const t=new d(this,e);return t.onClose().then(()=>{const e=this.clients.indexOf(t);e>-1&&this.clients.splice(e,1)}),this.clients.push(t),t}flushClients(){this.clients.forEach(e=>e.connection.flush())}};i.d(t,"Resource",function(){return s}),i.d(t,"Client",function(){return d}),i.d(t,"Display",function(){return S}),i.d(t,"Global",function(){return v})},function(e,t,i){"use strict";i.d(t,"a",function(){return r});var n=i(4),s=i(0);class r{static create(e,t,i,n){return new r(e,t,i,n)}constructor(e,t,i,n){this.x0=e,this.y0=t,this.x1=i,this.y1=n}get width(){return Math.abs(this.x1-this.x0)}get height(){return Math.abs(this.y1-this.y0)}get size(){return n.a.create(this.width,this.height)}get position(){return s.a.create(this.x0,this.y0)}intersect(e){const t=e,i=Math.max(this.x0,t.x0),n=Math.min(this.x1,t.x1),s=Math.max(this.y0,t.y0),o=Math.min(this.y1,t.y1);let a;return a=i<n&&s<o?r.create(i,s,n,o):r.create(0,0,0,0)}}},function(e,t,i){"use strict";i.d(t,"a",function(){return n});class n{static create(e,t){return new n(e,t)}constructor(e,t){this.w=e,this.h=t}toString(){return"("+this.w+", "+this.h+")"}getHalfSize(){return new n(this.w>>>1,this.h>>>1)}equals(e){return e.w===this.w&&e.h===this.h}}},function(e,t,i){const{Resource:n}=i(2),{Connection:s}=i(1),{uint:r,uintOptional:o,int:a,intOptional:c,fixed:l,fixedOptional:u,object:h,objectOptional:f,newObject:d,string:p,stringOptional:m,array:_,arrayOptional:g,fileDescriptorOptional:y,fileDescriptor:w,h:b,u:v,i:x,f:S,o:T,n:E,s:R,a:C}=s;class A extends n{ping(e){this.client.marshall(this.id,0,[r(e)])}constructor(e,t,i){super(e,t,i),this.implementation=null}async 0(e){await this.implementation.destroy(this)}async 1(e){await this.implementation.createPositioner(this,E(e))}async 2(e){await this.implementation.getXdgSurface(this,E(e),T(e,!1,this.client.connection))}async 3(e){await this.implementation.pong(this,v(e))}}A.protocolName="xdg_wm_base",A.Error={role:0,defunctSurfaces:1,notTheTopmostPopup:2,invalidPopupParent:3,invalidSurfaceState:4,invalidPositioner:5},e.exports=A},function(e,t,i){const{Resource:n}=i(2),{Connection:s}=i(1),{uint:r,uintOptional:o,int:a,intOptional:c,fixed:l,fixedOptional:u,object:h,objectOptional:f,newObject:d,string:p,stringOptional:m,array:_,arrayOptional:g,fileDescriptorOptional:y,fileDescriptor:w,h:b,u:v,i:x,f:S,o:T,n:E,s:R,a:C}=s;class A extends n{geometry(e,t,i,n,s,r,o,c){this.client.marshall(this.id,0,[a(e),a(t),a(i),a(n),a(s),p(r),p(o),a(c)])}mode(e,t,i,n){this.client.marshall(this.id,1,[r(e),a(t),a(i),a(n)])}done(){this.client.marshall(this.id,2,[])}scale(e){this.client.marshall(this.id,3,[a(e)])}constructor(e,t,i){super(e,t,i),this.implementation=null}async 0(e){await this.implementation.release(this)}}A.protocolName="wl_output",A.Subpixel={unknown:0,none:1,horizontalRgb:2,horizontalBgr:3,verticalRgb:4,verticalBgr:5},A.Transform={normal:0,90:1,180:2,270:3,flipped:4,flipped90:5,flipped180:6,flipped270:7},A.Mode={current:1,preferred:2},e.exports=A},function(e,t,i){const{Resource:n}=i(2),{Connection:s}=i(1),{uint:r,uintOptional:o,int:a,intOptional:c,fixed:l,fixedOptional:u,object:h,objectOptional:f,newObject:d,string:p,stringOptional:m,array:_,arrayOptional:g,fileDescriptorOptional:y,fileDescriptor:w,h:b,u:v,i:x,f:S,o:T,n:E,s:R,a:C}=s;class A extends n{constructor(e,t,i){super(e,t,i),this.implementation=null}async 0(e){await this.implementation.createDataSource(this,E(e))}async 1(e){await this.implementation.getDataDevice(this,E(e),T(e,!1,this.client.connection))}}A.protocolName="wl_data_device_manager",A.DndAction={none:0,copy:1,move:2,ask:4},e.exports=A},function(e,t,i){"use strict";i.d(t,"a",function(){return s});var n=i(0);class s{static create(e,t,i,n){return new s(e,t,i,n)}static create2D(e,t){return this.create(e,t,1,1)}constructor(e,t,i,n){this.x=e,this.y=t,this.z=i,this.w=n}plus(e){return s.create(this.x+e.x,this.y+e.y,this.z+e.z,this.w+e.w)}minus(e){return s.create(this.x-e.x,this.y-e.y,this.z-e.z,this.w-e.w)}toPoint(){return n.a.create(this.x,this.y)}}},function(e,t,i){const{Resource:n}=i(2),{Connection:s}=i(1),{uint:r,uintOptional:o,int:a,intOptional:c,fixed:l,fixedOptional:u,object:h,objectOptional:f,newObject:d,string:p,stringOptional:m,array:_,arrayOptional:g,fileDescriptorOptional:y,fileDescriptor:w,h:b,u:v,i:x,f:S,o:T,n:E,s:R,a:C}=s;class A extends n{constructor(e,t,i){super(e,t,i),this.implementation=null}async 0(e){await this.implementation.destroy(this)}async 1(e){await this.implementation.setSize(this,x(e),x(e))}async 2(e){await this.implementation.setAnchorRect(this,x(e),x(e),x(e),x(e))}async 3(e){await this.implementation.setAnchor(this,v(e))}async 4(e){await this.implementation.setGravity(this,v(e))}async 5(e){await this.implementation.setConstraintAdjustment(this,v(e))}async 6(e){await this.implementation.setOffset(this,x(e),x(e))}}A.protocolName="xdg_positioner",A.Error={invalidInput:0},A.Anchor={none:0,top:1,bottom:2,left:3,right:4,topLeft:5,bottomLeft:6,topRight:7,bottomRight:8},A.Gravity={none:0,top:1,bottom:2,left:3,right:4,topLeft:5,bottomLeft:6,topRight:7,bottomRight:8},A.ConstraintAdjustment={none:0,slideX:1,slideY:2,flipX:4,flipY:8,resizeX:16,resizeY:32},e.exports=A},function(e,t,i){const{Resource:n}=i(2),{Connection:s}=i(1),{uint:r,uintOptional:o,int:a,intOptional:c,fixed:l,fixedOptional:u,object:h,objectOptional:f,newObject:d,string:p,stringOptional:m,array:_,arrayOptional:g,fileDescriptorOptional:y,fileDescriptor:w,h:b,u:v,i:x,f:S,o:T,n:E,s:R,a:C}=s;class A extends n{enter(e,t,i,n){this.client.marshall(this.id,0,[r(e),h(t),l(i),l(n)])}leave(e,t){this.client.marshall(this.id,1,[r(e),h(t)])}motion(e,t,i){this.client.marshall(this.id,2,[r(e),l(t),l(i)])}button(e,t,i,n){this.client.marshall(this.id,3,[r(e),r(t),r(i),r(n)])}axis(e,t,i){this.client.marshall(this.id,4,[r(e),r(t),l(i)])}frame(){this.client.marshall(this.id,5,[])}axisSource(e){this.client.marshall(this.id,6,[r(e)])}axisStop(e,t){this.client.marshall(this.id,7,[r(e),r(t)])}axisDiscrete(e,t){this.client.marshall(this.id,8,[r(e),a(t)])}constructor(e,t,i){super(e,t,i),this.implementation=null}async 0(e){await this.implementation.setCursor(this,v(e),T(e,!0,this.client.connection),x(e),x(e))}async 1(e){await this.implementation.release(this)}}A.protocolName="wl_pointer",A.Error={role:0},A.ButtonState={released:0,pressed:1},A.Axis={verticalScroll:0,horizontalScroll:1},A.AxisSource={wheel:0,finger:1,continuous:2,wheelTilt:3},e.exports=A},function(e,t,i){const{Resource:n}=i(2),{Connection:s}=i(1),{uint:r,uintOptional:o,int:a,intOptional:c,fixed:l,fixedOptional:u,object:h,objectOptional:f,newObject:d,string:p,stringOptional:m,array:_,arrayOptional:g,fileDescriptorOptional:y,fileDescriptor:w,h:b,u:v,i:x,f:S,o:T,n:E,s:R,a:C}=s;class A extends n{release(){this.client.marshall(this.id,0,[])}constructor(e,t,i){super(e,t,i),this.implementation=null}async 0(e){await this.implementation.destroy(this)}}A.protocolName="wl_buffer",e.exports=A},function(e,t,i){"use strict";i.d(t,"a",function(){return n});class n{get size(){}get mimeType(){}get pixelContent(){}get serial(){}}},function(e,t,i){const{Resource:n}=i(2),{Connection:s}=i(1),{uint:r,uintOptional:o,int:a,intOptional:c,fixed:l,fixedOptional:u,object:h,objectOptional:f,newObject:d,string:p,stringOptional:m,array:_,arrayOptional:g,fileDescriptorOptional:y,fileDescriptor:w,h:b,u:v,i:x,f:S,o:T,n:E,s:R,a:C}=s;class A extends n{keymap(e,t,i){this.client.marshall(this.id,0,[r(e),w(t),r(i)])}enter(e,t,i){this.client.marshall(this.id,1,[r(e),h(t),_(i)])}leave(e,t){this.client.marshall(this.id,2,[r(e),h(t)])}key(e,t,i,n){this.client.marshall(this.id,3,[r(e),r(t),r(i),r(n)])}modifiers(e,t,i,n,s){this.client.marshall(this.id,4,[r(e),r(t),r(i),r(n),r(s)])}repeatInfo(e,t){this.client.marshall(this.id,5,[a(e),a(t)])}constructor(e,t,i){super(e,t,i),this.implementation=null}async 0(e){await this.implementation.release(this)}}A.protocolName="wl_keyboard",A.KeymapFormat={noKeymap:0,xkbV1:1},A.KeyState={released:0,pressed:1},e.exports=A},function(e,t,i){const{Resource:n}=i(2),{Connection:s}=i(1),{uint:r,uintOptional:o,int:a,intOptional:c,fixed:l,fixedOptional:u,object:h,objectOptional:f,newObject:d,string:p,stringOptional:m,array:_,arrayOptional:g,fileDescriptorOptional:y,fileDescriptor:w,h:b,u:v,i:x,f:S,o:T,n:E,s:R,a:C}=s;class A extends n{enter(e){this.client.marshall(this.id,0,[h(e)])}leave(e){this.client.marshall(this.id,1,[h(e)])}constructor(e,t,i){super(e,t,i),this.implementation=null}async 0(e){await this.implementation.destroy(this)}async 1(e){await this.implementation.attach(this,T(e,!0,this.client.connection),x(e),x(e))}async 2(e){await this.implementation.damage(this,x(e),x(e),x(e),x(e))}async 3(e){await this.implementation.frame(this,E(e))}async 4(e){await this.implementation.setOpaqueRegion(this,T(e,!0,this.client.connection))}async 5(e){await this.implementation.setInputRegion(this,T(e,!0,this.client.connection))}async 6(e){await this.implementation.commit(this,v(e))}async 7(e){await this.implementation.setBufferTransform(this,x(e))}async 8(e){await this.implementation.setBufferScale(this,x(e))}async 9(e){await this.implementation.damageBuffer(this,x(e),x(e),x(e),x(e))}}A.protocolName="wl_surface",A.Error={invalidScale:0,invalidTransform:1},e.exports=A},function(e,t,i){const{Resource:n}=i(2),{Connection:s}=i(1),{uint:r,uintOptional:o,int:a,intOptional:c,fixed:l,fixedOptional:u,object:h,objectOptional:f,newObject:d,string:p,stringOptional:m,array:_,arrayOptional:g,fileDescriptorOptional:y,fileDescriptor:w,h:b,u:v,i:x,f:S,o:T,n:E,s:R,a:C}=s;class A extends n{ping(e){this.client.marshall(this.id,0,[r(e)])}configure(e,t,i){this.client.marshall(this.id,1,[r(e),a(t),a(i)])}popupDone(){this.client.marshall(this.id,2,[])}constructor(e,t,i){super(e,t,i),this.implementation=null}async 0(e){await this.implementation.pong(this,v(e))}async 1(e){await this.implementation.move(this,T(e,!1,this.client.connection),v(e))}async 2(e){await this.implementation.resize(this,T(e,!1,this.client.connection),v(e),v(e))}async 3(e){await this.implementation.setToplevel(this)}async 4(e){await this.implementation.setTransient(this,T(e,!1,this.client.connection),x(e),x(e),v(e))}async 5(e){await this.implementation.setFullscreen(this,v(e),v(e),T(e,!0,this.client.connection))}async 6(e){await this.implementation.setPopup(this,T(e,!1,this.client.connection),v(e),T(e,!1,this.client.connection),x(e),x(e),v(e))}async 7(e){await this.implementation.setMaximized(this,T(e,!0,this.client.connection))}async 8(e){await this.implementation.setTitle(this,R(e,!1))}async 9(e){await this.implementation.setClass(this,R(e,!1))}}A.protocolName="wl_shell_surface",A.Resize={none:0,top:1,bottom:2,left:4,topLeft:5,bottomLeft:6,right:8,topRight:9,bottomRight:10},A.Transient={inactive:1},A.FullscreenMethod={default:0,scale:1,driver:2,fill:3},e.exports=A},function(e,t,i){const{Resource:n}=i(2),{Connection:s}=i(1),{uint:r,uintOptional:o,int:a,intOptional:c,fixed:l,fixedOptional:u,object:h,objectOptional:f,newObject:d,string:p,stringOptional:m,array:_,arrayOptional:g,fileDescriptorOptional:y,fileDescriptor:w,h:b,u:v,i:x,f:S,o:T,n:E,s:R,a:C}=s;class A extends n{configure(e,t,i){this.client.marshall(this.id,0,[a(e),a(t),_(i)])}close(){this.client.marshall(this.id,1,[])}constructor(e,t,i){super(e,t,i),this.implementation=null}async 0(e){await this.implementation.destroy(this)}async 1(e){await this.implementation.setParent(this,T(e,!0,this.client.connection))}async 2(e){await this.implementation.setTitle(this,R(e,!1))}async 3(e){await this.implementation.setAppId(this,R(e,!1))}async 4(e){await this.implementation.showWindowMenu(this,T(e,!1,this.client.connection),v(e),x(e),x(e))}async 5(e){await this.implementation.move(this,T(e,!1,this.client.connection),v(e))}async 6(e){await this.implementation.resize(this,T(e,!1,this.client.connection),v(e),v(e))}async 7(e){await this.implementation.setMaxSize(this,x(e),x(e))}async 8(e){await this.implementation.setMinSize(this,x(e),x(e))}async 9(e){await this.implementation.setMaximized(this)}async 10(e){await this.implementation.unsetMaximized(this)}async 11(e){await this.implementation.setFullscreen(this,T(e,!0,this.client.connection))}async 12(e){await this.implementation.unsetFullscreen(this)}async 13(e){await this.implementation.setMinimized(this)}}A.protocolName="xdg_toplevel",A.ResizeEdge={none:0,top:1,bottom:2,left:4,topLeft:5,bottomLeft:6,right:8,topRight:9,bottomRight:10},A.State={maximized:1,fullscreen:2,resizing:3,activated:4},e.exports=A},function(e,t,i){const{Resource:n}=i(2),{Connection:s}=i(1),{uint:r,uintOptional:o,int:a,intOptional:c,fixed:l,fixedOptional:u,object:h,objectOptional:f,newObject:d,string:p,stringOptional:m,array:_,arrayOptional:g,fileDescriptorOptional:y,fileDescriptor:w,h:b,u:v,i:x,f:S,o:T,n:E,s:R,a:C}=s;class A extends n{dataOffer(){return this.client.marshallConstructor(this.id,0,"WlDataOffer",[d()])}enter(e,t,i,n,s){this.client.marshall(this.id,1,[r(e),h(t),l(i),l(n),f(s)])}leave(){this.client.marshall(this.id,2,[])}motion(e,t,i){this.client.marshall(this.id,3,[r(e),l(t),l(i)])}drop(){this.client.marshall(this.id,4,[])}selection(e){this.client.marshall(this.id,5,[f(e)])}constructor(e,t,i){super(e,t,i),this.implementation=null}async 0(e){await this.implementation.startDrag(this,T(e,!0,this.client.connection),T(e,!1,this.client.connection),T(e,!0,this.client.connection),v(e))}async 1(e){await this.implementation.setSelection(this,T(e,!0,this.client.connection),v(e))}async 2(e){await this.implementation.release(this)}}A.protocolName="wl_data_device",A.Error={role:0},e.exports=A},function(e,t,i){const{Resource:n}=i(2),{Connection:s}=i(1),{uint:r,uintOptional:o,int:a,intOptional:c,fixed:l,fixedOptional:u,object:h,objectOptional:f,newObject:d,string:p,stringOptional:m,array:_,arrayOptional:g,fileDescriptorOptional:y,fileDescriptor:w,h:b,u:v,i:x,f:S,o:T,n:E,s:R,a:C}=s;class A extends n{target(e){this.client.marshall(this.id,0,[m(e)])}send(e,t){this.client.marshall(this.id,1,[p(e),w(t)])}cancelled(){this.client.marshall(this.id,2,[])}dndDropPerformed(){this.client.marshall(this.id,3,[])}dndFinished(){this.client.marshall(this.id,4,[])}action(e){this.client.marshall(this.id,5,[r(e)])}constructor(e,t,i){super(e,t,i),this.implementation=null}async 0(e){await this.implementation.offer(this,R(e,!1))}async 1(e){await this.implementation.destroy(this)}async 2(e){await this.implementation.setActions(this,v(e))}}A.protocolName="wl_data_source",A.Error={invalidActionMask:0,invalidSource:1},e.exports=A},function(e,t,i){const{Resource:n}=i(2),{Connection:s}=i(1),{uint:r,uintOptional:o,int:a,intOptional:c,fixed:l,fixedOptional:u,object:h,objectOptional:f,newObject:d,string:p,stringOptional:m,array:_,arrayOptional:g,fileDescriptorOptional:y,fileDescriptor:w,h:b,u:v,i:x,f:S,o:T,n:E,s:R,a:C}=s;class A extends n{constructor(e,t,i){super(e,t,i),this.implementation=null}async 0(e){await this.implementation.destroy(this)}async 1(e){await this.implementation.setPosition(this,x(e),x(e))}async 2(e){await this.implementation.placeAbove(this,T(e,!1,this.client.connection))}async 3(e){await this.implementation.placeBelow(this,T(e,!1,this.client.connection))}async 4(e){await this.implementation.setSync(this)}async 5(e){await this.implementation.setDesync(this)}}A.protocolName="wl_subsurface",A.Error={badSurface:0},e.exports=A},function(e,t,i){const{Resource:n}=i(2),{Connection:s}=i(1),{uint:r,uintOptional:o,int:a,intOptional:c,fixed:l,fixedOptional:u,object:h,objectOptional:f,newObject:d,string:p,stringOptional:m,array:_,arrayOptional:g,fileDescriptorOptional:y,fileDescriptor:w,h:b,u:v,i:x,f:S,o:T,n:E,s:R,a:C}=s;class A extends n{configure(e,t,i,n){this.client.marshall(this.id,0,[a(e),a(t),a(i),a(n)])}popupDone(){this.client.marshall(this.id,1,[])}constructor(e,t,i){super(e,t,i),this.implementation=null}async 0(e){await this.implementation.destroy(this)}async 1(e){await this.implementation.grab(this,T(e,!1,this.client.connection),v(e))}}A.protocolName="xdg_popup",A.Error={invalidGrab:0},e.exports=A},function(e,t,i){const{Resource:n}=i(2),{Connection:s}=i(1),{uint:r,uintOptional:o,int:a,intOptional:c,fixed:l,fixedOptional:u,object:h,objectOptional:f,newObject:d,string:p,stringOptional:m,array:_,arrayOptional:g,fileDescriptorOptional:y,fileDescriptor:w,h:b,u:v,i:x,f:S,o:T,n:E,s:R,a:C}=s;class A extends n{capabilities(e){this.client.marshall(this.id,0,[r(e)])}name(e){this.client.marshall(this.id,1,[p(e)])}constructor(e,t,i){super(e,t,i),this.implementation=null}async 0(e){await this.implementation.getPointer(this,E(e))}async 1(e){await this.implementation.getKeyboard(this,E(e))}async 2(e){await this.implementation.getTouch(this,E(e))}async 3(e){await this.implementation.release(this)}}A.protocolName="wl_seat",A.Capability={pointer:1,keyboard:2,touch:4},e.exports=A},function(e,t,i){const{Resource:n}=i(2),{Connection:s}=i(1),{uint:r,uintOptional:o,int:a,intOptional:c,fixed:l,fixedOptional:u,object:h,objectOptional:f,newObject:d,string:p,stringOptional:m,array:_,arrayOptional:g,fileDescriptorOptional:y,fileDescriptor:w,h:b,u:v,i:x,f:S,o:T,n:E,s:R,a:C}=s;class A extends n{constructor(e,t,i){super(e,t,i),this.implementation=null}async 0(e){await this.implementation.destroy(this)}async 1(e){await this.implementation.getSubsurface(this,E(e),T(e,!1,this.client.connection),T(e,!1,this.client.connection))}}A.protocolName="wl_subcompositor",A.Error={badSurface:0},e.exports=A},function(e,t,i){const{Resource:n}=i(2),{Connection:s}=i(1),{uint:r,uintOptional:o,int:a,intOptional:c,fixed:l,fixedOptional:u,object:h,objectOptional:f,newObject:d,string:p,stringOptional:m,array:_,arrayOptional:g,fileDescriptorOptional:y,fileDescriptor:w,h:b,u:v,i:x,f:S,o:T,n:E,s:R,a:C}=s;class A extends n{constructor(e,t,i){super(e,t,i),this.implementation=null}async 0(e){await this.implementation.getShellSurface(this,E(e),T(e,!1,this.client.connection))}}A.protocolName="wl_shell",A.Error={role:0},e.exports=A},function(e,t,i){"use strict";const n=[],s={};for(let e=0;e<256;e++)n[e]=(e+256).toString(16).substr(1),s[n[e]]=e;t.a={parse:function(e){let t=0;const i=new Uint8Array(16);return e.toLowerCase().replace(/[0-9a-f]{2}/g,e=>{t<16&&(i[t++]=s[e])}),i},unparse:function(e){let t=0;const i=n;return i[e[t++]]+i[e[t++]]+i[e[t++]]+i[e[t++]]+"-"+i[e[t++]]+i[e[t++]]+"-"+i[e[t++]]+i[e[t++]]+"-"+i[e[t++]]+i[e[t++]]+"-"+i[e[t++]]+i[e[t++]]+i[e[t++]]+i[e[t++]]+i[e[t++]]+i[e[t++]]}}},function(e,t,i){const{Resource:n}=i(2),{Connection:s}=i(1),{uint:r,uintOptional:o,int:a,intOptional:c,fixed:l,fixedOptional:u,object:h,objectOptional:f,newObject:d,string:p,stringOptional:m,array:_,arrayOptional:g,fileDescriptorOptional:y,fileDescriptor:w,h:b,u:v,i:x,f:S,o:T,n:E,s:R,a:C}=s;class A extends n{constructor(e,t,i){super(e,t,i),this.implementation=null}async 0(e){await this.implementation.createSurface(this,E(e))}async 1(e){await this.implementation.createRegion(this,E(e))}}A.protocolName="wl_compositor",e.exports=A},function(e,t,i){const{Resource:n}=i(2),{Connection:s}=i(1),{uint:r,uintOptional:o,int:a,intOptional:c,fixed:l,fixedOptional:u,object:h,objectOptional:f,newObject:d,string:p,stringOptional:m,array:_,arrayOptional:g,fileDescriptorOptional:y,fileDescriptor:w,h:b,u:v,i:x,f:S,o:T,n:E,s:R,a:C}=s;class A extends n{constructor(e,t,i){super(e,t,i),this.implementation=null}async 0(e){await this.implementation.createWebArrayBuffer(this,E(e))}async 1(e){await this.implementation.createBuffer(this,E(e),T(e,!1,this.client.connection),x(e),x(e))}}A.protocolName="gr_web_shm",e.exports=A},function(e,t,i){const{Resource:n}=i(2),{Connection:s}=i(1),{uint:r,uintOptional:o,int:a,intOptional:c,fixed:l,fixedOptional:u,object:h,objectOptional:f,newObject:d,string:p,stringOptional:m,array:_,arrayOptional:g,fileDescriptorOptional:y,fileDescriptor:w,h:b,u:v,i:x,f:S,o:T,n:E,s:R,a:C}=s;class A extends n{constructor(e,t,i){super(e,t,i),this.implementation=null}async 0(e){await this.implementation.createWebGlBuffer(this,E(e))}async 1(e){await this.implementation.createBuffer(this,E(e),T(e,!1,this.client.connection))}}A.protocolName="gr_web_gl",e.exports=A},function(e,t){e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var i=function(e,t){var i=e[1]||"",n=e[3];if(!n)return i;if(t&&"function"==typeof btoa){var s=(o=n,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+" */"),r=n.sources.map(function(e){return"/*# sourceURL="+n.sourceRoot+e+" */"});return[i].concat(r).concat([s]).join("\n")}var o;return[i].join("\n")}(t,e);return t[2]?"@media "+t[2]+"{"+i+"}":i}).join("")},t.i=function(e,i){"string"==typeof e&&(e=[[null,e,""]]);for(var n={},s=0;s<this.length;s++){var r=this[s][0];"number"==typeof r&&(n[r]=!0)}for(s=0;s<e.length;s++){var o=e[s];"number"==typeof o[0]&&n[o[0]]||(i&&!o[2]?o[2]=i:i&&(o[2]="("+o[2]+") and ("+i+")"),t.push(o))}},t}},function(e,t,i){var n,s,r={},o=(n=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===s&&(s=n.apply(this,arguments)),s}),a=function(e){var t={};return function(e,i){if("function"==typeof e)return e();if(void 0===t[e]){var n=function(e,t){return t?t.querySelector(e):document.querySelector(e)}.call(this,e,i);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}}(),c=null,l=0,u=[],h=i(69);function f(e,t){for(var i=0;i<e.length;i++){var n=e[i],s=r[n.id];if(s){s.refs++;for(var o=0;o<s.parts.length;o++)s.parts[o](n.parts[o]);for(;o<n.parts.length;o++)s.parts.push(y(n.parts[o],t))}else{var a=[];for(o=0;o<n.parts.length;o++)a.push(y(n.parts[o],t));r[n.id]={id:n.id,refs:1,parts:a}}}}function d(e,t){for(var i=[],n={},s=0;s<e.length;s++){var r=e[s],o=t.base?r[0]+t.base:r[0],a={css:r[1],media:r[2],sourceMap:r[3]};n[o]?n[o].parts.push(a):i.push(n[o]={id:o,parts:[a]})}return i}function p(e,t){var i=a(e.insertInto);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var n=u[u.length-1];if("top"===e.insertAt)n?n.nextSibling?i.insertBefore(t,n.nextSibling):i.appendChild(t):i.insertBefore(t,i.firstChild),u.push(t);else if("bottom"===e.insertAt)i.appendChild(t);else{if("object"!=typeof e.insertAt||!e.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var s=a(e.insertAt.before,i);i.insertBefore(t,s)}}function m(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e);var t=u.indexOf(e);t>=0&&u.splice(t,1)}function _(e){var t=document.createElement("style");if(void 0===e.attrs.type&&(e.attrs.type="text/css"),void 0===e.attrs.nonce){var n=function(){0;return i.nc}();n&&(e.attrs.nonce=n)}return g(t,e.attrs),p(e,t),t}function g(e,t){Object.keys(t).forEach(function(i){e.setAttribute(i,t[i])})}function y(e,t){var i,n,s,r;if(t.transform&&e.css){if(!(r="function"==typeof t.transform?t.transform(e.css):t.transform.default(e.css)))return function(){};e.css=r}if(t.singleton){var o=l++;i=c||(c=_(t)),n=v.bind(null,i,o,!1),s=v.bind(null,i,o,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(i=function(e){var t=document.createElement("link");return void 0===e.attrs.type&&(e.attrs.type="text/css"),e.attrs.rel="stylesheet",g(t,e.attrs),p(e,t),t}(t),n=function(e,t,i){var n=i.css,s=i.sourceMap,r=void 0===t.convertToAbsoluteUrls&&s;(t.convertToAbsoluteUrls||r)&&(n=h(n));s&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(s))))+" */");var o=new Blob([n],{type:"text/css"}),a=e.href;e.href=URL.createObjectURL(o),a&&URL.revokeObjectURL(a)}.bind(null,i,t),s=function(){m(i),i.href&&URL.revokeObjectURL(i.href)}):(i=_(t),n=function(e,t){var i=t.css,n=t.media;n&&e.setAttribute("media",n);if(e.styleSheet)e.styleSheet.cssText=i;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(i))}}.bind(null,i),s=function(){m(i)});return n(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;n(e=t)}else s()}}e.exports=function(e,t){(t=t||{}).attrs="object"==typeof t.attrs?t.attrs:{},t.singleton||"boolean"==typeof t.singleton||(t.singleton=o()),t.insertInto||(t.insertInto="head"),t.insertAt||(t.insertAt="bottom");var i=d(e,t);return f(i,t),function(e){for(var n=[],s=0;s<i.length;s++){var o=i[s];(a=r[o.id]).refs--,n.push(a)}e&&f(d(e,t),t);for(s=0;s<n.length;s++){var a;if(0===(a=n[s]).refs){for(var c=0;c<a.parts.length;c++)a.parts[c]();delete r[a.id]}}}};var w,b=(w=[],function(e,t){return w[e]=t,w.filter(Boolean).join("\n")});function v(e,t,i,n){var s=i?"":n.css;if(e.styleSheet)e.styleSheet.cssText=b(t,s);else{var r=document.createTextNode(s),o=e.childNodes;o[t]&&e.removeChild(o[t]),o.length?e.insertBefore(r,o[t]):e.appendChild(r)}}},function(e,t){e.exports=class{release(e){}}},function(e,t){e.exports=class{getPointer(e,t){}getKeyboard(e,t){}getTouch(e,t){}release(e){}}},function(e,t){e.exports=class{startDrag(e,t,i,n,s){}setSelection(e,t,i){}release(e){}}},function(e,t){e.exports=class{accept(e,t,i){}receive(e,t,i){}destroy(e){}finish(e){}setActions(e,t,i){}}},function(e,t,i){const{Resource:n}=i(2),{Connection:s}=i(1),{uint:r,uintOptional:o,int:a,intOptional:c,fixed:l,fixedOptional:u,object:h,objectOptional:f,newObject:d,string:p,stringOptional:m,array:_,arrayOptional:g,fileDescriptorOptional:y,fileDescriptor:w,h:b,u:v,i:x,f:S,o:T,n:E,s:R,a:C}=s;class A extends n{offer(e){this.client.marshall(this.id,0,[p(e)])}sourceActions(e){this.client.marshall(this.id,1,[r(e)])}action(e){this.client.marshall(this.id,2,[r(e)])}constructor(e,t,i){super(e,t,i),this.implementation=null}async 0(e){await this.implementation.accept(this,v(e),R(e,!0))}async 1(e){await this.implementation.receive(this,R(e,!1),b(e))}async 2(e){await this.implementation.destroy(this)}async 3(e){await this.implementation.finish(this)}async 4(e){await this.implementation.setActions(this,v(e),v(e))}}A.protocolName="wl_data_offer",A.Error={invalidFinish:0,invalidActionMask:1,invalidAction:2,invalidOffer:3},e.exports=A},function(e,t){e.exports=class{release(e){}}},function(e,t){e.exports=class{setCursor(e,t,i,n,s){}release(e){}}},function(e,t){e.exports=class{destroy(e){}add(e,t,i,n,s){}subtract(e,t,i,n,s){}}},function(e,t,i){const{Resource:n}=i(2),{Connection:s}=i(1),{uint:r,uintOptional:o,int:a,intOptional:c,fixed:l,fixedOptional:u,object:h,objectOptional:f,newObject:d,string:p,stringOptional:m,array:_,arrayOptional:g,fileDescriptorOptional:y,fileDescriptor:w,h:b,u:v,i:x,f:S,o:T,n:E,s:R,a:C}=s;class A extends n{down(e,t,i,n,s,o){this.client.marshall(this.id,0,[r(e),r(t),h(i),a(n),l(s),l(o)])}up(e,t,i){this.client.marshall(this.id,1,[r(e),r(t),a(i)])}motion(e,t,i,n){this.client.marshall(this.id,2,[r(e),a(t),l(i),l(n)])}frame(){this.client.marshall(this.id,3,[])}cancel(){this.client.marshall(this.id,4,[])}shape(e,t,i){this.client.marshall(this.id,5,[a(e),l(t),l(i)])}orientation(e,t){this.client.marshall(this.id,6,[a(e),l(t)])}constructor(e,t,i){super(e,t,i),this.implementation=null}async 0(e){await this.implementation.release(this)}}A.protocolName="wl_touch",e.exports=A},function(e,t){e.exports=class{createSurface(e,t){}createRegion(e,t){}}},function(e,t){e.exports=class{destroy(e){}attach(e,t,i,n){}damage(e,t,i,n,s){}frame(e,t){}setOpaqueRegion(e,t){}setInputRegion(e,t){}commit(e,t){}setBufferTransform(e,t){}setBufferScale(e,t){}damageBuffer(e,t,i,n,s){}}},function(e,t,i){const{Resource:n}=i(2),{Connection:s}=i(1),{uint:r,uintOptional:o,int:a,intOptional:c,fixed:l,fixedOptional:u,object:h,objectOptional:f,newObject:d,string:p,stringOptional:m,array:_,arrayOptional:g,fileDescriptorOptional:y,fileDescriptor:w,h:b,u:v,i:x,f:S,o:T,n:E,s:R,a:C}=s;class A extends n{done(e){this.client.marshall(this.id,0,[r(e)])}constructor(e,t,i){super(e,t,i),this.implementation=null}}A.protocolName="wl_callback",e.exports=A},function(e,t,i){const{Resource:n}=i(2),{Connection:s}=i(1),{uint:r,uintOptional:o,int:a,intOptional:c,fixed:l,fixedOptional:u,object:h,objectOptional:f,newObject:d,string:p,stringOptional:m,array:_,arrayOptional:g,fileDescriptorOptional:y,fileDescriptor:w,h:b,u:v,i:x,f:S,o:T,n:E,s:R,a:C}=s;class A extends n{constructor(e,t,i){super(e,t,i),this.implementation=null}async 0(e){await this.implementation.destroy(this)}async 1(e){await this.implementation.add(this,x(e),x(e),x(e),x(e))}async 2(e){await this.implementation.subtract(this,x(e),x(e),x(e),x(e))}}A.protocolName="wl_region",e.exports=A},function(e,t){e.exports=class{createDataSource(e,t){}getDataDevice(e,t,i){}}},function(e,t){e.exports=class{offer(e,t){}destroy(e){}setActions(e,t){}}},function(e,t){e.exports=class{destroy(e){}getSubsurface(e,t,i,n){}}},function(e,t){e.exports=class{destroy(e){}setPosition(e,t,i){}placeAbove(e,t){}placeBelow(e,t){}setSync(e){}setDesync(e){}}},function(e,t){e.exports=class{getShellSurface(e,t,i){}}},function(e,t){e.exports=class{pong(e,t){}move(e,t,i){}resize(e,t,i,n){}setToplevel(e){}setTransient(e,t,i,n,s){}setFullscreen(e,t,i,n){}setPopup(e,t,i,n,s,r,o){}setMaximized(e,t){}setTitle(e,t){}setClass(e,t){}}},function(e,t){e.exports=class{destroy(e){}createPositioner(e,t){}getXdgSurface(e,t,i){}pong(e,t){}}},function(e,t){e.exports=class{destroy(e){}setSize(e,t,i){}setAnchorRect(e,t,i,n,s){}setAnchor(e,t){}setGravity(e,t){}setConstraintAdjustment(e,t){}setOffset(e,t,i){}}},function(e,t,i){const{Resource:n}=i(2),{Connection:s}=i(1),{uint:r,uintOptional:o,int:a,intOptional:c,fixed:l,fixedOptional:u,object:h,objectOptional:f,newObject:d,string:p,stringOptional:m,array:_,arrayOptional:g,fileDescriptorOptional:y,fileDescriptor:w,h:b,u:v,i:x,f:S,o:T,n:E,s:R,a:C}=s;class A extends n{configure(e){this.client.marshall(this.id,0,[r(e)])}constructor(e,t,i){super(e,t,i),this.implementation=null}async 0(e){await this.implementation.destroy(this)}async 1(e){await this.implementation.getToplevel(this,E(e))}async 2(e){await this.implementation.getPopup(this,E(e),T(e,!0,this.client.connection),T(e,!1,this.client.connection))}async 3(e){await this.implementation.setWindowGeometry(this,x(e),x(e),x(e),x(e))}async 4(e){await this.implementation.ackConfigure(this,v(e))}}A.protocolName="xdg_surface",A.Error={notConstructed:1,alreadyConstructed:2,unconfiguredBuffer:3},e.exports=A},function(e,t){e.exports=class{destroy(e){}getToplevel(e,t){}getPopup(e,t,i,n){}setWindowGeometry(e,t,i,n,s){}ackConfigure(e,t){}}},function(e,t){e.exports=class{destroy(e){}setParent(e,t){}setTitle(e,t){}setAppId(e,t){}showWindowMenu(e,t,i,n,s){}move(e,t,i){}resize(e,t,i,n){}setMaxSize(e,t,i){}setMinSize(e,t,i){}setMaximized(e){}unsetMaximized(e){}setFullscreen(e,t){}unsetFullscreen(e){}setMinimized(e){}}},function(e,t){e.exports=class{destroy(e){}grab(e,t,i){}}},function(e,t){e.exports=class{createWebArrayBuffer(e,t){}createBuffer(e,t,i,n,s){}}},function(e,t){e.exports=class{attach(e,t){}}},function(e,t,i){const{Resource:n}=i(2),{Connection:s}=i(1),{uint:r,uintOptional:o,int:a,intOptional:c,fixed:l,fixedOptional:u,object:h,objectOptional:f,newObject:d,string:p,stringOptional:m,array:_,arrayOptional:g,fileDescriptorOptional:y,fileDescriptor:w,h:b,u:v,i:x,f:S,o:T,n:E,s:R,a:C}=s;class A extends n{detach(e){this.client.marshall(this.id,0,[w(e)])}constructor(e,t,i){super(e,t,i),this.implementation=null}async 0(e){await this.implementation.attach(this,b(e))}}A.protocolName="gr_web_shm_buffer",e.exports=A},function(e,t){e.exports=class{createWebGlBuffer(e,t){}createBuffer(e,t,i){}}},function(e,t){e.exports=class{transfer(e,t){}}},function(e,t,i){const{Resource:n}=i(2),{Connection:s}=i(1),{uint:r,uintOptional:o,int:a,intOptional:c,fixed:l,fixedOptional:u,object:h,objectOptional:f,newObject:d,string:p,stringOptional:m,array:_,arrayOptional:g,fileDescriptorOptional:y,fileDescriptor:w,h:b,u:v,i:x,f:S,o:T,n:E,s:R,a:C}=s;class A extends n{constructor(e,t,i){super(e,t,i),this.implementation=null}async 0(e){await this.implementation.transfer(this,b(e))}}A.protocolName="gr_web_gl_buffer",e.exports=A},function(e,t,i){"use strict";(function(e){var n=i(11),s=i.n(n),r=i(65),o=i(24),a=i(1),c=i(62);class l{static create(e){const t=new l(e);return e.messageHandlers.RTCSignaling=t,t}constructor(e){this._session=e,this._appEndpointConnections={}}async connect({remotePeerId:e}){if(this._appEndpointConnections[e])return;const t=new RTCPeerConnection;this._appEndpointConnections[e]=t,t.ondatachannel=(i=>this._onDataChannel(i.channel,e,t)),t.onnegotiationneeded=(async()=>{await this._sendOffer(e,t)}),t.onicecandidate=(t=>{const i=t.candidate;null!==i&&this._sendRTCSignal(e,{object:"RTCSignaling",method:"iceCandidate",args:{remotePeerId:this._session.compositorSessionId,candidate:i}})}),t.onconnectionstatechange=(i=>{switch(t.connectionState){case"connected":case"disconnected":break;case"failed":case"closed":delete this._appEndpointConnections[e]}})}async _getShmTransferable(e){throw new Error("shm transferable from endpoint not yet implemented.")}async _closeShmTransferable(e){throw new Error("close shm transferable from endpoint not yet implemented.")}async _getPipeTransferable(e){throw new Error("pipe transferable from endpoint not yet implemented.")}async _closePipeTransferable(e){throw new Error("close pipe transferable from endpoint not yet implemented.")}_onDataChannel(e,t,i){e.binaryType="arraybuffer",e.onopen=(()=>{const t=this._session.display.createClient();t.onClose().then(()=>!1),i.oniceconnectionstatechange=(()=>{"disconnected"===i.iceConnectionState&&t.close()}),e.onclose=(()=>{t.close()}),e.onerror=(e=>!1),t.connection.onFlush=(i=>this._flushWireMessages(t,e,i));const n=c.a.create(i=>{if("open"===e.readyState)try{e.send(i)}catch(e){console.log(e.message),t.close()}});this._setupClientOutOfBandHandlers(t,n),e.onmessage=(e=>this._handleDataChannelEvent(t,e,n))})}_setupClientOutOfBandHandlers(e,t){e.addResourceDestroyListener(e=>t.send(1,new Uint32Array([e.id]).buffer)),t.setListener(2,t=>{const i=new s.a(e,new Uint32Array(t)[0],1);i.implementation=r.a.create(i)}),t.setListener(3,t=>{const i=new DataView(t).getUint32(0,!0);e.connection.wlObjects[i].implementation.bufferStream.onChunk(t.slice(Uint32Array.BYTES_PER_ELEMENT))}),t.setListener(4,e=>{const i=new Uint32Array(e)[0],n=this._session.webFS.getWebFD(i);n.getTransferable().then(e=>{if(e instanceof ArrayBuffer){const s=24,r=e.byteLength,a=16384-(s+4);let c=r;for(;c>0;){const l=c>a?a:c,u=new Uint8Array(s+l),h=new DataView(u.buffer);h.setUint32(0,i,!0);const f=o.a.parse(n.fdDomainUUID);u.set(f,4),h.setUint32(20,r),u.set(new Uint8Array(e.slice(r-c,r-c+l)),24),t.send(4,u.buffer),c-=l}}})})}_handleDataChannelEvent(e,t,i){const n=t.data;if(new DataView(n).getUint32(0,!0))i.message(n);else{const t=new Uint32Array(n,Uint32Array.BYTES_PER_ELEMENT),i=t[0],s=t.subarray(1,1+6*i),r=[];for(let e=0;e<s.length;e+=6)r.push(this._deserializeWebFD(s.subarray(e,e+6)));const o=t.subarray(1+6*i);e.connection.message({buffer:o,fds:r})}}_flushWireMessages(e,t,i){const n=i.reduce((e,t)=>e+1+6*t.fds.length+t.buffer.byteLength/Uint32Array.BYTES_PER_ELEMENT,0),s=new Uint32Array(n+1);s[0]=0;let r=1;if(i.forEach(e=>{s[r++]=e.fds.length,e.fds.forEach(e=>{this._serializeWebFD(e,s.subarray(r,r+6)),r+=6});const t=new Uint32Array(e.buffer);s.set(t,r),r+=t.length}),"open"===t.readyState)try{t.send(s.buffer)}catch(t){console.log(t.message),e.close()}}async _sendOffer(e,t){const i=await t.createOffer();await t.setLocalDescription(i),this._sendRTCSignal(e,{object:"RTCSignaling",method:"sdpOffer",args:{remotePeerId:this._session.compositorSessionId,offer:i}})}_serializeWebFD(e,t){switch(t[0]=e.fd,e.fdType){case"ArrayBuffer":t[1]=1;break;case"MessagePort":t[1]=2;break;default:t[1]=0}new Uint8Array(t.buffer,t.byteOffset+8,16).set(o.a.parse(e.fdDomainUUID))}_deserializeWebFD(e){const t=o.a.unparse(new Uint8Array(e.buffer,e.byteOffset+8,16)),i=e[0];let n,s,r;switch(e[1]){case 1:n="ArrayBuffer",s=(e=>this._getShmTransferable(e)),r=(e=>this._closeShmTransferable(e));break;case 2:n="MessagePort",s=(e=>this._getPipeTransferable(e)),r=(e=>this._closePipeTransferable(e));break;default:n="unsupported",s=(()=>{throw new Error("unsupported fd type")}),r=(()=>{throw new Error("unsupported fd type")})}return new a.WebFD(i,n,t,s,r)}_sendRTCSignal(e,t){this._session.webSocket.send(JSON.stringify({object:"signalingServer",method:"rtcSignal",args:{appEndpointSessionId:e,signalMessage:JSON.stringify(t)}}))}async iceCandidate({remotePeerId:e,candidate:t}){const i=this._appEndpointConnections[e];if(!i)throw new Error(`[webrtc-peer-connection: ${e}] - session not found.`);await i.addIceCandidate(t)}async sdpReply({remotePeerId:e,reply:t}){const i=this._appEndpointConnections[e];if(!i)throw new Error(`[webrtc-peer-connection: ${e}] - session not found.`);await i.setRemoteDescription(t)}async sdpOffer({remotePeerId:t,offer:i}){const n=this._appEndpointConnections[t];if(!n)throw new Error(`[webrtc-peer-connection: ${t}] - session not found.`);await n.setRemoteDescription(i);const s=await n.createAnswer();await n.setLocalDescription(s),e.env.DEBUG&&console.log(`[webrtc-peer-connection: ${t}] - sending browser sdp answer: ${s}.`),this._sendRTCSignal(t,{object:"RTCSignaling",method:"sdpReply",args:{remotePeerId:this._session.compositorSessionId,reply:s}})}}t.a=l}).call(this,i(72))},function(e,t,i){"use strict";i.d(t,"a",function(){return n});class n{static create(e){return new n(e)}constructor(e){this._outOfBandListeners={},this._onOutOfBandSend=e}message(e){const t=new DataView(e).getUint32(0,!0),i=this._outOfBandListeners[t];i?i(e.slice(4)):console.log(`[BUG?] Out of band using opcode: ${t} not found. Ignoring.`)}setListener(e,t){this._outOfBandListeners[e]=t}removeListener(e){delete this._outOfBandListeners[e]}send(e,t){const i=new ArrayBuffer(4+t.byteLength);new DataView(i).setUint32(0,e,!0),new Uint8Array(i,4).set(new Uint8Array(t)),this._onOutOfBandSend(i)}}},function(e,t){e.exports=class{destroy(e){}}},function(e,t,i){"use strict";e.exports={0:"video/h264",1:"image/png",2:"image/jpeg"}},function(e,t,i){"use strict";var n=i(63),s=i.n(n),r=i(3);class o{static create(e,t,i,n,s,a,c){const l=r.a.create(t,i,t+n,i+s);return new o(e,l,a,c)}constructor(e,t,i,n){this.encodingType=e,this.geo=t,this.opaque=i,this.alpha=n}}var a=i(64),c=i.n(a),l=i(4),u=i(12);class h extends u.a{static create(e){const t=new DataView(e);let i=0;const n=t.getUint32(i,!0);i+=4;const s=c.a[t.getUint16(i,!0)];i+=2;const r=t.getUint16(i,!0);i+=2;const a=t.getUint16(i,!0);i+=2;const u=t.getUint16(i,!0);i+=2;const f=t.getUint32(i,!0);i+=4;const d=[];for(let n=0;n<f;n++){const n=t.getUint16(i,!0);i+=2;const r=t.getUint16(i,!0);i+=2;const a=t.getUint16(i,!0);i+=2;const c=t.getUint16(i,!0);i+=2;const l=t.getUint32(i,!0);i+=4;const u=new Uint8Array(e,i,l);i+=l;const h=t.getUint32(i,!0);i+=4;const f=new Uint8Array(e,i,h);i+=h,d.push(o.create(s,n,r,a,c,u,f))}return new h(n,s,r,l.a.create(a,u),d)}constructor(e,t,i,n,s){super(),this._serial=e,this._mimeType=t,this.encodingOptions=i,this._size=n,this._contents=s}get pixelContent(){return this._contents}get mimeType(){return this._mimeType}get serial(){return this._serial}get size(){return this._size}}class f{static create(){return new f}constructor(){this._bufferStates={},this._bufferChunks={}}_onComplete(e,t){const i=this._bufferStates[e];i.state="complete",i.completionPromise.then(()=>{delete this._bufferStates[e]}),i.completionResolve(t)}_newBufferState(e){const t={completionPromise:null,completionResolve:null,completionReject:null,state:"pending",encodedFrame:null};return t.completionPromise=new Promise((e,i)=>{t.completionResolve=e,t.completionReject=i}),this._bufferStates[e]=t,t}onFrameAvailable(e){return this._bufferStates[e]&&this._bufferStates[e].encodedFrame?this._onComplete(e,this._bufferStates[e].encodedFrame):this._newBufferState(e),this._bufferStates[e].completionPromise}_checkBufferState(e){this._bufferStates[e.serial]?(this._bufferStates[e.serial].encodedFrame=e,this._onComplete(e.serial,e)):this._newBufferState(e.serial).encodedFrame=e}_checkChunk(e){const t=new DataView(e,0,12),i=t.getUint32(0,!1),n=t.getUint32(4,!1),s=t.getUint32(8,!1);let r=this._bufferChunks[i];r||(r={chunks:new Array(n),received:0,totalSize:0},this._bufferChunks[i]=r);const o=e.slice(12);if(r.chunks[s])return null;r.chunks[s]=o,r.received++,r.totalSize+=o.byteLength;if(r.received===n){const e=new Uint8Array(r.totalSize);return r.chunks.forEach((t,i)=>{e.set(new Uint8Array(t),16192*i)}),delete this._bufferChunks[i],e.buffer}return null}onChunk(e){try{const t=this._checkChunk(e);if(t){const e=h.create(t);this._checkBufferState(e)}}catch(e){console.error(e)}}destroy(){Object.values(this._bufferStates).forEach(e=>e.completionResolve(null))}}i.d(t,"a",function(){return d});class d extends s.a{static create(e){const t=f.create(),i=new d(e,t);return e.implementation=i,i}constructor(e,t){super(),this.resource=e,this.bufferStream=t}destroy(e){this.bufferStream.destroy(),e.destroy()}async getContents(e){return this.bufferStream.onFrameAvailable(e)}release(){this.resource.release()}}},function(e,t,i){e.exports=i(73)},function(e,t,i){var n=i(68);"string"==typeof n&&(n=[[e.i,n,""]]);var s={hmr:!0,transform:void 0,insertInto:void 0};i(29)(n,s);n.locals&&(e.exports=n.locals)},function(e,t,i){(e.exports=i(28)(!1)).push([e.i,"body {\n    margin: 0;\n    padding: 0;\n    height: 100vh;\n    min-height: 100vh;\n}\n\n#workspace {\n    z-index: -65535;\n}\n\ncanvas {\n    will-change: transform, contents, display;\n    transform-origin: top left;\n    pointer-events: none;\n    position: absolute;\n}\n\n.inputRegion {\n    transform-origin: top left;\n    position: absolute;\n    display: inline-block;\n    transform: inherit;\n}",""])},function(e,t){e.exports=function(e){var t="undefined"!=typeof window&&window.location;if(!t)throw new Error("fixUrls requires window.location");if(!e||"string"!=typeof e)return e;var i=t.protocol+"//"+t.host,n=i+t.pathname.replace(/\/[^\/]*$/,"/");return e.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(e,t){var s,r=t.trim().replace(/^"(.*)"$/,function(e,t){return t}).replace(/^'(.*)'$/,function(e,t){return t});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(r)?e:(s=0===r.indexOf("//")?r:0===r.indexOf("/")?i+r:n+r.replace(/^\.\//,""),"url("+JSON.stringify(s)+")")})}},function(e,t,i){var n=i(71);"string"==typeof n&&(n=[[e.i,n,""]]);var s={hmr:!0,transform:void 0,insertInto:void 0};i(29)(n,s);n.locals&&(e.exports=n.locals)},function(e,t,i){(e.exports=i(28)(!1)).push([e.i,"body {\n    display: flex;\n    flex-direction: column;\n}\n\n#workspace {\n    flex-grow: 1;\n    display: inline;\n    background-image: url(/assets/pattern_light.png);\n    background-size: auto;\n}\n\n.hpanel {\n    z-index: 0;\n    background-color: rgb(200, 200, 200);\n\n    display: flex;\n    flex-wrap: nowrap;\n    flex-direction: row;\n    min-height: 3.7vh;\n\n    box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.75);\n}\n\n.entry-container {\n    flex-grow: 1;\n    display: flex;\n    flex-wrap: wrap;\n    flex-direction: row;\n    align-items: center;\n}\n\n.entry {\n    flex-grow: 1;\n    min-width: 100px;\n    max-width: 20vw;\n    height: 3.6vh;\n\n    background: rgb(150, 150, 150);\n\n    font-family: sans-serif;\n    font-size: medium;\n    text-align: left;\n    padding-left: 1vh;\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    vertical-align: middle;\n    line-height: 4vh;\n    color: black;\n\n    box-shadow: inset 0 0.6vh 0.1vh -0.3vh rgba(252, 104, 42, 0.20);\n\n    transition: all 300ms ease-in-out;\n}\n\n.entry-removed {\n    opacity: 0;\n}\n\n.entry-focus {\n    box-shadow: inset 0 0.6vh 0.1vh -0.3vh rgba(42, 190, 252, 1);\n    background: rgb(230, 230, 230);\n}\n\n.entry:hover:not(.entry-focus) {\n    box-shadow: inset 0 0.6vh 0.1vh -0.3vh rgba(252, 104, 42, 0.60);\n    background: rgb(210, 210, 210);\n    transition: all 150ms linear;\n}\n\ninput::placeholder {\n    color: white;\n    opacity: 1;\n}\n\n.fadeToUnresponsive {\n    filter: grayscale(0.9) brightness(0.6) contrast(1.3) blur(1px);\n    transition: filter 2000ms linear;\n}\n\n.fadeToHidden {\n    opacity: 0;\n    transition: opacity 300ms ease-out;\n}",""])},function(e,t){var i,n,s=e.exports={};function r(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function a(e){if(i===setTimeout)return setTimeout(e,0);if((i===r||!i)&&setTimeout)return i=setTimeout,setTimeout(e,0);try{return i(e,0)}catch(t){try{return i.call(null,e,0)}catch(t){return i.call(this,e,0)}}}!function(){try{i="function"==typeof setTimeout?setTimeout:r}catch(e){i=r}try{n="function"==typeof clearTimeout?clearTimeout:o}catch(e){n=o}}();var c,l=[],u=!1,h=-1;function f(){u&&c&&(u=!1,c.length?l=c.concat(l):h=-1,l.length&&d())}function d(){if(!u){var e=a(f);u=!0;for(var t=l.length;t;){for(c=l,l=[];++h<t;)c&&c[h].run();h=-1,t=l.length}c=null,u=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function m(){}s.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)t[i-1]=arguments[i];l.push(new p(e,t)),1!==l.length||u||a(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=m,s.addListener=m,s.once=m,s.off=m,s.removeListener=m,s.removeAllListeners=m,s.emit=m,s.prependListener=m,s.prependOnceListener=m,s.listeners=function(e){return[]},s.binding=function(e){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(e){throw new Error("process.chdir is not supported")},s.umask=function(){return 0}},function(e,t,i){"use strict";i.r(t);var n=i(2),s=i(1);class r{static create(e){return new r(e)}constructor(e){this._fdDomainUUID=e,this._webFDs={},this._nextFD=0}fromArrayBuffer(e){const t=this._nextFD++,i=new s.WebFD(t,"ArrayBuffer",this._fdDomainUUID,()=>Promise.resolve(e),()=>{delete this._webFDs[t]});return this._webFDs[t]=i,i}fromImageBitmap(e){const t=this._nextFD++,i=new s.WebFD(t,"ImageBitmap",this._fdDomainUUID,()=>Promise.resolve(e),()=>{delete this._webFDs[t]});return this._webFDs[t]=i,i}getWebFD(e){return this._webFDs[e]}}class o{static create(){const e=new n.Display,t=this._uuidv4();return new o(e,t)}static _uuidv4(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,e=>(e^window.crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16))}constructor(e,t){this.display=e,this.compositorSessionId=t,this.webSocket=null,this.messageHandlers={},this.webFS=r.create(this.compositorSessionId)}withRemote(e){return new Promise((t,i)=>{const n=`${"https:"===window.location.protocol?"wss":"ws"}://${window.location.host}/announceCompositor/${this.compositorSessionId}`;this.webSocket=new WebSocket(n),this.webSocket.onmessage=(e=>this._onRemoteMessage(e)),this.webSocket.onerror=(e=>i(e.error)),this.webSocket.onopen=(e=>{this.webSocket.onerror=(e=>this._onRemoteError(e)),t()}),this.webSocket.onclose=(t=>{this._onRemoteClose(t),e(t)})})}_onRemoteMessage(e){const t=e.data,i=JSON.parse(t),{object:n,method:s,args:r}=i;try{this.messageHandlers[n][s](r)}catch(e){console.error(`[compositor-session: ${this.compositorSessionId}] - Failed to handle incoming message. object=${n}:method=${s}:args=${r}\n${e}\n${e.stack}`),this.webSocket.close(4007,`Compositor session [${this.compositorSessionId}] received an illegal message`)}}_onRemoteClose(e){console.log(`[compositor-session: ${this.compositorSessionId}] - Web socket connection closed. ${e.code}: ${e.reason}.`),this.display.clients.forEach(e=>e.close())}_onRemoteError(e){console.error(`[compositor-session: ${this.compositorSessionId}] - Web socket is in error: ${e}.`)}flush(){this.display.flushClients()}}var a=i(39),c=i.n(a),l=i(25),u=i.n(l),h=i(14),f=i.n(h),d=i(42),p=i.n(d),m=i(40),_=i.n(m),g=i(41),y=i.n(g),w=i(6),b=i.n(w),v=i(8),x=i(0),S=i(3);class T{static create(e,t,i,n,s,r,o,a,c,l,u,h,f,d,p,m){return new T(e,t,i,n,s,r,o,a,c,l,u,h,f,d,p,m)}static IDENTITY(){return this.create(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)}static scalar(e){return this.create(e,0,0,0,0,e,0,0,0,0,1,0,0,0,0,1)}static scalarVector(e){return this.create(e.x,0,0,0,0,e.y,0,0,0,0,e.z,0,0,0,0,e.w)}static translation(e,t){return this.create(1,0,0,e,0,1,0,t,0,0,1,0,0,0,0,1)}constructor(e,t,i,n,s,r,o,a,c,l,u,h,f,d,p,m){this.m00=e,this.m10=t,this.m20=i,this.m30=n,this.m01=s,this.m11=r,this.m21=o,this.m31=a,this.m02=c,this.m12=l,this.m22=u,this.m32=h,this.m03=f,this.m13=d,this.m23=p,this.m33=m}plus(e){return T.create(this.m00+e.m00,this.m10+e.m10,this.m20+e.m20,this.m30+e.m30,this.m01+e.m01,this.m11+e.m11,this.m21+e.m21,this.m31+e.m31,this.m02+e.m02,this.m12+e.m12,this.m22+e.m22,this.m32+e.m32,this.m03+e.m03,this.m13+e.m13,this.m23+e.m23,this.m33+e.m33)}timesPoint(e){return this.timesVec4(e.toVec4()).toPoint()}timesVec4(e){const t=e.x,i=e.y,n=e.z,s=e.w;return v.a.create(this.m00*t+this.m10*i+this.m20*n+this.m30*s,this.m01*t+this.m11*i+this.m21*n+this.m31*s,this.m02*t+this.m12*i+this.m22*n+this.m32*s,this.m03*t+this.m13*i+this.m23*n+this.m33*s)}timesMat4(e){const t=this.m00*e.m00+this.m10*e.m01+this.m20*e.m02+this.m30*e.m03,i=this.m01*e.m00+this.m11*e.m01+this.m21*e.m02+this.m31*e.m03,n=this.m02*e.m00+this.m12*e.m01+this.m22*e.m02+this.m32*e.m03,s=this.m03*e.m00+this.m13*e.m01+this.m23*e.m02+this.m33*e.m03,r=this.m00*e.m10+this.m10*e.m11+this.m20*e.m12+this.m30*e.m13,o=this.m01*e.m10+this.m11*e.m11+this.m21*e.m12+this.m31*e.m13,a=this.m02*e.m10+this.m12*e.m11+this.m22*e.m12+this.m32*e.m13,c=this.m03*e.m10+this.m13*e.m11+this.m23*e.m12+this.m33*e.m13,l=this.m00*e.m20+this.m10*e.m21+this.m20*e.m22+this.m30*e.m23,u=this.m01*e.m20+this.m11*e.m21+this.m21*e.m22+this.m31*e.m23,h=this.m02*e.m20+this.m12*e.m21+this.m22*e.m22+this.m32*e.m23,f=this.m03*e.m20+this.m13*e.m21+this.m23*e.m22+this.m33*e.m23,d=this.m00*e.m30+this.m10*e.m31+this.m20*e.m32+this.m30*e.m33,p=this.m01*e.m30+this.m11*e.m31+this.m21*e.m32+this.m31*e.m33,m=this.m02*e.m30+this.m12*e.m31+this.m22*e.m32+this.m32*e.m33,_=this.m03*e.m30+this.m13*e.m31+this.m23*e.m32+this.m33*e.m33;return T.create(t,r,l,d,i,o,u,p,n,a,h,m,s,c,f,_)}timesRect(e){const t=this.timesPoint(x.a.create(e.x0,e.y0)),i=this.timesPoint(x.a.create(e.x1,e.y1));return S.a.create(t.x,t.y,i.x,i.y)}invert(){const e=[[this.m00,this.m01,this.m02,this.m03],[this.m10,this.m11,this.m12,this.m13],[this.m20,this.m21,this.m22,this.m23],[this.m30,this.m31,this.m32,this.m33]];let t,i=0,n=0;const s=e.length;let r=0;const o=[],a=[];for(t=0;t<s;t+=1)for(o[o.length]=[],a[a.length]=[],n=0;n<s;n+=1)o[t][n]=t===n?1:0,a[t][n]=e[t][n];for(t=0;t<s;t+=1){if(0===(r=a[t][t])){for(i=t+1;i<s;i+=1)if(0!==a[i][t]){for(n=0;n<s;n++)r=a[t][n],a[t][n]=a[i][n],a[i][n]=r,r=o[t][n],o[t][n]=o[i][n],o[i][n]=r;break}if(0===(r=a[t][t]))return}for(n=0;n<s;n++)a[t][n]=a[t][n]/r,o[t][n]=o[t][n]/r;for(i=0;i<s;i++)if(i!==t)for(r=a[i][t],n=0;n<s;n++)a[i][n]-=r*a[t][n],o[i][n]-=r*o[t][n]}return T.create(o[0][0],o[1][0],o[2][0],o[3][0],o[0][1],o[1][1],o[2][1],o[3][1],o[0][2],o[1][2],o[2][2],o[3][2],o[0][3],o[1][3],o[2][3],o[3][3])}clone(){return T.create(this.m00,this.m10,this.m20,this.m30,this.m01,this.m11,this.m21,this.m31,this.m02,this.m12,this.m22,this.m32,this.m03,this.m13,this.m23,this.m33)}toCssMatrix(){return`matrix3d(${this.m00}, ${this.m01}, ${this.m02}, ${this.m03}, ${this.m10}, ${this.m11}, ${this.m12}, ${this.m13}, ${this.m20}, ${this.m21}, ${this.m22}, ${this.m23}, ${this.m30}, ${this.m31}, ${this.m32}, ${this.m33})`}}var E=i(4);class R{static create(e,t){const i=document.createElement("canvas");i.width=e,i.height=t,i.style.display="inline",i.style.zIndex="0";const n=i.getContext("2d");n.canvas||(n.canvas=i);const s=document.createElement("canvas");s.width=e,s.height=t,s.style.display="none",s.style.zIndex="0";const r=s.getContext("2d");r.canvas||(r.canvas=s);const o=document.createElement("div");return o.style.display="contents",o.appendChild(i),o.appendChild(s),new R(n,r,o)}constructor(e,t,i){this.frontContext=e,this.backContext=t,this.inputDivs=[],this.containerDiv=i,this.view=null}drawBackBuffer(e){this._draw(this.backContext,e)}_draw(e,t){const i=e.canvas;t instanceof ImageData?(i.width===t.width&&i.height===t.height||(i.width=t.width,i.height=t.height),e.putImageData(t,0,0)):(i.width!==t.width||i.height!==t.height?(i.width=t.width,i.height=t.height):e.clearRect(0,0,i.width,i.height),e.drawImage(t,0,0))}swapBuffers(){const e=this.frontContext;this.frontContext=this.backContext,this.backContext=e,this.backContext.canvas.style.display="none",this.frontContext.canvas.style.display="inline",this.containerDiv.style.transform=this.frontContext.canvas.style.transform,this.frontContext.canvas.style.transform="inherit",this.backContext.canvas.style.transform=this.containerDiv.style.transform}set zIndex(e){const t=e.toString(10);this.frontContext.canvas.style.zIndex=t,this.backContext.canvas.style.zIndex=t,this.inputDivs.forEach(e=>{e.style.zIndex=t+1})}size(){return E.a.create(this.frontContext.canvas.width,this.frontContext.canvas.height)}addCssClass(e){this.frontContext.canvas.classList.add(e),this.backContext.canvas.classList.add(e)}removeCssClass(e){this.frontContext.canvas.classList.remove(e),this.backContext.canvas.classList.remove(e)}_detachInputDivs(){this.inputDivs.forEach(e=>{e.parentElement&&e.parentElement.removeChild(e)})}_syncDivToRect(e,t){const i=t.size;e.style.left=`${t.x0}px`,e.style.top=`${t.y0}px`,e.style.width=`${i.w}px`,e.style.height=`${i.h}px`}updateInputRegionElements(e){if(this.inputDivs.length!==e.length)this._detachInputDivs(),this.inputDivs=[],e.forEach(e=>{const t=document.createElement("div");t.view=this.view,t.classList.add("inputRegion"),t.style.zIndex=this.frontContext.canvas.style.zIndex+1,this._syncDivToRect(t,e),this.containerDiv.appendChild(t),this.inputDivs.push(t)});else for(let t=0;t<e.length;t++){const i=e[t],n=this.inputDivs[t];this._syncDivToRect(n,i)}}attachToElement(e){e.appendChild(this.containerDiv)}isAttachedToElement(){return null!==this.containerDiv.parentElement}detachFromElement(){this.containerDiv.parentElement&&this.containerDiv.parentElement.removeChild(this.containerDiv)}setElementTransformation(e){this.containerDiv.style.transform=e}setBackBufferElementTransformation(e){this.backContext.canvas.style.transform=e}getParentElement(){return this.containerDiv.parentElement}}var C=i(37),A=i.n(C);var D=function(e){const t=null;(e=void 0!==(e=e||{})?e:{}).ENVIRONMENT="WEB";let i,n={};for(i in e)e.hasOwnProperty(i)&&(n[i]=e[i]);e.arguments=[],e.thisProgram="./this.program",e.quit=function(e,t){throw t},e.preRun=[],e.postRun=[];let s=!1,r=!1;if(e.ENVIRONMENT)if("WEB"===e.ENVIRONMENT)s=!0;else{if("WORKER"!==e.ENVIRONMENT)throw new Error("Module['ENVIRONMENT'] value is not valid. must be one of: WEB|WORKER.");r=!0}else s="object"==typeof window,r="function"==typeof importScripts;for(i in(s||r)&&(e.read=function(e){const t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},r&&(e.readBinary=function(e){const t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),e.readAsync=function(e,t,i){const n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="arraybuffer",n.onload=function(){200==n.status||0==n.status&&n.response?t(n.response):i()},n.onerror=i,n.send(null)},void 0!==arguments&&(e.arguments=arguments),e.setWindowTitle=function(e){document.title=e}),e.print=console.log.bind(console),e.printErr=console.warn.bind(console)||e.print,e.print=e.print,e.printErr=e.printErr,n)n.hasOwnProperty(i)&&(e[i]=n[i]);n=void 0;const o=16;function a(e){h(!S);const t=x;return x=x+e+15&-16,t}function c(e,t){return t||(t=o),e=Math.ceil(e/t)*t}new Array(0);let l=0,u=0;function h(e,t){e||ne("Assertion failed: "+t)}function f(e,t){if(0===t||!e)return"";let i,n=0,s=0;for(;n|=i=w[e+s>>0],(0!=i||t)&&(s++,!t||s!=t););t||(t=s);let r="";if(n<128){const i=1024;let n;for(;t>0;)n=String.fromCharCode.apply(String,w.subarray(e,e+Math.min(t,i))),r=r?r+n:n,e+=i,t-=i;return r}return function(e){return p(w,e)}(e)}const d="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function p(e,t){let i=t;for(;e[i];)++i;if(i-t>16&&e.subarray&&d)return d.decode(e.subarray(t,i));{let i,n,s,r,o,a,c="";for(;;){if(!(i=e[t++]))return c;if(128&i)if(n=63&e[t++],192!=(224&i))if(s=63&e[t++],224==(240&i)?i=(15&i)<<12|n<<6|s:(r=63&e[t++],240==(248&i)?i=(7&i)<<18|n<<12|s<<6|r:(o=63&e[t++],i=248==(252&i)?(3&i)<<24|n<<18|s<<12|r<<6|o:(1&i)<<30|n<<24|s<<18|r<<12|o<<6|(a=63&e[t++]))),i<65536)c+=String.fromCharCode(i);else{const e=i-65536;c+=String.fromCharCode(55296|e>>10,56320|1023&e)}else c+=String.fromCharCode((31&i)<<6|n);else c+=String.fromCharCode(i)}}}"undefined"!=typeof TextDecoder&&new TextDecoder("utf-16le");const m=65536,_=16777216;var g,y,w,b,v,x,S;function T(){e.HEAP8=y=new Int8Array(g),e.HEAP16=b=new Int16Array(g),e.HEAP32=v=new Int32Array(g),e.HEAPU8=w=new Uint8Array(g),e.HEAPU16=new Uint16Array(g),e.HEAPU32=new Uint32Array(g),e.HEAPF32=new Float32Array(g),e.HEAPF64=new Float64Array(g)}let E,R,C,A,D;function O(){ne("Cannot enlarge memory arrays. Either (1) compile with  -s TOTAL_MEMORY=X  with X higher than the current value "+k+", (2) compile with  -s ALLOW_MEMORY_GROWTH=1  which allows increasing the size at runtime, or (3) if you want malloc to return NULL (0) instead of this abort, compile with  -s ABORTING_MALLOC=0 ")}x=E=R=C=A=D=0,S=!1;const M=e.TOTAL_STACK||5242880;var k=e.TOTAL_MEMORY||16777216;if(k<M&&e.printErr("TOTAL_MEMORY should be larger than TOTAL_STACK, was "+k+"! (TOTAL_STACK="+M+")"),e.buffer?g=e.buffer:("object"==typeof window.WebAssembly&&"function"==typeof window.WebAssembly.Memory?(e.wasmMemory=new window.WebAssembly.Memory({initial:k/m,maximum:k/m}),g=e.wasmMemory.buffer):g=new ArrayBuffer(k),e.buffer=g),T(),v[0]=1668509029,b[1]=25459,115!==w[2]||99!==w[3])throw new Error("Runtime error: expected the system to be little-endian!");function P(t){for(;t.length>0;){let i=t.shift();if("function"==typeof i){i();continue}let n=i.func;"number"==typeof n?void 0===i.arg?e.dynCall_v(n):e.dynCall_vi(n,i.arg):n(void 0===i.arg?null:i.arg)}}const I=[],L=[],B=[],F=[],z=[];let U=!1,N=!1;function j(e,t,i){for(let i=0;i<e.length;++i)y[t++>>0]=e.charCodeAt(i);i||(y[t>>0]=0)}Math.abs,Math.cos,Math.sin,Math.tan,Math.acos,Math.asin,Math.atan,Math.atan2,Math.exp,Math.log,Math.sqrt,Math.ceil,Math.floor,Math.pow,Math.imul,Math.fround,Math.round,Math.min,Math.max,Math.clz32,Math.trunc;let G=0,W=null,V=null;e.preloadedImages={},e.preloadedAudios={};const K="data:application/octet-stream;base64,";function X(e){return String.prototype.startsWith?e.startsWith(K):0===e.indexOf(K)}!function(){let t="libpixman-1.wast",i="libpixman-1.wasm",n="libpixman-1.temp.asm.js";"function"==typeof e.locateFile&&(X(t)||(t=e.locateFile(t)),X(i)||(i=e.locateFile(i)),X(n)||(n=e.locateFile(n)));const o={global:null,env:null,asm2wasm:{"f64-rem":function(e,t){return e%t},debugger:function(){}},parent:e};let a=null;function c(t){const i=e.buffer;t.byteLength<i.byteLength&&e.printErr("the new buffer in mergeMemory is smaller than the previous one. in native wasm, we should grow memory here");const n=new Int8Array(i);var s;new Int8Array(t).set(n),s=t,e.buffer=g=s,T()}function l(){try{if(e.wasmBinary)return new Uint8Array(e.wasmBinary);if(e.readBinary)return e.readBinary(i);throw new Error("on the web, we need the wasm binary to be preloaded and set on Module['wasmBinary']. emcc.py will do that for you when generating HTML (but not JS)")}catch(e){ne(e)}}function u(t,n,u){if("object"!=typeof window.WebAssembly)return e.printErr("no native wasm support detected"),!1;if(!(e.wasmMemory instanceof window.WebAssembly.Memory))return e.printErr("no native wasm Memory in use"),!1;function h(t,i){(a=t.exports).memory&&c(a.memory),e.asm=a,e.usingWasm=!0,function(t){if(G--,e.monitorRunDependencies&&e.monitorRunDependencies(G),0==G&&(null!==W&&(clearInterval(W),W=null),V)){const e=V;V=null,e()}}()}if(n.memory=e.wasmMemory,o.global={NaN:NaN,Infinity:1/0},o["global.Math"]=Math,o.env=n,G++,e.monitorRunDependencies&&e.monitorRunDependencies(G),e.instantiateWasm)try{return e.instantiateWasm(o,h)}catch(t){return e.printErr("Module.instantiateWasm callback failed with error: "+t),!1}function f(e){h(e.instance,e.module)}function d(t){(e.wasmBinary||!s&&!r||"function"!=typeof fetch?new Promise(function(e,t){e(l())}):fetch(i,{credentials:"same-origin"}).then(function(e){if(!e.ok)throw new Error("failed to load wasm binary file at '"+i+"'");return e.arrayBuffer()}).catch(function(){return l()})).then(function(e){return window.WebAssembly.instantiate(e,o)}).then(t).catch(function(t){e.printErr("failed to asynchronously prepare wasm: "+t),ne(t)})}return e.wasmBinary||"function"!=typeof window.WebAssembly.instantiateStreaming||X(i)||"function"!=typeof fetch?d(f):window.WebAssembly.instantiateStreaming(fetch(i,{credentials:"same-origin"}),o).then(f).catch(function(t){e.printErr("wasm streaming compile failed: "+t),e.printErr("falling back to ArrayBuffer instantiation"),d(f)}),{}}e.asmPreload=e.asm;const h=e.reallocBuffer;e.reallocBuffer=function(t){return"asmjs"===f?h(t):function(t){const i=e.usingWasm?m:_;var n,s;(n=t)%(s=i)>0&&(n+=s-n%s),t=n;const r=e.buffer.byteLength;if(e.usingWasm)try{return-1!==e.wasmMemory.grow((t-r)/65536)?e.buffer=e.wasmMemory.buffer:null}catch(e){return null}}(t)};var f="";e.asm=function(t,i,n){if(!(i=i).table){let t=e.wasmTableSize;void 0===t&&(t=1024);const n=e.wasmMaxTableSize;"object"==typeof window.WebAssembly&&"function"==typeof window.WebAssembly.Table?i.table=void 0!==n?new window.WebAssembly.Table({initial:t,maximum:n,element:"anyfunc"}):new window.WebAssembly.Table({initial:t,element:"anyfunc"}):i.table=new Array(t),e.wasmTable=i.table}let s;return i.memoryBase||(i.memoryBase=e.STATIC_BASE),i.tableBase||(i.tableBase=0),(s=u(0,i))||ne("no binaryen method succeeded. consider enabling more options, like interpreting, if you want that: https://github.com/kripken/emscripten/wiki/WebAssembly#binaryen-methods"),s}}(),x=20368,L.push({func:function(){J()}});e.STATIC_BASE=1024,e.STATIC_BUMP=19344;const q={varargs:0,get:function(e){return q.varargs+=4,v[q.varargs-4>>2]},getStr:function(){return f(q.get())},get64:function(){const e=q.get(),t=q.get();return h(e>=0?0===t:-1===t),e},getZero:function(){h(0===q.get())}};const H=x+=16;x+=16;var $={};!function t(i){let n,s;t.called?(s=v[H>>2],n=v[s>>2]):(t.called=!0,$.USER=$.LOGNAME="web_user",$.PATH="/",$.PWD="/",$.HOME="/home/web_user",$.LANG="C.UTF-8",$._=e.thisProgram,n=a(1024),s=a(256),v[s>>2]=n,v[H>>2]=s);const r=[];let o=0;for(let e in i)if("string"==typeof i[e]){var c=e+"="+i[e];r.push(c),o+=c.length}if(o>1024)throw new Error("Environment size exceeded TOTAL_ENV_SIZE!");for(let e=0;e<r.length;e++)j(c=r[e],n),v[s+4*e>>2]=n,n+=c.length+1;v[s+4*r.length>>2]=0}($),D=a(4),E=R=c(x),A=c(C=E+M),v[D>>2]=A,S=!0,e.wasmTableSize=737,e.wasmMaxTableSize=737,e.asmGlobalArg={},e.asmLibraryArg={abort:ne,enlargeMemory:function(){O()},getTotalMemory:function(){return k},abortOnCannotGrowMemory:O,___assert_fail:function(e,t,i,n){ne("Assertion failed: "+f(e)+", at: "+[t?f(t):"unknown filename",i,n?f(n):"unknown function"])},___setErrNo:function(t){return e.___errno_location&&(v[e.___errno_location()>>2]=t),t},___syscall140:function(e,t){q.varargs=t;try{const e=q.getStreamFromFD(),t=(q.get(),q.get()),i=q.get(),n=q.get(),s=t;return null.llseek(e,s,n),v[i>>2]=e.position,e.getdents&&0===s&&0===n&&(e.getdents=null),0}catch(e){return e instanceof null.ErrnoError||ne(e),-e.errno}},___syscall146:function i(n,s){q.varargs=s;try{const n=q.get(),s=q.get(),r=q.get();let o=0;i.buffers||(i.buffers=[null,[],[]],i.printChar=function(t,n){const s=i.buffers[t];h(s),0===n||10===n?((1===t?e.print:e.printErr)(p(s,0)),s.length=0):s.push(n)});for(let e=0;e<r;e++){const t=v[s+8*e>>2],r=v[s+(8*e+4)>>2];for(let e=0;e<r;e++)i.printChar(n,w[t+e]);o+=r}return o}catch(e){return void 0!==t&&e instanceof t.ErrnoError||ne(e),-e.errno}},___syscall54:function(e,i){q.varargs=i;try{return 0}catch(e){return void 0!==t&&e instanceof t.ErrnoError||ne(e),-e.errno}},___syscall6:function(e,i){q.varargs=i;try{const e=q.getStreamFromFD();return t.close(e),0}catch(e){return void 0!==t&&e instanceof t.ErrnoError||ne(e),-e.errno}},_abort:function(){e.abort()},_emscripten_memcpy_big:function(e,t,i){return w.set(w.subarray(t,t+i),e),e},_getenv:function e(t){return 0===t?0:(t=f(t),$.hasOwnProperty(t)?(e.ret&&Z(e.ret),e.ret=function(e){const t=function(e){let t=0;for(let i=0;i<e.length;++i){let n=e.charCodeAt(i);n>=55296&&n<=57343&&(n=65536+((1023&n)<<10)|1023&e.charCodeAt(++i)),n<=127?++t:t+=n<=2047?2:n<=65535?3:n<=2097151?4:n<=67108863?5:6}return t}(e)+1,i=Q(t);return i&&function(e,t,i,n){if(!(n>0))return 0;const s=i+n-1;for(let n=0;n<e.length;++n){let r=e.charCodeAt(n);if(r>=55296&&r<=57343&&(r=65536+((1023&r)<<10)|1023&e.charCodeAt(++n)),r<=127){if(i>=s)break;t[i++]=r}else if(r<=2047){if(i+1>=s)break;t[i++]=192|r>>6,t[i++]=128|63&r}else if(r<=65535){if(i+2>=s)break;t[i++]=224|r>>12,t[i++]=128|r>>6&63,t[i++]=128|63&r}else if(r<=2097151){if(i+3>=s)break;t[i++]=240|r>>18,t[i++]=128|r>>12&63,t[i++]=128|r>>6&63,t[i++]=128|63&r}else if(r<=67108863){if(i+4>=s)break;t[i++]=248|r>>24,t[i++]=128|r>>18&63,t[i++]=128|r>>12&63,t[i++]=128|r>>6&63,t[i++]=128|63&r}else{if(i+5>=s)break;t[i++]=252|r>>30,t[i++]=128|r>>24&63,t[i++]=128|r>>18&63,t[i++]=128|r>>12&63,t[i++]=128|r>>6&63,t[i++]=128|63&r}}t[i]=0}(e,y,i,t),i}($[t])):0)},DYNAMICTOP_PTR:D,STACKTOP:R};const Y=e.asm(e.asmGlobalArg,e.asmLibraryArg,g);e.asm=Y;var Z=e._free=function(){return e.asm._free.apply(null,arguments)},Q=e._malloc=function(){return e.asm._malloc.apply(null,arguments)},J=e._pixman_constructor=function(){return e.asm._pixman_constructor.apply(null,arguments)};e._pixman_region32_clear=function(){return e.asm._pixman_region32_clear.apply(null,arguments)},e._pixman_region32_contains_point=function(){return e.asm._pixman_region32_contains_point.apply(null,arguments)},e._pixman_region32_copy=function(){return e.asm._pixman_region32_copy.apply(null,arguments)},e._pixman_region32_fini=function(){return e.asm._pixman_region32_fini.apply(null,arguments)},e._pixman_region32_init=function(){return e.asm._pixman_region32_init.apply(null,arguments)},e._pixman_region32_intersect=function(){return e.asm._pixman_region32_intersect.apply(null,arguments)},e._pixman_region32_init_rect=function(){return e.asm._pixman_region32_init_rect.apply(null,arguments)},e._pixman_region32_rectangles=function(){return e.asm._pixman_region32_rectangles.apply(null,arguments)},e._pixman_region32_subtract=function(){return e.asm._pixman_region32_subtract.apply(null,arguments)},e._pixman_region32_union=function(){return e.asm._pixman_region32_union.apply(null,arguments)},e._pixman_region32_union_rect=function(){return e.asm._pixman_region32_union_rect.apply(null,arguments)},e.dynCall_vi=function(){return e.asm.dynCall_vi.apply(null,arguments)};function ee(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}let te;function ie(t){function i(){e.calledRun||(e.calledRun=!0,l||(U||(U=!0,P(L)),P(B),e.onRuntimeInitialized&&e.onRuntimeInitialized(),function(){if(e.postRun)for("function"==typeof e.postRun&&(e.postRun=[e.postRun]);e.postRun.length;)t=e.postRun.shift(),z.unshift(t);var t;P(z)}()))}t=t||e.arguments,G>0||(function(){if(e.preRun)for("function"==typeof e.preRun&&(e.preRun=[e.preRun]);e.preRun.length;)t=e.preRun.shift(),I.unshift(t);var t;P(I)}(),G>0||e.calledRun||(e.setStatus?(e.setStatus("Running..."),setTimeout(function(){setTimeout(function(){e.setStatus("")},1),i()},1)):i()))}function ne(t){throw e.onAbort&&e.onAbort(t),void 0!==t?(e.print(t),e.printErr(t),t=JSON.stringify(t)):t="",l=!0,u=1,new Error("abort("+t+"). Build with -s ASSERTIONS=1 for more info.")}if(e.asm=Y,e.then=function(t){if(e.calledRun)t(e);else{const i=e.onRuntimeInitialized;e.onRuntimeInitialized=function(){i&&i(),t(e)}}return e},ee.prototype=new Error,ee.prototype.constructor=ee,V=function t(){e.calledRun||ie(),e.calledRun||(V=t)},e.run=ie,e.exit=function(t,i){i&&e.noExitRuntime&&0===t||(e.noExitRuntime||(l=!0,u=t,R=te,P(F),N=!0,e.onExit&&e.onExit(t)),e.quit(t,new ee(t)))},e.abort=ne,e.preInit)for("function"==typeof e.preInit&&(e.preInit=[e.preInit]);e.preInit.length>0;)e.preInit.pop()();return e.noExitRuntime=!0,ie(),e}();class O extends A.a{static create(e){const t=O.createPixmanRegion(),i=new O(e,t);return e.implementation=i,e.onDestroy().then(()=>{O.destroyPixmanRegion(t)}),i}static createPixmanRegion(){const e=D._malloc(20);return D._pixman_region32_init(e),e}static fini(e){D._pixman_region32_fini(e)}static initInfinite(e){D._pixman_region32_init_rect(e,-1073741823,-1073741823,2147483647,2147483647)}static initRect(e,t){D._pixman_region32_init_rect(e,t.x0,t.y0,t.x1-t.x0,t.y1-t.y0)}static union(e,t,i){D._pixman_region32_union(e,t,i)}static intersect(e,t,i){D._pixman_region32_intersect(e,t,i)}static unionRect(e,t,i,n,s,r){D._pixman_region32_union_rect(e,t,i,n,s,r)}static destroyPixmanRegion(e){D._pixman_region32_fini(e),D._free(e)}static rectangles(e){const t=D._malloc(4),i=D._pixman_region32_rectangles(e,t),n=[],s=new Uint32Array(D.HEAPU8.buffer,t,1)[0],r=new Uint32Array(D.HEAPU8.buffer,i,4*s);for(let e=0;e<s;e++){const t=r[4*e],i=r[4*e+1],s=r[4*e+2],o=r[4*e+3];n.push(S.a.create(t,i,s,o))}return D._free(t),n}constructor(e,t){super(),this.resource=e,this.pixmanRegion=t}destroy(e){e.destroy()}add(e,t,i,n,s){D._pixman_region32_union_rect(this.pixmanRegion,this.pixmanRegion,t,i,n,s)}subtract(e,t,i,n,s){const r=D._malloc(20);D._pixman_region32_init_rect(r,t,i,n,s),D._pixman_region32_subtract(this.pixmanRegion,this.pixmanRegion,r),O.destroyPixmanRegion(r)}static contains(e,t){return 0!==D._pixman_region32_contains_point(e,t.x,t.y,null)}static copyTo(e,t){D._pixman_region32_copy(e,t)}}var M=O;class k{static create(e,t){const i=e.createTexture();return e.bindTexture(e.TEXTURE_2D,i),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.bindTexture(e.TEXTURE_2D,null),new k(e,t,i)}constructor(e,t,i){this.gl=e,this.texture=i,this.format=t}subImage2dBuffer(e,t,i){const n=this.gl;n.pixelStorei(n.UNPACK_ROW_LENGTH,i),n.bindTexture(n.TEXTURE_2D,this.texture),n.texSubImage2D(n.TEXTURE_2D,0,t.x0,t.y0,t.width,t.height,this.format,n.UNSIGNED_BYTE,e),n.bindTexture(n.TEXTURE_2D,null),n.pixelStorei(n.UNPACK_ROW_LENGTH,0)}image2dBuffer(e,t,i,n){const s=this.gl;s.pixelStorei(s.UNPACK_ROW_LENGTH,n),s.bindTexture(s.TEXTURE_2D,this.texture),s.texImage2D(s.TEXTURE_2D,0,this.format,t,i,0,this.format,s.UNSIGNED_BYTE,e),s.bindTexture(s.TEXTURE_2D,null),s.pixelStorei(s.UNPACK_ROW_LENGTH,0)}subImage2dElement(e,t){const i=this.gl;i.bindTexture(i.TEXTURE_2D,this.texture),i.texSubImage2D(i.TEXTURE_2D,0,t.x0,t.y0,this.format,i.UNSIGNED_BYTE,e),i.bindTexture(i.TEXTURE_2D,null)}image2dElement(e){const t=this.gl;t.bindTexture(t.TEXTURE_2D,this.texture),t.texImage2D(t.TEXTURE_2D,0,this.format,this.format,t.UNSIGNED_BYTE,e),t.bindTexture(t.TEXTURE_2D,null)}delete(){this.gl.deleteTexture(this.texture),this.texture=null}}class P{update(e){}destroy(){}}class I{static splitAlpha(e){return 0!=(e&I._ALPHA)}static fullFrame(e){return 0!=(e&I._FULL_FRAME)}}I._ALPHA=1,I._FULL_FRAME=2;var L=I;class B extends P{static create(e){return new B(e)}constructor(e){super(),this.gl=e,this.opaqueTexture=k.create(this.gl,this.gl.RGBA),this.alphaTexture=k.create(this.gl,this.gl.RGBA),this.size=E.a.create(0,0)}async update(e){const t=L.splitAlpha(e.encodingOptions),i=!this.size.equals(e.size);i&&(this.size=e.size),await Promise.all(e.pixelContent.map(async e=>{const n=window.createImageBitmap(new window.Blob([e.opaque],{type:"image/jpeg"}),0,0,e.geo.width,e.geo.height);let s=null;t&&(s=window.createImageBitmap(new window.Blob([e.alpha],{type:"image/jpeg"}),0,0,e.geo.width,e.geo.height)),i?(this.opaqueTexture.image2dElement(await n),t&&this.alphaTexture.image2dElement(await s)):(this.opaqueTexture.subImage2dElement(await n,e.geo),t&&this.alphaTexture.subImage2dElement(await s,e.geo))}))}destroy(){this.opaqueTexture.delete(),this.alphaTexture.delete()}}class F{constructor(e){this.gl=e,this.program=this.gl.createProgram()}attach(e){this.gl.attachShader(this.program,e)}link(){this.gl.linkProgram(this.program),this.gl.getProgramParameter(this.program,this.gl.LINK_STATUS)||console.error("Unable to initialize the shader program.")}use(){this.gl.useProgram(this.program)}getAttributeLocation(e){return this.gl.getAttribLocation(this.program,e)}getUniformLocation(e){return this.gl.getUniformLocation(this.program,e)}setUniformM4(e,t){this.gl.uniformMatrix4fv(e,!1,t)}}class z{static compile(e,t){let i;if("x-shader/x-fragment"===t.type)i=e.createShader(e.FRAGMENT_SHADER);else{if("x-shader/x-vertex"!==t.type)throw new Error("Unknown shader type: "+t.type);i=e.createShader(e.VERTEX_SHADER)}if(e.shaderSource(i,t.source),e.compileShader(i),!e.getShaderParameter(i,e.COMPILE_STATUS))throw new Error("An error occurred compiling the shaders: "+e.getShaderInfoLog(i));return i}}const U={type:"x-shader/x-vertex",source:"\n  precision mediump float;\n\n  uniform mat4 u_projection;\n  attribute vec2 a_position;\n  attribute vec2 a_texCoord;\n  varying vec2 v_texCoord;\n  void main(){\n      v_texCoord = a_texCoord;\n      gl_Position = u_projection * vec4(a_position, 0.0, 1.0);\n  }\n"},N={type:"x-shader/x-fragment",source:"\n  precision mediump float;\n  \n  varying vec2 v_texCoord;\n  \n  uniform sampler2D opaqueTexture;\n  uniform sampler2D alphaTexture;\n\n  void main(void) {\n   vec4 pix = texture2D(opaqueTexture, v_texCoord);\n   vec4 alphaPix = texture2D(alphaTexture, v_texCoord);\n   pix.a = alphaPix.r * 1.1644 - 0.07312;\n   pix.r = pix.r * 1.1644 - 0.07312;\n   pix.g = pix.g * 1.1644 - 0.07312;\n   pix.b = pix.b * 1.1644 - 0.07312;\n   gl_FragColor = pix;\n  }\n"},j={type:"x-shader/x-fragment",source:"\n  precision mediump float;\n  \n  varying vec2 v_texCoord;\n  \n  uniform sampler2D opaqueTexture;\n\n  void main(void) {\n   gl_FragColor = texture2D(opaqueTexture, v_texCoord);\n  }\n"},G={type:"x-shader/x-fragment",source:"\n  precision lowp float;\n  \n  varying vec2 v_texCoord;\n  \n  uniform sampler2D yTexture;\n  uniform sampler2D uTexture;\n  uniform sampler2D vTexture;\n  uniform sampler2D alphaYTexture;\n    \n  const mat4 YUV2RGB = mat4\n  (\n   1.1643828125,             0, 1.59602734375, -.87078515625,\n   1.1643828125, -.39176171875,    -.81296875,     .52959375,\n   1.1643828125,   2.017234375,             0,  -1.081390625,\n              0,             0,             0,             1\n  );\n\n  void main(void) {\n   vec4 pix = vec4(texture2D(yTexture,  v_texCoord).x, texture2D(uTexture, v_texCoord).x, texture2D(vTexture, v_texCoord).x, 1) * YUV2RGB;\n   pix.w = (vec4(texture2D(alphaYTexture,  v_texCoord).x, 0.5019607843137255, 0.5019607843137255, 1) * YUV2RGB).x;\n   gl_FragColor = pix;\n  }\n"},W={type:"x-shader/x-fragment",source:"\n  precision lowp float;\n  \n  varying vec2 v_texCoord;\n  \n  uniform sampler2D yTexture;\n  uniform sampler2D uTexture;\n  uniform sampler2D vTexture;\n    \n  const mat4 YUV2RGB = mat4\n  (\n   1.1643828125,             0, 1.59602734375, -.87078515625,\n   1.1643828125, -.39176171875,    -.81296875,     .52959375,\n   1.1643828125,   2.017234375,             0,  -1.081390625,\n              0,             0,             0,             1\n  );\n\n  void main(void) {\n   vec4 pix = vec4(texture2D(yTexture,  v_texCoord).x, texture2D(uTexture, v_texCoord).x, texture2D(vTexture, v_texCoord).x, 1) * YUV2RGB;\n   pix.w = 1.0;\n   // pix.w = 1.0;\n   gl_FragColor = pix;\n  }\n"};class V{static create(e){const t=this._initShaders(e),i=this._initShaderArgs(e,t),n=this._initBuffers(e);return new V(e,n,i,t)}static _initShaders(e){const t=new F(e);return t.attach(z.compile(e,U)),t.attach(z.compile(e,N)),t.link(),t.use(),t}static _initShaderArgs(e,t){const i={};return i.opaqueTexture=t.getUniformLocation("opaqueTexture"),i.alphaTexture=t.getUniformLocation("alphaTexture"),i.u_projection=t.getUniformLocation("u_projection"),i.a_position=t.getAttributeLocation("a_position"),e.enableVertexAttribArray(i.a_position),i.a_texCoord=t.getAttributeLocation("a_texCoord"),e.enableVertexAttribArray(i.a_texCoord),i}static _initBuffers(e){return e.createBuffer()}constructor(e,t,i,n){this.gl=e,this.vertexBuffer=t,this.shaderArgs=i,this.program=n}setTexture(e,t){const i=this.gl;i.uniform1i(this.shaderArgs.opaqueTexture,0),i.uniform1i(this.shaderArgs.alphaTexture,1),i.activeTexture(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,e.texture),i.activeTexture(i.TEXTURE1),i.bindTexture(i.TEXTURE_2D,t.texture)}use(){this.program.use()}release(){this.gl.useProgram(null)}updatePerspective(e){const t=this.gl,{w:i,h:n}=e;t.viewport(0,0,i,n),this.program.setUniformM4(this.shaderArgs.u_projection,[2/i,0,0,0,0,2/-n,0,0,0,0,1,0,-1,1,0,1]),t.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(this.gl.ARRAY_BUFFER,new Float32Array([0,0,0,0,i,0,1,0,i,n,1,1,i,n,1,1,0,n,0,1,0,0,0,0]),this.gl.DYNAMIC_DRAW),t.vertexAttribPointer(this.shaderArgs.a_position,2,t.FLOAT,!1,16,0),t.vertexAttribPointer(this.shaderArgs.a_texCoord,2,t.FLOAT,!1,16,8)}draw(){const e=this.gl;e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT|e.STENCIL_BUFFER_BIT),e.drawArrays(this.gl.TRIANGLE_STRIP,0,6),e.bindTexture(e.TEXTURE_2D,null)}}class K{static create(e){const t=this._initShaders(e),i=this._initShaderArgs(e,t),n=this._initBuffers(e);return new K(e,n,i,t)}static _initShaders(e){const t=new F(e);return t.attach(z.compile(e,U)),t.attach(z.compile(e,j)),t.link(),t.use(),t}static _initShaderArgs(e,t){const i={};return i.opaqueTexture=t.getUniformLocation("opaqueTexture"),i.u_projection=t.getUniformLocation("u_projection"),i.a_position=t.getAttributeLocation("a_position"),e.enableVertexAttribArray(i.a_position),i.a_texCoord=t.getAttributeLocation("a_texCoord"),e.enableVertexAttribArray(i.a_texCoord),i}static _initBuffers(e){return e.createBuffer()}constructor(e,t,i,n){this.gl=e,this.vertexBuffer=t,this.shaderArgs=i,this.program=n}setTexture(e){const t=this.gl;t.uniform1i(this.shaderArgs.opaqueTexture,0),t.uniform1i(this.shaderArgs.alphaTexture,1),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,e.texture)}use(){this.program.use()}release(){this.gl.useProgram(null)}updatePerspective(e){const t=this.gl,{w:i,h:n}=e;t.viewport(0,0,i,n),this.program.setUniformM4(this.shaderArgs.u_projection,[2/i,0,0,0,0,2/-n,0,0,0,0,1,0,-1,1,0,1]),t.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(this.gl.ARRAY_BUFFER,new Float32Array([0,0,0,0,i,0,1,0,i,n,1,1,i,n,1,1,0,n,0,1,0,0,0,0]),this.gl.DYNAMIC_DRAW),t.vertexAttribPointer(this.shaderArgs.a_position,2,t.FLOAT,!1,16,0),t.vertexAttribPointer(this.shaderArgs.a_texCoord,2,t.FLOAT,!1,16,8)}draw(){const e=this.gl;e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT|e.STENCIL_BUFFER_BIT),e.drawArrays(this.gl.TRIANGLE_STRIP,0,6),e.bindTexture(e.TEXTURE_2D,null)}}class X{static async create(e){const t=await X._tinyH264WorkerPromise,i=new X(t,e);return X.h264NalDecoders[e]=i,i}constructor(e,t){this._tinyH264Worker=e,this._renderStateId=t,this._busy=!1,this._decodeQueue=[]}decode(e){this._busy?this._decodeQueue.push(e):(this._tinyH264Worker.postMessage({type:"decode",data:e.buffer,renderStateId:this._renderStateId},[e.buffer]),this._busy=!0)}onPictureReady(e){const{width:t,height:i,data:n}=e;if(this._decodeQueue.length>0){const e=this._decodeQueue.shift();this._tinyH264Worker.postMessage({type:"decode",data:e.buffer,renderStateId:this._renderStateId},[e.buffer])}else this._busy=!1;this.onPicture(new Uint8Array(n),t,i)}onPicture(e,t,i){}release(){this._tinyH264Worker&&(this._tinyH264Worker.postMessage({type:"release",renderStateId:this._renderStateId}),this._tinyH264Worker=null)}}X.h264NalDecoders={},X._tinyH264WorkerPromise=new Promise(e=>{const t=new window.Worker("TinyH264Worker.js");t.addEventListener("message",i=>{const n=i.data;switch(n.type){case"pictureReady":X.h264NalDecoders[n.renderStateId].onPictureReady(n);break;case"decoderReady":e(t)}})});class q{static create(){return new q}constructor(){this._decoder=null,this._decoderFactory=null,this._decodingSerialsQueue=[],this._alphaDecoder=null,this._alphaDecoderFactory=null,this._decodingAlphaSerialsQueue=[],this._frameStates={}}async decode(e){return new Promise(t=>{this._frameStates[e.serial]={serial:e.serial,resolve:t,state:"pending",result:{opaque:null,alpha:null}},this._decodeH264(e)})}async _ensureH264Decoders(e){if(!this._decoder){this._decoderFactory||(this._decoderFactory=X.create(q._nextDecoderId++));const e=await this._decoderFactory;e.onPicture=((e,t,i)=>{this._onPictureDecoded(e,t,i)}),this._decoder=e}if(e&&!this._alphaDecoder){this._alphaDecoderFactory||(this._alphaDecoderFactory=X.create(q._nextDecoderId++));const e=await this._alphaDecoderFactory;e.onPicture=((e,t,i)=>{this._onAlphaPictureDecoded(e,t,i)}),this._alphaDecoder=e}!e&&this._alphaDecoder&&(this._alphaDecoder.release(),this._alphaDecoder=null,this._alphaDecoderFactory=null)}async _decodeH264(e){if(!L.fullFrame(e.encodingOptions))throw new Error("h264 encoded buffers must contain the full frame.");const t=L.splitAlpha(e.encodingOptions);if(await this._ensureH264Decoders(t),t){this._decodingAlphaSerialsQueue.push(e.serial);const t=new Uint8Array(e.pixelContent[0].alpha.slice());this._alphaDecoder.decode(t)}else this._frameStates[e.serial].state="pending_opaque";this._decodingSerialsQueue.push(e.serial);const i=new Uint8Array(e.pixelContent[0].opaque);this._decoder.decode(i)}_onComplete(e){e.state="complete",delete this._frameStates[e.serial],e.resolve(e.result)}_onPictureDecoded(e,t,i){const n=this._decodingSerialsQueue.shift(),s=this._frameStates[n];s.result.opaque={buffer:e,width:t,height:i},"pending_opaque"===s.state?this._onComplete(s):s.state="pending_alpha"}_onAlphaPictureDecoded(e,t,i){const n=this._decodingAlphaSerialsQueue.shift(),s=this._frameStates[n];s.result.alpha={buffer:e,width:t,height:i},"pending_alpha"===s.state?this._onComplete(s):this._frameStates[n].state="pending_opaque"}destroy(){this._decoder&&(this._decoder.release(),this._decoderFactory=null,this._decoder=null),this._alphaDecoder&&(this._alphaDecoder.release(),this._alphaDecoderFactory=null,this._alphaDecoder=null)}}q._nextDecoderId=0;class H extends P{static create(e){const t=q.create();return new H(e,t)}constructor(e,t){super(),this.gl=e,this.yTexture=k.create(this.gl,this.gl.LUMINANCE),this.uTexture=k.create(this.gl,this.gl.LUMINANCE),this.vTexture=k.create(this.gl,this.gl.LUMINANCE),this.alphaTexture=k.create(this.gl,this.gl.LUMINANCE),this.size=E.a.create(0,0),this._h264BufferContentDecoder=t}async update(e){const{alpha:t,opaque:i}=await this._h264BufferContentDecoder.decode(e),n=i.buffer,s=i.width,r=s*i.height,o=r>>2,a=n.subarray(0,r),c=n.subarray(r,r+o),l=n.subarray(r+o,r+2*o),u=e.size.equals(this.size),h=e.size.w>>1,f=e.size.h>>1,d=s>>1;if(u?(this.yTexture.subImage2dBuffer(a,S.a.create(0,0,e.size.w,e.size.h),s),this.uTexture.subImage2dBuffer(c,S.a.create(0,0,h,f),d),this.vTexture.subImage2dBuffer(l,S.a.create(0,0,h,f),d)):(this.yTexture.image2dBuffer(a,e.size.w,e.size.h,s),this.uTexture.image2dBuffer(c,h,f,d),this.vTexture.image2dBuffer(l,h,f,d)),t){const i=t.width,n=i*t.height,s=t.buffer.subarray(0,n);u?this.alphaTexture.subImage2dBuffer(s,S.a.create(0,0,e.size.w,e.size.h),i):this.alphaTexture.image2dBuffer(s,e.size.w,e.size.h,i)}}destroy(){this.yTexture.delete(),this.uTexture.delete(),this.vTexture.delete(),this.alphaTexture.delete(),this._h264BufferContentDecoder.destroy()}}class ${static create(e){const t=this._initShaders(e),i=this._initShaderArgs(e,t),n=this._initBuffers(e);return new $(e,n,i,t)}static _initShaders(e){const t=new F(e);return t.attach(z.compile(e,U)),t.attach(z.compile(e,G)),t.link(),t.use(),t}static _initShaderArgs(e,t){const i={};return i.yTexture=t.getUniformLocation("yTexture"),i.uTexture=t.getUniformLocation("uTexture"),i.vTexture=t.getUniformLocation("vTexture"),i.alphaYTexture=t.getUniformLocation("alphaYTexture"),i.u_projection=t.getUniformLocation("u_projection"),i.a_position=t.getAttributeLocation("a_position"),e.enableVertexAttribArray(i.a_position),i.a_texCoord=t.getAttributeLocation("a_texCoord"),e.enableVertexAttribArray(i.a_texCoord),i}static _initBuffers(e){return e.createBuffer()}constructor(e,t,i,n){this.gl=e,this.vertexBuffer=t,this.shaderArgs=i,this.program=n}setTexture(e,t,i,n){const s=this.gl;s.uniform1i(this.shaderArgs.yTexture,0),s.uniform1i(this.shaderArgs.uTexture,1),s.uniform1i(this.shaderArgs.vTexture,2),s.uniform1i(this.shaderArgs.alphaYTexture,3),s.activeTexture(s.TEXTURE0),s.bindTexture(s.TEXTURE_2D,e.texture),s.activeTexture(s.TEXTURE1),s.bindTexture(s.TEXTURE_2D,t.texture),s.activeTexture(s.TEXTURE2),s.bindTexture(s.TEXTURE_2D,i.texture),s.activeTexture(s.TEXTURE3),s.bindTexture(s.TEXTURE_2D,n.texture)}use(){this.program.use()}release(){this.gl.useProgram(null)}updatePerspective(e){const t=this.gl,{w:i,h:n}=e;t.viewport(0,0,i,n),this.program.setUniformM4(this.shaderArgs.u_projection,[2/i,0,0,0,0,2/-n,0,0,0,0,1,0,-1,1,0,1]),t.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(this.gl.ARRAY_BUFFER,new Float32Array([0,0,0,0,i,0,1,0,i,n,1,1,i,n,1,1,0,n,0,1,0,0,0,0]),this.gl.DYNAMIC_DRAW),t.vertexAttribPointer(this.shaderArgs.a_position,2,t.FLOAT,!1,16,0),t.vertexAttribPointer(this.shaderArgs.a_texCoord,2,t.FLOAT,!1,16,8)}draw(){const e=this.gl;e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT|e.STENCIL_BUFFER_BIT),e.drawArrays(this.gl.TRIANGLE_STRIP,0,6),e.bindTexture(e.TEXTURE_2D,null)}}class Y{static create(e){const t=this._initShaders(e),i=this._initShaderArgs(e,t),n=this._initBuffers(e);return new Y(e,n,i,t)}static _initShaders(e){const t=new F(e);return t.attach(z.compile(e,U)),t.attach(z.compile(e,W)),t.link(),t.use(),t}static _initShaderArgs(e,t){const i={};return i.yTexture=t.getUniformLocation("yTexture"),i.uTexture=t.getUniformLocation("uTexture"),i.vTexture=t.getUniformLocation("vTexture"),i.u_projection=t.getUniformLocation("u_projection"),i.a_position=t.getAttributeLocation("a_position"),e.enableVertexAttribArray(i.a_position),i.a_texCoord=t.getAttributeLocation("a_texCoord"),e.enableVertexAttribArray(i.a_texCoord),i}static _initBuffers(e){return e.createBuffer()}constructor(e,t,i,n){this.gl=e,this.vertexBuffer=t,this.shaderArgs=i,this.program=n}setTexture(e,t,i){const n=this.gl;n.uniform1i(this.shaderArgs.yTexture,0),n.uniform1i(this.shaderArgs.uTexture,1),n.uniform1i(this.shaderArgs.vTexture,2),n.activeTexture(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,e.texture),n.activeTexture(n.TEXTURE1),n.bindTexture(n.TEXTURE_2D,t.texture),n.activeTexture(n.TEXTURE2),n.bindTexture(n.TEXTURE_2D,i.texture)}use(){this.program.use()}release(){this.gl.useProgram(null)}updatePerspective(e){const t=this.gl,{w:i,h:n}=e;t.viewport(0,0,i,n),this.program.setUniformM4(this.shaderArgs.u_projection,[2/i,0,0,0,0,2/-n,0,0,0,0,1,0,-1,1,0,1]),t.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(this.gl.ARRAY_BUFFER,new Float32Array([0,0,0,0,i,0,1,0,i,n,1,1,i,n,1,1,0,n,0,1,0,0,0,0]),this.gl.DYNAMIC_DRAW),t.vertexAttribPointer(this.shaderArgs.a_position,2,t.FLOAT,!1,16,0),t.vertexAttribPointer(this.shaderArgs.a_texCoord,2,t.FLOAT,!1,16,8)}draw(){const e=this.gl;e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT|e.STENCIL_BUFFER_BIT),e.drawArrays(this.gl.TRIANGLE_STRIP,0,6),e.bindTexture(e.TEXTURE_2D,null)}}class Z{static create(){const e=document.createElement("canvas"),t=e.getContext("webgl2",{antialias:!1,depth:!1,alpha:!0,preserveDrawingBuffer:!1});if(!t)throw new Error("This browser doesn't support WebGL2!");t.clearColor(0,0,0,0);const i=V.create(t),n=K.create(t),s=$.create(t),r=Y.create(t);return new Z(t,i,n,s,r,e)}static createRenderFrame(){let e=null;const t=new Promise(t=>{e=t});return t._animationResolve=e,t.fire=(()=>{window.requestAnimationFrame(e=>{t._animationResolve(e)})}),t}constructor(e,t,i,n,s,r){this._gl=e,this._jpegAlphaSurfaceShader=t,this._jpegSurfaceShader=i,this._yuvaSurfaceShader=n,this._yuvSurfaceShader=s,this._canvas=r,this._emptyImage=new window.Image(0,0),this._emptyImage.src="//:0"}async render(e,t){const i=e.views,n=t.bufferContents;n?await this._draw(n,e,i):i.forEach(e=>{e.draw(this._emptyImage)})}async"image/jpeg"(e,t,i){let n=t.renderState;n instanceof B||(n&&n.destroy(),n=B.create(this._gl),t.renderState=n);const s=n,{w:r,h:o}=e.size;if(await s.update(e),L.splitAlpha(e.encodingOptions)){this._jpegAlphaSurfaceShader.use(),this._jpegAlphaSurfaceShader.setTexture(s.opaqueTexture,s.alphaTexture);const t=this._canvas.width!==r||this._canvas.height!==o;t&&(this._canvas.width=r,this._canvas.height=o,this._jpegAlphaSurfaceShader.updatePerspective(e.size)),this._jpegAlphaSurfaceShader.draw(e.size,t),this._jpegAlphaSurfaceShader.release();const n=await window.createImageBitmap(this._canvas);i.forEach(e=>{e.draw(n)})}else{this._jpegSurfaceShader.use(),this._jpegSurfaceShader.setTexture(s.opaqueTexture);const t=this._canvas.width!==r||this._canvas.height!==o;t&&(this._canvas.width=r,this._canvas.height=o,this._jpegSurfaceShader.updatePerspective(e.size)),this._jpegSurfaceShader.draw(e.size,t),this._jpegSurfaceShader.release(),i.forEach(e=>{e.draw(this._canvas)})}}async"image/png"(e,t,i){const n=L.fullFrame(e.encodingOptions),s=L.splitAlpha(e.encodingOptions);if(!n||s)throw new Error(`Unsupported buffer. Encoding type: ${e.mimeType}, full frame:${n}, split alpha: ${s}`);{const t=e.pixelContent[0],n=new Blob([t.opaque],{type:"image/png"}),s=await createImageBitmap(n,0,0,t.geo.width,t.geo.height);i.forEach(e=>e.draw(s))}}async"video/h264"(e,t,i){let n=t.renderState;n instanceof H||(n&&n.destroy(),n=H.create(this._gl),t.renderState=n);const s=n,{w:r,h:o}=e.size;if(await s.update(e),L.splitAlpha(e.encodingOptions)){this._yuvaSurfaceShader.use(),this._yuvaSurfaceShader.setTexture(s.yTexture,s.uTexture,s.vTexture,s.alphaTexture);const t=this._canvas.width!==r||this._canvas.height!==o;t&&(this._canvas.width=r,this._canvas.height=o,this._yuvaSurfaceShader.updatePerspective(e.size)),this._yuvaSurfaceShader.draw(e.size,t),this._yuvaSurfaceShader.release();const n=await createImageBitmap(this._canvas);i.forEach(e=>e.draw(n))}else{this._yuvSurfaceShader.use(),this._yuvSurfaceShader.setTexture(s.yTexture,s.uTexture,s.vTexture);const t=this._canvas.width!==r||this._canvas.height!==o;t&&(this._canvas.width=r,this._canvas.height=o,this._yuvSurfaceShader.updatePerspective(e.size)),this._yuvSurfaceShader.draw(e.size,t),this._yuvSurfaceShader.release(),i.forEach(e=>e.draw(this._canvas))}}"image/rgba"(e,t,i){i.forEach(t=>t.draw(e.pixelContent))}"image/bitmap"(e,t,i){const n=e.pixelContent;i.forEach(e=>e.draw(n)),n.close()}async _draw(e,t,i){await this[e.mimeType](e,t,i)}}Z._animationPromise=null,Z._animationResolve=null;class Q{static create(e,t,i){const n=R.create(t,i),s=new Q(n,e,T.IDENTITY());return n.view=s,s.updateInputRegion(),s}static _nextTopZIndex(){return this._topZIndex++,this._topZIndex}constructor(e,t,i){this.bufferedCanvas=e,this.surface=t,this.customTransformation=null,this.userTransformations=new Map,this._transformation=i,this._backBufferTransformation=i,this._inverseTransformation=i.invert(),this._destroyPromise=new Promise(e=>{this._destroyResolve=e}),this.destroyed=!1,this._parent=null,this._primary=!1}set parent(e){if(!this.destroyed&&(this._parent=e,this._parent)){this.primary=e.primary,e.onDestroy().then(()=>{this.parent===e&&(this.destroy(),this.parent=null)});const t=Z.createRenderFrame();this.applyTransformations(t),t.fire(),this._parent.isAttached()?this.attachTo(this._parent.parentElement()):this.detach()}}set primary(e){this.destroyed||(this._primary=e)}get primary(){return!!this._primary||!!this.parent&&this.parent.primary}get parent(){return this._parent}set transformation(e){this.destroyed||(this._transformation=e,this._inverseTransformation=e.invert())}get transformation(){return this._transformation}applyTransformations(e){if(this.destroyed)return;const t=this._calculateTransformation();this.transformation=t;const i=t.timesMat4(this.surface.inverseBufferTransformation).toCssMatrix();e.then(()=>{this.bufferedCanvas.setElementTransformation(i)}),this._applyTransformationsChild(e)}_applyTransformationsChild(e){this.surface.children.forEach(t=>{t.surface!==this.surface&&t.surface.views.filter(e=>e.parent===this).forEach(t=>{t.applyTransformations(e)})})}_applyTransformationsBackBuffer(){const e=this._calculateTransformation();this._backBufferTransformation=e;const t=e.timesMat4(this.surface.inverseBufferTransformation).toCssMatrix();this.bufferedCanvas.setBackBufferElementTransformation(t)}_calculateTransformation(){if(this.customTransformation)return this.customTransformation;let e=T.IDENTITY();this._parent&&(e=this._parent.transformation);const t=this.surface.surfaceChildSelf,{x:i,y:n}=t.position,s=T.translation(i,n);return e.timesMat4(s)}withUserTransformations(e){let t=e;return this.userTransformations.forEach(i=>t=e.timesMat4(i)),t}raise(){this.destroyed||(this.zIndex=Q._nextTopZIndex(),this.surface.updateChildViewsZIndexes())}set zIndex(e){this.destroyed||(e>=Q._topZIndex&&(Q._topZIndex=e),this.bufferedCanvas.zIndex=e)}get zIndex(){return window.parseInt(this.bufferedCanvas.frontContext.canvas.style.zIndex,10)}draw(e){this.destroyed||(this._applyTransformationsBackBuffer(),this.bufferedCanvas.drawBackBuffer(e))}swapBuffers(e){this.destroyed||(this.transformation=this._backBufferTransformation,e.then(()=>{this.destroyed||this.bufferedCanvas.swapBuffers()}),this._applyTransformationsChild(e))}toBrowserSpace(e){return this.transformation.timesPoint(e)}toViewSpaceFromBrowser(e){return this._inverseTransformation.timesPoint(e)}toViewSpaceFromSurface(e){const t=this.bufferedCanvas.frontContext.canvas.getBoundingClientRect(),i=Math.round(t.width),n=Math.round(t.height),s=this.surface.size,r=s.w,o=s.h;return r===i&&o===n?e:T.scalarVector(v.a.create2D(i/r,n/o)).timesPoint(e)}toSurfaceSpace(e){const t=this.toViewSpaceFromBrowser(e),i=this.bufferedCanvas.frontContext.canvas.getBoundingClientRect(),n=Math.round(i.width),s=Math.round(i.height),r=this.surface.size,o=r.w,a=r.h;return o===n&&a===s?t:T.scalarVector(v.a.create2D(o/n,a/s)).timesPoint(t)}show(){this.destroyed||(this.bufferedCanvas.containerDiv.style.display="contents")}hide(){this.destroyed||(this.bufferedCanvas.containerDiv.style.display="none")}destroy(){this.destroyed=!0,this._destroyResolve()}onDestroy(){return this._destroyPromise}isAttached(){return this.bufferedCanvas.isAttachedToElement()}attachTo(e){this.destroyed||(this.bufferedCanvas.attachToElement(e),this.surface.children.forEach(t=>{t.surface.views.filter(e=>e.parent===this).forEach(t=>{t.attachTo(e)})}))}parentElement(){return this.bufferedCanvas.frontContext.canvas.parentElement}detach(){this.bufferedCanvas.detachFromElement()}updateInputRegion(){if(this.destroyed)return;const e=this.surface.state.inputPixmanRegion,t=this.surface.pixmanRegion,i=M.createPixmanRegion();M.intersect(i,e,t);const n=M.rectangles(i);this.bufferedCanvas.updateInputRegionElements(n),M.destroyPixmanRegion(i)}}Q._topZIndex=20;class J{static create(e){return new J(e)}constructor(e){this.resource=e}done(e){this.resource&&(this.resource.done(e),this.resource.destroy(),this.resource=null)}}const ee=T.IDENTITY(),te=T.create(0,-1,0,0,1,0,0,0,0,0,1,0,0,0,0,1),ie=T.create(-1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1),ne=T.create(0,1,0,0,-1,0,0,0,0,0,1,0,0,0,0,1),se=T.create(-1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),re=T.create(0,-1,0,0,-1,0,0,0,0,0,1,0,0,0,0,1),oe=T.create(1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1),ae=T.create(0,1,0,0,1,0,0,0,0,0,1,0,0,0,0,1);class ce{static create(e){return new ce(e)}constructor(e){this.surface=e,this._position=x.a.create(0,0)}set position(e){this._position=e}get position(){return this._position}}class le{static create(e,t,i,n,s,r,o,a,c,l,u){return new le(e,t,i,n,s,r,o,a,c,l,u)}constructor(e,t,i,n,s,r,o,a,c,l,u){this.wlBuffer=e,this.bufferContents=t,this.bufferDamageRects=i,this.opaquePixmanRegion=n,this.inputPixmanRegion=s,this.dx=r,this.dy=o,this.bufferTransform=a,this.bufferScale=c,this.frameCallbacks=l,this.roleState=u}}const ue=[{transformation:ee,inverseTransformation:ee.invert()},{transformation:te,inverseTransformation:te.invert()},{transformation:ie,inverseTransformation:ie.invert()},{transformation:ne,inverseTransformation:ne.invert()},{transformation:se,inverseTransformation:se.invert()},{transformation:re,inverseTransformation:re.invert()},{transformation:oe,inverseTransformation:oe.invert()},{transformation:ae,inverseTransformation:ae.invert()}];class he extends _.a{static create(e,t,i,n){const s=M.createPixmanRegion(),r=M.createPixmanRegion(),o=M.createPixmanRegion();M.initInfinite(s),M.initInfinite(r),M.initRect(o,S.a.create(0,0,0,0));const a=new he(e,t,i,n,s,r,o);return e.implementation=a,e.onDestroy().then(()=>{M.destroyPixmanRegion(s),M.destroyPixmanRegion(r),M.destroyPixmanRegion(o),a.pixmanRegion=0,a.state.opaquePixmanRegion=0,a.state.inputPixmanRegion=0,a._handleDestruction()}),a}constructor(e,t,i,n,s,r,o){super(),this.resource=e,this.destroyed=!1,this.renderer=t,this.renderState=null,this.state=le.create(null,null,[],s,r,0,0,0,1,[],{}),this.pendingWlBuffer=null,this.pendingBufferDestroyListener=(()=>{this.pendingWlBuffer=null}),this._pendingDamageRects=[],this._pendingBufferDamageRects=[],this._pendingOpaqueRegion=s,this._pendingInputRegion=r,this._pendingDx=0,this._pendingDy=0,this._pendingBufferTransform=0,this._pendingBufferScale=1,this.views=[],this.seat=i,this.session=n,this.hasKeyboardInput=!0,this.hasPointerInput=!0,this.hasTouchInput=!0,this.role=null,this.surfaceChildSelf=ce.create(this),this._surfaceChildren=[],this.subsurfaceChildren=[this.surfaceChildSelf],this.pendingSubsurfaceChildren=[this.surfaceChildSelf],this._pendingFrameCallbacks=[],this.inverseBufferTransformation=T.IDENTITY(),this.bufferTransformation=T.IDENTITY(),this.pixmanRegion=o,this.size=E.a.create(0,0)}get children(){return this.subsurfaceChildren.concat(this._surfaceChildren)}isWithinInputRegion(e){const t=M.contains(this.state.inputPixmanRegion,e);return M.contains(this.pixmanRegion,e)&&t}_applyBufferTransformWithPositionCorrection(e,t){switch(e){case 3:case 4:this.bufferTransformation=t.timesMat4(T.translation(this.size.w,0).invert()),this.inverseBufferTransformation=this.bufferTransformation.invert();break;case 2:case 5:this.bufferTransformation=t.timesMat4(T.translation(this.size.w,this.size.h).invert()),this.inverseBufferTransformation=this.bufferTransformation.invert();break;case 1:case 6:this.bufferTransformation=t.timesMat4(T.translation(0,this.size.h).invert()),this.inverseBufferTransformation=this.bufferTransformation.invert();break;case 0:case 7:this.bufferTransformation=t.timesMat4(T.translation(0,0)),this.inverseBufferTransformation=this.bufferTransformation.invert()}}_updateDerivedState(e){const t=this.state.bufferContents?this.state.bufferContents.size:E.a.create(0,0),i=e.bufferContents?e.bufferContents.size:E.a.create(0,0);if(e.bufferScale!==this.state.bufferScale||e.bufferTransform!==this.state.bufferTransform||t.w!==i.w||t.h!==i.h){const t=ue[e.bufferTransform],n=1===e.bufferScale?t.transformation:t.transformation.timesMat4(T.scalar(e.bufferScale)),s=(1===e.bufferScale?t.inverseTransformation:n.invert()).timesPoint(x.a.create(i.w,i.h));this.size=E.a.create(Math.abs(s.x),Math.abs(s.y)),M.fini(this.pixmanRegion),M.initRect(this.pixmanRegion,S.a.create(0,0,this.size.w,this.size.h)),this._applyBufferTransformWithPositionCorrection(e.bufferTransform,n)}}updateChildViewsZIndexes(){let e=this.children.indexOf(this.surfaceChildSelf);this.views.forEach(t=>{const i=t.zIndex-e;this._updateZIndex(t,i)})}_updateZIndex(e,t){let i=0,n=t;return this.children.forEach((t,s)=>{if(i=n+s,t.surface===this)e.zIndex=i;else{const s=t.surface.views.find(t=>t.parent===e);s&&(n=t.surface._updateZIndex(s,i))}}),i}onViewCreated(e){}createView(){const e=this.state.bufferContents?this.state.bufferContents.size:E.a.create(0,0),t=Q.create(this,e.w,e.h);return 0===this.views.length&&(t.primary=!0),this.views.push(t),t.onDestroy().then(()=>{const e=this.views.indexOf(t);e>-1&&this.views.splice(e,1)}),this.children.forEach(e=>{this._ensureChildView(e,t)}),this.updateChildViewsZIndexes(),this.onViewCreated(t),t}_ensureChildView(e,t){if(e.surface===this)return null;const i=e.surface.createView(),n=this.children.indexOf(e);return i.zIndex=t.zIndex+n,i.parent=t,i}addSubsurface(e){const t=this._addChild(e,this.subsurfaceChildren);return this.pendingSubsurfaceChildren.push(e),e.surface.resource.onDestroy().then(()=>{this.removeSubsurface(e)}),t}removeSubsurface(e){this._removeChild(e,this.subsurfaceChildren),this._removeChild(e,this.pendingSubsurfaceChildren)}addChild(e){return this._addChild(e,this._surfaceChildren)}addToplevelChild(e){this._surfaceChildren.push(e);const t=e.surface.views.find(e=>e.primary),i=this.views.find(e=>e.primary),n=this.children.indexOf(e);t.zIndex=i.zIndex+n,t.parent=i,e.surface.resource.onDestroy().then(()=>{this.removeChild(e)}),this.updateChildViewsZIndexes()}removeChild(e){this._removeChild(e,this._surfaceChildren)}_addChild(e,t){t.push(e);const i=[];return this.views.forEach(t=>{const n=this._ensureChildView(e,t);n&&i.push(n)}),e.surface.resource.onDestroy().then(()=>{this.removeChild(e)}),this.updateChildViewsZIndexes(),i}_removeChild(e,t){const i=t.indexOf(e);i>-1&&(t.splice(i,1),this.updateChildViewsZIndexes())}destroy(e){this.destroyed=!0,e.destroy(),this.renderState&&(this.renderState.destroy(),this.renderState=null)}_handleDestruction(){this.views.forEach(e=>{delete e.surface,e.destroy()})}attach(e,t,i,n){this._pendingDx=i,this._pendingDy=n,this.pendingWlBuffer&&this.pendingWlBuffer.removeDestroyListener(this.pendingBufferDestroyListener),this.pendingWlBuffer=t,this.pendingWlBuffer&&this.pendingWlBuffer.addDestroyListener(this.pendingBufferDestroyListener)}damage(e,t,i,n,s){this._pendingDamageRects.push(S.a.create(t,i,t+n,i+s))}frame(e,t){this._pendingFrameCallbacks.push(J.create(new y.a(e.client,t,1)))}setOpaqueRegion(e,t){if(this._pendingOpaqueRegion=M.createPixmanRegion(),t){const e=t.implementation;M.copyTo(this._pendingOpaqueRegion,e.pixmanRegion)}else M.initInfinite(this._pendingOpaqueRegion)}setInputRegion(e,t){if(this._pendingInputRegion=M.createPixmanRegion(),t){const e=t.implementation;M.copyTo(this._pendingInputRegion,e.pixmanRegion)}else M.initInfinite(this._pendingInputRegion)}toSurfaceSpace(e){return this.inverseBufferTransformation.timesPoint(e)}async commit(e,t){this.state.wlBuffer&&this.state.wlBuffer.implementation.release();let i=null;if(this.pendingWlBuffer){this.pendingWlBuffer.removeDestroyListener(this.pendingBufferDestroyListener);const e=this.pendingWlBuffer.implementation;i=await e.getContents(t)}if(this.destroyed)return;const n=this._captureState(e,i);if(n&&this.role&&"function"==typeof this.role.onCommit){const e=Z.createRenderFrame();await this.role.onCommit(this,e,n),n.inputPixmanRegion&&M.destroyPixmanRegion(n.inputPixmanRegion),n.opaquePixmanRegion&&M.destroyPixmanRegion(n.opaquePixmanRegion)}}async render(e,t,i){null==i&&(i=!1),e.then(e=>{this.state.frameCallbacks.forEach(t=>t.done(2147483647&e)),this.state.frameCallbacks=[]}),this.subsurfaceChildren.length>1&&(this.subsurfaceChildren=this.pendingSubsurfaceChildren.slice(),this.updateChildViewsZIndexes(),this.subsurfaceChildren.forEach(t=>{const i=t.surface;if(i!==this){const n=i.role;n.pendingPosition&&(t.position=n.pendingPosition,n.pendingPosition=null),n.onParentCommit(this,e)}})),i||await this.renderer.render(this,t);const{w:n,h:s}=this.size;this._updateDerivedState(t),he.mergeState(this.state,t),this.role&&this.role.setRoleState&&this.role.setRoleState(t.roleState),n===this.size.w&&s===this.size.h||this.views.forEach(e=>e.updateInputRegion()),this.views.forEach(t=>t.swapBuffers(e))}static mergeState(e,t){e.wlBuffer=t.wlBuffer,e.dx=t.dx,e.dy=t.dy,t.inputPixmanRegion&&M.copyTo(e.inputPixmanRegion,t.inputPixmanRegion),t.opaquePixmanRegion&&M.copyTo(e.opaquePixmanRegion,t.opaquePixmanRegion),e.bufferDamageRects=t.bufferDamageRects.slice(),e.bufferTransform=t.bufferTransform,e.bufferScale=t.bufferScale,e.bufferContents=t.bufferContents,e.frameCallbacks=e.frameCallbacks.concat(t.frameCallbacks)}_captureState(e,t){if(this._pendingBufferScale<1)return e.postError(f.a.Error.invalidScale,"Buffer scale value is invalid."),null;if(!Object.values(b.a.Transform).includes(this._pendingBufferTransform))return e.postError(f.a.Error.invalidTransform,"Buffer transform value is invalid."),null;const i=le.create(this.pendingWlBuffer,t,this._pendingDamageRects.map(e=>this.bufferTransformation.timesRect(e)).concat(this._pendingBufferDamageRects),this._pendingOpaqueRegion,this._pendingInputRegion,this._pendingDx,this._pendingDy,this._pendingBufferTransform,this._pendingBufferScale,this._pendingFrameCallbacks,{});return this._pendingFrameCallbacks=[],this._pendingInputRegion=0,this._pendingOpaqueRegion=0,this._pendingDamageRects=[],this._pendingBufferDamageRects=[],this.role&&this.role.captureRoleState&&(i.roleState=this.role.captureRoleState()),i}setBufferTransform(e,t){this._pendingBufferTransform=t}setBufferScale(e,t){this._pendingBufferScale=t}damageBuffer(e,t,i,n,s){this._pendingBufferDamageRects.push(S.a.create(t,i,t+n,i+s))}}class fe extends c.a{static create(e,t){const i=Z.create();return new fe(e,i,t)}constructor(e,t,i){super(),this._session=e,this._renderer=t,this._seat=i,this._global=null}registerGlobal(e){this._global||(this._global=e.createGlobal(this,u.a.protocolName,4,(e,t,i)=>{this.bindClient(e,t,i)}))}unregisterGlobal(){this._global&&(this._global.destroy(),this._global=null)}bindClient(e,t,i){new u.a(e,t,i).implementation=this}createSurface(e,t){const i=new f.a(e.client,t,e.version);he.create(i,this._renderer,this._seat,this._session)}createRegion(e,t){const i=new p.a(e.client,t,e.version);M.create(i)}}var de=function(e){const t=null,i=null;(e=void 0!==(e=e||{})?e:{}).ENVIRONMENT="WEB";let n,s={};for(n in e)e.hasOwnProperty(n)&&(s[n]=e[n]);e.arguments=[],e.thisProgram="./this.program",e.quit=function(e,t){throw t},e.preRun=[],e.postRun=[];let r=!1,o=!1;if(e.ENVIRONMENT)if("WEB"===e.ENVIRONMENT)r=!0;else{if("WORKER"!==e.ENVIRONMENT)throw new Error("Module['ENVIRONMENT'] value is not valid. must be one of: WEB|WORKER|NODE|SHELL.");o=!0}else r="object"==typeof window,o="function"==typeof importScripts;for(n in(r||o)&&(e.read=function(e){const t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},o&&(e.readBinary=function(e){const t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),e.readAsync=function(e,t,i){const n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="arraybuffer",n.onload=function(){200==n.status||0==n.status&&n.response?t(n.response):i()},n.onerror=i,n.send(null)},void 0!==arguments&&(e.arguments=arguments),e.setWindowTitle=function(e){document.title=e}),e.print=console.log.bind(console),e.printErr=console.warn.bind(console)||e.print,e.print=e.print,e.printErr=e.printErr,s)s.hasOwnProperty(n)&&(e[n]=s[n]);s=void 0;const a=16;function c(e){f(!C);const t=R;return R=R+e+15&-16,t}function l(e,t){return t||(t=a),e=Math.ceil(e/t)*t}new Array(0);let u=0,h=0;function f(e,t){e||ce("Assertion failed: "+t)}function d(e,t){if(0===t||!e)return"";let i,n=0,s=0;for(;n|=i=S[e+s>>0],(0!=i||t)&&(s++,!t||s!=t););t||(t=s);let r="";if(n<128){const i=1024;let n;for(;t>0;)n=String.fromCharCode.apply(String,S.subarray(e,e+Math.min(t,i))),r=r?r+n:n,e+=i,t-=i;return r}return function(e){return m(S,e)}(e)}const p="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function m(e,t){let i=t;for(;e[i];)++i;if(i-t>16&&e.subarray&&p)return p.decode(e.subarray(t,i));{let i,n,s,r,o,a,c="";for(;;){if(!(i=e[t++]))return c;if(128&i)if(n=63&e[t++],192!=(224&i))if(s=63&e[t++],224==(240&i)?i=(15&i)<<12|n<<6|s:(r=63&e[t++],240==(248&i)?i=(7&i)<<18|n<<12|s<<6|r:(o=63&e[t++],i=248==(252&i)?(3&i)<<24|n<<18|s<<12|r<<6|o:(1&i)<<30|n<<24|s<<18|r<<12|o<<6|(a=63&e[t++]))),i<65536)c+=String.fromCharCode(i);else{const e=i-65536;c+=String.fromCharCode(55296|e>>10,56320|1023&e)}else c+=String.fromCharCode((31&i)<<6|n);else c+=String.fromCharCode(i)}}}function _(e,t,i,n){if(!(n>0))return 0;const s=i,r=i+n-1;for(let n=0;n<e.length;++n){let s=e.charCodeAt(n);if(s>=55296&&s<=57343&&(s=65536+((1023&s)<<10)|1023&e.charCodeAt(++n)),s<=127){if(i>=r)break;t[i++]=s}else if(s<=2047){if(i+1>=r)break;t[i++]=192|s>>6,t[i++]=128|63&s}else if(s<=65535){if(i+2>=r)break;t[i++]=224|s>>12,t[i++]=128|s>>6&63,t[i++]=128|63&s}else if(s<=2097151){if(i+3>=r)break;t[i++]=240|s>>18,t[i++]=128|s>>12&63,t[i++]=128|s>>6&63,t[i++]=128|63&s}else if(s<=67108863){if(i+4>=r)break;t[i++]=248|s>>24,t[i++]=128|s>>18&63,t[i++]=128|s>>12&63,t[i++]=128|s>>6&63,t[i++]=128|63&s}else{if(i+5>=r)break;t[i++]=252|s>>30,t[i++]=128|s>>24&63,t[i++]=128|s>>18&63,t[i++]=128|s>>12&63,t[i++]=128|s>>6&63,t[i++]=128|63&s}}return t[i]=0,i-s}function g(e){let t=0;for(let i=0;i<e.length;++i){let n=e.charCodeAt(i);n>=55296&&n<=57343&&(n=65536+((1023&n)<<10)|1023&e.charCodeAt(++i)),n<=127?++t:t+=n<=2047?2:n<=65535?3:n<=2097151?4:n<=67108863?5:6}return t}"undefined"!=typeof TextDecoder&&new TextDecoder("utf-16le");const y=16384,w=65536,b=16777216;var v,x,S,T,E,R,C;function A(){e.HEAP8=x=new Int8Array(v),e.HEAP16=T=new Int16Array(v),e.HEAP32=E=new Int32Array(v),e.HEAPU8=S=new Uint8Array(v),e.HEAPU16=new Uint16Array(v),e.HEAPU32=new Uint32Array(v),e.HEAPF32=new Float32Array(v),e.HEAPF64=new Float64Array(v)}let D,O,M,k,P;function I(){ce("Cannot enlarge memory arrays. Either (1) compile with  -s TOTAL_MEMORY=X  with X higher than the current value "+B+", (2) compile with  -s ALLOW_MEMORY_GROWTH=1  which allows increasing the size at runtime, or (3) if you want malloc to return NULL (0) instead of this abort, compile with  -s ABORTING_MALLOC=0 ")}R=D=O=M=k=P=0,C=!1;const L=e.TOTAL_STACK||5242880;var B=e.TOTAL_MEMORY||16777216;if(B<L&&e.printErr("TOTAL_MEMORY should be larger than TOTAL_STACK, was "+B+"! (TOTAL_STACK="+L+")"),e.buffer?v=e.buffer:("object"==typeof window.WebAssembly&&"function"==typeof window.WebAssembly.Memory?(e.wasmMemory=new window.WebAssembly.Memory({initial:B/w,maximum:B/w}),v=e.wasmMemory.buffer):v=new ArrayBuffer(B),e.buffer=v),A(),E[0]=1668509029,T[1]=25459,115!==S[2]||99!==S[3])throw"Runtime error: expected the system to be little-endian!";function F(t){for(;t.length>0;){let i=t.shift();if("function"==typeof i){i();continue}let n=i.func;"number"==typeof n?void 0===i.arg?e.dynCall_v(n):e.dynCall_vi(n,i.arg):n(void 0===i.arg?null:i.arg)}}const z=[],U=[],N=[],j=[],G=[];let W=!1,V=!1;function K(e,t,i){for(let i=0;i<e.length;++i)x[t++>>0]=e.charCodeAt(i);i||(x[t>>0]=0)}Math.abs,Math.cos,Math.sin,Math.tan,Math.acos,Math.asin,Math.atan,Math.atan2,Math.exp,Math.log,Math.sqrt,Math.ceil,Math.floor,Math.pow,Math.imul,Math.fround,Math.round,Math.min,Math.max,Math.clz32,Math.trunc;let X=0,q=null,H=null;e.preloadedImages={},e.preloadedAudios={};const $="data:application/octet-stream;base64,";function Y(e){return String.prototype.startsWith?e.startsWith($):0===e.indexOf($)}!function(){let t="libxkbcommon.wast",i="libxkbcommon.wasm",n="libxkbcommon.temp.asm.js";"function"==typeof e.locateFile&&(Y(t)||(t=e.locateFile(t)),Y(i)||(i=e.locateFile(i)),Y(n)||(n=e.locateFile(n)));const s={global:null,env:null,asm2wasm:{"f64-rem":function(e,t){return e%t},debugger:function(){}},parent:e};let a=null;function c(t){const i=e.buffer;t.byteLength<i.byteLength&&e.printErr("the new buffer in mergeMemory is smaller than the previous one. in native wasm, we should grow memory here");const n=new Int8Array(i);var s;new Int8Array(t).set(n),s=t,e.buffer=v=s,A()}function l(){try{if(e.wasmBinary)return new Uint8Array(e.wasmBinary);if(e.readBinary)return e.readBinary(i);throw"on the web, we need the wasm binary to be preloaded and set on Module['wasmBinary']. emcc.py will do that for you when generating HTML (but not JS)"}catch(e){ce(e)}}function u(t,n,u){if("object"!=typeof window.WebAssembly)return e.printErr("no native wasm support detected"),!1;if(!(e.wasmMemory instanceof window.WebAssembly.Memory))return e.printErr("no native wasm Memory in use"),!1;function h(t,i){(a=t.exports).memory&&c(a.memory),e.asm=a,e.usingWasm=!0,function(t){if(X--,e.monitorRunDependencies&&e.monitorRunDependencies(X),0==X&&(null!==q&&(clearInterval(q),q=null),H)){const e=H;H=null,e()}}()}if(n.memory=e.wasmMemory,s.global={NaN:NaN,Infinity:1/0},s["global.Math"]=Math,s.env=n,X++,e.monitorRunDependencies&&e.monitorRunDependencies(X),e.instantiateWasm)try{return e.instantiateWasm(s,h)}catch(t){return e.printErr("Module.instantiateWasm callback failed with error: "+t),!1}function f(e){h(e.instance,e.module)}function d(t){(e.wasmBinary||!r&&!o||"function"!=typeof fetch?new Promise(function(e,t){e(l())}):fetch(i,{credentials:"same-origin"}).then(function(e){if(!e.ok)throw"failed to load wasm binary file at '"+i+"'";return e.arrayBuffer()}).catch(function(){return l()})).then(function(e){return window.WebAssembly.instantiate(e,s)}).then(t).catch(function(t){e.printErr("failed to asynchronously prepare wasm: "+t),ce(t)})}return e.wasmBinary||"function"!=typeof window.WebAssembly.instantiateStreaming||Y(i)||"function"!=typeof fetch?d(f):window.WebAssembly.instantiateStreaming(fetch(i,{credentials:"same-origin"}),s).then(f).catch(function(t){e.printErr("wasm streaming compile failed: "+t),e.printErr("falling back to ArrayBuffer instantiation"),d(f)}),{}}e.asmPreload=e.asm;const h=e.reallocBuffer;e.reallocBuffer=function(t){return"asmjs"===f?h(t):function(t){const i=e.usingWasm?w:b;var n,s;(n=t)%(s=i)>0&&(n+=s-n%s),t=n;const r=e.buffer.byteLength;if(e.usingWasm)try{return-1!==e.wasmMemory.grow((t-r)/65536)?e.buffer=e.wasmMemory.buffer:null}catch(e){return null}}(t)};var f="";e.asm=function(t,i,n){if(!(i=i).table){let t=e.wasmTableSize;void 0===t&&(t=1024);const n=e.wasmMaxTableSize;"object"==typeof window.WebAssembly&&"function"==typeof window.WebAssembly.Table?i.table=void 0!==n?new window.WebAssembly.Table({initial:t,maximum:n,element:"anyfunc"}):new window.WebAssembly.Table({initial:t,element:"anyfunc"}):i.table=new Array(t),e.wasmTable=i.table}let s;return i.memoryBase||(i.memoryBase=e.STATIC_BASE),i.tableBase||(i.tableBase=0),(s=u(0,i))||ce("no binaryen method succeeded. consider enabling more options, like interpreting, if you want that: https://github.com/kripken/emscripten/wiki/WebAssembly#binaryen-methods"),s}}(),R=102624,U.push();e.STATIC_BASE=1024,e.STATIC_BUMP=101600;const Z={varargs:0,get:function(e){return Z.varargs+=4,E[Z.varargs-4>>2]},getStr:function(){return d(Z.get())},get64:function(){const e=Z.get(),t=Z.get();return f(e>=0?0===t:-1===t),e},getZero:function(){f(0===Z.get())}};const Q=R+=16;R+=16;var J={};!function t(i){let n,s;t.called?(s=E[Q>>2],n=E[s>>2]):(t.called=!0,J.USER=J.LOGNAME="web_user",J.PATH="/",J.PWD="/",J.HOME="/home/web_user",J.LANG="C.UTF-8",J._=e.thisProgram,n=c(1024),s=c(256),E[s>>2]=n,E[Q>>2]=s);const r=[];let o=0;for(let e in i)if("string"==typeof i[e]){var a=e+"="+i[e];r.push(a),o+=a.length}if(o>1024)throw new Error("Environment size exceeded TOTAL_ENV_SIZE!");for(let e=0;e<r.length;e++)K(a=r[e],n),E[s+4*e>>2]=n,n+=a.length+1;E[s+4*r.length>>2]=0}(J),P=c(4),D=O=l(R),k=l(M=D+L),E[P>>2]=k,C=!0,e.wasmTableSize=58,e.wasmMaxTableSize=58,e.asmGlobalArg={},e.asmLibraryArg={abort:ce,enlargeMemory:function(){I()},getTotalMemory:function(){return B},abortOnCannotGrowMemory:I,___assert_fail:function(e,t,i,n){ce("Assertion failed: "+d(e)+", at: "+[t?d(t):"unknown filename",i,n?d(n):"unknown function"])},___lock:function(){},___setErrNo:function(t){return e.___errno_location&&(E[e.___errno_location()>>2]=t),t},___syscall140:function(e,i){Z.varargs=i;try{const e=Z.getStreamFromFD(),i=(Z.get(),Z.get()),n=Z.get(),s=Z.get(),r=i;return t.llseek(e,r,s),E[n>>2]=e.position,e.getdents&&0===r&&0===s&&(e.getdents=null),0}catch(e){return void 0!==t&&e instanceof t.ErrnoError||ce(e),-e.errno}},___syscall145:function(e,i){Z.varargs=i;try{const e=Z.getStreamFromFD(),i=Z.get(),n=Z.get();return Z.doReadv(e,i,n)}catch(e){return void 0!==t&&e instanceof t.ErrnoError||ce(e),-e.errno}},___syscall146:function i(n,s){Z.varargs=s;try{const n=Z.get(),s=Z.get(),r=Z.get();let o=0;i.buffers||(i.buffers=[null,[],[]],i.printChar=function(t,n){const s=i.buffers[t];f(s),0===n||10===n?((1===t?e.print:e.printErr)(m(s,0)),s.length=0):s.push(n)});for(let e=0;e<r;e++){const t=E[s+8*e>>2],r=E[s+(8*e+4)>>2];for(let e=0;e<r;e++)i.printChar(n,S[t+e]);o+=r}return o}catch(e){return void 0!==t&&e instanceof t.ErrnoError||ce(e),-e.errno}},___syscall192:function(e,n){Z.varargs=n;try{const e=Z.get(),n=Z.get(),s=Z.get(),r=Z.get(),o=Z.get();let a,c=Z.get();c<<=12;let l=!1;if(-1===o){if(!(a=ne(y,n)))return-i.ENOMEM;se(a,0,n),l=!0}else{let u=t.getStream(o);if(!u)return-i.EBADF;const h=t.mmap(u,S,e,n,c,s,r);a=h.ptr,l=h.allocated}return Z.mappings[a]={malloc:a,len:n,allocated:l,fd:o,flags:r},a}catch(e){return void 0!==t&&e instanceof t.ErrnoError||ce(e),-e.errno}},___syscall195:function(e,i){Z.varargs=i;try{const e=Z.getStr(),i=Z.get();return Z.doStat(t.stat,e,i)}catch(e){return void 0!==t&&e instanceof t.ErrnoError||ce(e),-e.errno}},___syscall197:function(e,i){Z.varargs=i;try{const e=Z.getStreamFromFD(),i=Z.get();return Z.doStat(t.stat,e.path,i)}catch(e){return void 0!==t&&e instanceof t.ErrnoError||ce(e),-e.errno}},___syscall221:function(e,i){Z.varargs=i;try{return 0}catch(e){return void 0!==t&&e instanceof t.ErrnoError||ce(e),-e.errno}},___syscall5:function(e,i){Z.varargs=i;try{const e=Z.getStr(),i=Z.get(),n=Z.get();return t.open(e,i,n).fd}catch(e){return void 0!==t&&e instanceof t.ErrnoError||ce(e),-e.errno}},___syscall54:function(e,i){Z.varargs=i;try{return 0}catch(e){return void 0!==t&&e instanceof t.ErrnoError||ce(e),-e.errno}},___syscall6:function(e,i){Z.varargs=i;try{const e=Z.getStreamFromFD();return t.close(e),0}catch(e){return void 0!==t&&e instanceof t.ErrnoError||ce(e),-e.errno}},___syscall91:function(e,i){Z.varargs=i;try{const e=Z.get(),i=Z.get();let n=Z.mappings[e];if(!n)return 0;if(i===n.len){const s=t.getStream(n.fd);Z.doMsync(e,s,i,n.flags),t.munmap(s),Z.mappings[e]=null,n.allocated&&te(n.malloc)}return 0}catch(e){return void 0!==t&&e instanceof t.ErrnoError||ce(e),-e.errno}},___unlock:function(){},_abort:function(){e.abort()},_emscripten_memcpy_big:function(e,t,i){return S.set(S.subarray(t,t+i),e),e},_getenv:function e(t){return 0===t?0:(t=d(t),J.hasOwnProperty(t)?(e.ret&&te(e.ret),e.ret=function(e){const t=g(e)+1,i=ie(t);return i&&_(e,x,i,t),i}(J[t])):0)},DYNAMICTOP_PTR:P,STACKTOP:O};const ee=e.asm(e.asmGlobalArg,e.asmLibraryArg,v);e.asm=ee;var te=e._free=function(){return e.asm._free.apply(null,arguments)},ie=e._malloc=function(){return e.asm._malloc.apply(null,arguments)},ne=e._memalign=function(){return e.asm._memalign.apply(null,arguments)},se=e._memset=function(){return e.asm._memset.apply(null,arguments)};e._xkb_context_new=function(){return e.asm._xkb_context_new.apply(null,arguments)},e._xkb_keymap_get_as_string=function(){return e.asm._xkb_keymap_get_as_string.apply(null,arguments)},e._xkb_keymap_new_from_string=function(){return e.asm._xkb_keymap_new_from_string.apply(null,arguments)},e._xkb_state_new=function(){return e.asm._xkb_state_new.apply(null,arguments)},e._xkb_state_serialize_layout=function(){return e.asm._xkb_state_serialize_layout.apply(null,arguments)},e._xkb_state_serialize_mods=function(){return e.asm._xkb_state_serialize_mods.apply(null,arguments)},e._xkb_state_update_key=function(){return e.asm._xkb_state_update_key.apply(null,arguments)};function re(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}let oe;function ae(t){function i(){e.calledRun||(e.calledRun=!0,u||(W||(W=!0,F(U)),F(N),e.onRuntimeInitialized&&e.onRuntimeInitialized(),function(){if(e.postRun)for("function"==typeof e.postRun&&(e.postRun=[e.postRun]);e.postRun.length;)t=e.postRun.shift(),G.unshift(t);var t;F(G)}()))}t=t||e.arguments,X>0||(function(){if(e.preRun)for("function"==typeof e.preRun&&(e.preRun=[e.preRun]);e.preRun.length;)t=e.preRun.shift(),z.unshift(t);var t;F(z)}(),X>0||e.calledRun||(e.setStatus?(e.setStatus("Running..."),setTimeout(function(){setTimeout(function(){e.setStatus("")},1),i()},1)):i()))}function ce(t){throw e.onAbort&&e.onAbort(t),void 0!==t?(e.print(t),e.printErr(t),t=JSON.stringify(t)):t="",u=!0,h=1,"abort("+t+"). Build with -s ASSERTIONS=1 for more info."}if(e.asm=ee,e.Pointer_stringify=d,e.stringToUTF8=function(e,t,i){return _(e,S,t,i)},e.lengthBytesUTF8=g,e.then=function(t){if(e.calledRun)t(e);else{const i=e.onRuntimeInitialized;e.onRuntimeInitialized=function(){i&&i(),t(e)}}return e},re.prototype=new Error,re.prototype.constructor=re,H=function t(){e.calledRun||ae(),e.calledRun||(H=t)},e.run=ae,e.exit=function(t,i){i&&e.noExitRuntime&&0===t||(e.noExitRuntime||(u=!0,h=t,O=oe,F(j),V=!0,e.onExit&&e.onExit(t)),e.quit(t,new re(t)))},e.abort=ce,e.preInit)for("function"==typeof e.preInit&&(e.preInit=[e.preInit]);e.preInit.length>0;)e.preInit.pop()();return e.noExitRuntime=!0,ae(),e}(),pe=i(47),me=i.n(pe),_e=i(23),ge=i.n(_e),ye=i(15),we=i.n(ye),be=i(48),ve=i.n(be);const{bottom:xe,bottomLeft:Se,bottomRight:Te,left:Ee,none:Re,right:Ce,top:Ae,topLeft:De,topRight:Oe}=we.a.Resize,{inactive:Me}=we.a.Transient,ke={MAXIMIZED:"maximized",FULLSCREEN:"fullscreen",POPUP:"popup",TRANSIENT:"transient",TOP_LEVEL:"top_level"};class Pe extends ve.a{static create(e,t,i,n){const s=new Pe(e,t,i,n);return e.implementation=s,t.onDestroy().then(()=>{e.destroy()}),t.implementation.role=s,s._doPing(e),e.onDestroy().then(()=>{s._unmap(),s._userShellSurface&&s._userShellSurface.destroy(),window.clearTimeout(s._timeoutTimer),window.clearTimeout(s._pingTimer)}),s}constructor(e,t,i,n){super(),this.resource=e,this.wlSurfaceResource=t,this._title="",this._clazz="",this.state=null,this.session=i,this._userShell=n,this._pingTimeoutActive=!1,this._userShellSurface=null,this._timeoutTimer=0,this._pingTimer=0,this._mapped=!1}async onCommit(e,t,i){const n=e.surfaceChildSelf.position;e.surfaceChildSelf.position=x.a.create(n.x+i.dx,n.y+i.dy),i.bufferContents?this._mapped||this._map():this._mapped&&this._unmap(),await e.render(t,i),t.fire(),await t,this.session.flush()}_map(){this._mapped=!0,this._userShellSurface&&(this._userShellSurface.mapped=!0)}_unmap(){this._mapped=!1,this._userShellSurface&&(this._userShellSurface.mapped=!1)}pong(e,t){this._pingTimeoutActive&&(this._userShellSurface.unresponsive=!1,this._pingTimeoutActive=!1),window.clearTimeout(this._timeoutTimer),this._pingTimer=window.setTimeout(()=>{this._doPing(e)},5e3)}_doPing(e){this._timeoutTimer=window.setTimeout(()=>{this._pingTimeoutActive||(this._pingTimeoutActive=!0,this._userShellSurface.unresponsive=!0)},5e3),e.ping(0),this.session.flush()}move(e,t,i){const n=t.implementation;if(!n.isValidInputSerial(i))return;if(this.state===ke.FULLSCREEN||this.state===ke.MAXIMIZED)return;const s=n.pointer,r=this.wlSurfaceResource.implementation,o=r.surfaceChildSelf,a=o.position,c=s.x,l=s.y,u=()=>{const e=s.x-c,t=s.y-l;o.position=x.a.create(a.x+e,a.y+t);const i=Z.createRenderFrame();r.views.forEach(e=>{e.applyTransformations(i)}),i.fire()};s.onButtonRelease().then(()=>{s.removeMouseMoveListener(u)}),s.addMouseMoveListener(u)}resize(e,t,i,n){const s=t.implementation;if(!s.isValidInputSerial(i))return;if(this.state===ke.FULLSCREEN||this.state===ke.MAXIMIZED)return;const r=s.pointer;let o=(e,t,i,n)=>{};switch(n){case Te:o=((e,t,i,n)=>({w:e+i,h:t+n}));break;case Ae:o=((e,t,i,n)=>({w:e,h:t-n}));break;case xe:o=((e,t,i,n)=>({w:e,h:t+n}));break;case Ee:o=((e,t,i,n)=>({w:e-i,h:t}));break;case De:o=((e,t,i,n)=>({w:e-i,h:t-n}));break;case Se:o=((e,t,i,n)=>({w:e-i,h:t+n}));break;case Ce:o=((e,t,i,n)=>({w:e+i,h:t}));break;case Oe:o=((e,t,i,n)=>({w:e+i,h:t-n}));break;case Re:default:o=((e,t,i,n)=>({w:e,h:t}))}const a=r.x,c=r.y,{w:l,h:u}=this.wlSurfaceResource.implementation.size,h=()=>{const e=r.x-a,t=r.y-c,i=o(l,u,e,t);this.resource.configure(n,i.w,i.h)};r.onButtonRelease().then(()=>{r.removeMouseMoveListener(h)}),r.addMouseMoveListener(h)}_createUserShellSurface(){this._userShellSurface=this._userShell.manage(this.wlSurfaceResource.implementation),this._userShellSurface.onActivationRequest=(()=>{this._userShellSurface.activationAck()}),this._userShellSurface.onInactive=(()=>{}),this._userShellSurface.title=this._title,this._userShellSurface.appId=this._clazz,this._userShellSurface.mapped=this._mapped}setToplevel(e){this.state!==ke.POPUP&&this.state!==ke.TRANSIENT&&(this._userShellSurface||this._createUserShellSurface(),this.state=ke.TOP_LEVEL)}setTransient(e,t,i,n,s){if(this.state===ke.POPUP||this.state===ke.TOP_LEVEL)return;const r=t.implementation.surfaceChildSelf.position;this.wlSurfaceResource.implementation.surfaceChildSelf.position=x.a.create(r.x+i,r.y+n),this.wlSurfaceResource.implementation.hasKeyboardInput=0==(s&Me),this._userShellSurface||this._createUserShellSurface(),this.state=ke.TRANSIENT}setFullscreen(e,t,i,n){this.state=ke.FULLSCREEN,this.wlSurfaceResource.implementation.surfaceChildSelf.position=x.a.create(0,0),this.resource.configure(Re,window.innerWidth,window.innerHeight)}async setPopup(e,t,i,n,s,r,o){const a=t.implementation;if(!a.isValidInputSerial(a.buttonPressSerial))return void this._dismiss();if(this.state)return;const c=a.pointer;this.state=ke.POPUP;const l=this.wlSurfaceResource.implementation,u=l.surfaceChildSelf;u.position=x.a.create(s,r);const h=e=>{const t=Z.createRenderFrame();e.applyTransformations(t),t.fire(),e.onDestroy().then(()=>{e.detach()})};n.implementation.addChild(u).forEach(h),l.onViewCreated=h,l.hasKeyboardInput=0==(o&Me),c.popupGrab(this.wlSurfaceResource).then(()=>{e.popupDone()})}setMaximized(e,t){this.state=ke.MAXIMIZED;const i=this.wlSurfaceResource.implementation,{height:n}=this._userShell.panel.getBoundingClientRect(),{width:s,height:r}=this._userShell.workspace.getBoundingClientRect();i.surfaceChildSelf.position=x.a.create(0,n),this.resource.configure(Re,s,r)}setTitle(e,t){this._title=t,this._userShellSurface&&(this._userShellSurface.title=t)}setClass(e,t){this._clazz=t,this._userShellSurface&&(this._userShellSurface.appId=t)}captureRoleState(){}setRoleState(e){}}class Ie extends me.a{static create(e,t){return new Ie(e,t)}constructor(e,t){super(),this.session=e,this.userShell=t,this._global=null}bindClient(e,t,i){new ge.a(e,t,i).implementation=this}registerGlobal(e){this._global||(this._global=e.createGlobal(this,ge.a.protocolName,1,(e,t,i)=>{this.bindClient(e,t,i)}))}unregisterGlobal(){this._global&&(this._global.destroy(),this._global=null)}getShellSurface(e,t,i){if(i.implementation.role)return void e.postError(ge.a.Error.role,"Given surface has another role.");const n=new we.a(e.client,t,e.version);Pe.create(n,i,this.session,this.userShell)}}var Le=i(31),Be=i.n(Le),Fe=i(21),ze=i.n(Fe),Ue=i(10),Ne=i.n(Ue),je=i(13),Ge=i.n(je),We=i(38),Ve=i.n(We),Ke=i(36),Xe=i.n(Ke);const{pressed:qe,released:He}=Ne.a.ButtonState,{horizontalScroll:$e,verticalScroll:Ye}=Ne.a.Axis,{wheel:Ze}=Ne.a.AxisSource,Qe={0:272,1:274,2:273,3:278,4:277};class Je extends Xe.a{static create(e,t){const i=new Je(t);return document.addEventListener("mousemove",t=>{const n=t;i._handleMouseMove(n)&&(n.preventDefault(),n.stopPropagation(),e.flush())}),document.addEventListener("mouseup",t=>{const n=t;i._handleMouseUp(n)&&(n.preventDefault(),n.stopPropagation(),e.flush())}),document.addEventListener("mousedown",t=>{const n=t;i._handleMouseDown(n)&&(n.preventDefault(),n.stopPropagation(),e.flush())}),document.addEventListener("wheel",t=>{const n=t;i._handleWheel(n)&&(n.preventDefault(),n.stopPropagation(),e.flush())}),i}constructor(e){super(),this._dataDevice=e,this.resources=[],this.focus=null,this.grab=null,this._popupStack=[],this.x=0,this.y=0,this._cursorSurface=null,this._view=null,this._cursorDestroyListener=(()=>{this._cursorSurface=null,this.setDefaultCursor()}),this._btnDwnCount=0,this._mouseMoveListeners=[],this.hotspotX=0,this.hotspotY=0,this._buttonPressPromise=null,this._buttonPressResolve=null,this._buttonReleasePromise=null,this._buttonReleaseResolve=null,this.seat=null}onButtonPress(){return this._buttonPressPromise||(this._buttonPressPromise=new Promise(e=>{this._buttonPressResolve=e}).then(()=>{this._buttonPressPromise=null,this._buttonPressResolve=null})),this._buttonPressPromise}onButtonRelease(){return this._buttonReleasePromise||(this._buttonReleasePromise=new Promise(e=>{this._buttonReleaseResolve=e}).then(()=>{this._buttonReleasePromise=null,this._buttonReleaseResolve=null})),this._buttonReleasePromise}async onCommit(e,t,i){this.hotspotX-=i.dx,this.hotspotY-=i.dy;const n=this.hotspotX,s=this.hotspotY;if(this._cursorSurface&&this._cursorSurface.implementation===e&&i.bufferContents){const r=L.fullFrame(i.bufferContents.encodingOptions),o=L.splitAlpha(i.bufferContents.encodingOptions);if(r&&!o){await e.render(t,i,!0);const r=new Blob([i.bufferContents.pixelContent[0].opaque],{type:i.bufferContents.mimeType});window.document.body.style.cursor=`url("${URL.createObjectURL(r)}") ${n} ${s}, pointer`,t.fire(),await t}else{await e.render(t,i);const r=this._view.bufferedCanvas.frontContext.canvas.toDataURL();window.document.body.style.cursor=`url("${r}") ${n} ${s}, pointer`,t.fire(),await t}}e.session.flush()}setCursor(e,t,i,n,s){if(i){const t=i.implementation;if(t.role&&t.role!==this)return void e.postError(Ne.a.Error.role,"Given surface has another role.")}this._dataDevice.dndSourceClient||t===this.seat.enterSerial&&this.setCursorInternal(i,n,s)}popupGrab(e){let t=this.findPopupGrab(e);if(this.findPopupGrab(e))return t.promise;let i=null,n=new Promise(t=>{e.onDestroy().then(()=>{t()}),i=t});return t={popup:e,resolve:i,promise:n},this._popupStack.push(t),n.then(()=>{const e=this._popupStack.indexOf(t);if(e>-1){const t=this._popupStack.slice(e);this._popupStack.splice(e),t.shift(),t.reverse().forEach(e=>{e.resolve()})}}),this.grab=null,this._btnDwnCount=0,n}findPopupGrab(e){return this._popupStack.find(t=>t.popup===e)||null}setCursorInternal(e,t,i){if(this.hotspotX=t,this.hotspotY=i,this._cursorSurface&&(this._cursorSurface.removeDestroyListener(this._cursorDestroyListener),this._cursorSurface.implementation.role=null),this._cursorSurface=e,e){const t=e.implementation;this._view&&this._view.destroy(),this._view=t.createView(),t.resource.addDestroyListener(this._cursorDestroyListener),t.role=this,t.state.inputPixmanRegion=M.createPixmanRegion(),t._pendingInputRegion=M.createPixmanRegion()}else window.document.body.style.cursor="none"}release(e){e.destroy();const t=this.resources.indexOf(e);t>-1&&this.resources.splice(t,1)}addMouseMoveListener(e){this._mouseMoveListeners.push(e)}removeMouseMoveListener(e){const t=this._mouseMoveListeners.indexOf(e);t>-1&&this._mouseMoveListeners.splice(t,1)}_focusFromEvent(e){const t=e.target;return t.view&&!t.view.destroyed&&t.view.surface&&t.view.surface.hasPointerInput?t.view:null}_handleMouseMove(e){let t=!1;this.x=e.clientX<0?0:e.clientX,this.y=e.clientY<0?0:e.clientY;let i=this._focusFromEvent(e);const n=this._popupStack.length;if(n&&i&&i.surface.resource.client!==this._popupStack[n-1].popup.client&&(i=null),this._dataDevice.dndSourceClient)return this._dataDevice.onMouseMotion(i),!0;if(this.grab||i!==this.focus&&(this.unsetFocus(),i?this.setFocus(i):this.setDefaultCursor()),this._mouseMoveListeners.forEach(e=>e(this.focus)),this.focus&&this.focus.surface){t=!0;const i=this._calculateSurfacePoint(this.focus),n=this.focus.surface.resource;this._doPointerEventFor(n,t=>{t.motion(e.timeStamp,s.Fixed.parse(i.x),s.Fixed.parse(i.y)),t.version>=5&&t.frame()})}return t}_doPointerEventFor(e,t){this.resources.forEach(i=>{i.client===e.client&&t(i)})}_handleMouseUp(e){let t=!1;if(this._dataDevice.dndSourceClient)return this._dataDevice.onMouseUp(),!0;const i=this._popupStack.length;if(this.focus&&this.focus.surface){if(t=!0,this.grab||i){const t=this.focus.surface.resource;this._doPointerEventFor(t,t=>{t.button(this.seat.nextButtonSerial(!1),e.timeStamp,Qe[e.button],He),t.version>=5&&t.frame()})}this.grab&&(this._btnDwnCount--,0===this._btnDwnCount&&(this.grab=null))}else if(i){const t=this._focusFromEvent(e),n=this._popupStack[i-1];(!t||n.popup.implementation.state.bufferContents&&t.surface.resource.client!==n.popup.client)&&n.resolve()}return this._buttonReleaseResolve&&this._buttonReleaseResolve(e),t}_handleMouseDown(e){let t=this._handleMouseMove(e);if(this.focus&&this.focus.surface){t=!0,null===this.grab&&0===this._popupStack.length&&(this.grab=this.focus),this._popupStack.length||this._btnDwnCount++;const i=this.focus.surface.resource;this._doPointerEventFor(i,t=>{t.button(this.seat.nextButtonSerial(!0),e.timeStamp,Qe[e.button],qe),t.version>=5&&t.frame()})}return this._buttonPressResolve&&this._buttonPressResolve(e),t}_calculateSurfacePoint(e){const t=x.a.create(this.x,this.y);return e.toSurfaceSpace(t)}_isPointerWithinInputRegion(e){if(e.view){const t=e.view,i=this._calculateSurfacePoint(t);return t.surface.isWithinInputRegion(i)}return!1}calculateFocus(){const e=window.document.elementsFromPoint(this.x,this.y);let t=-1,i={view:null};return e.forEach(e=>{e.view&&!e.view.destroyed&&e.view.surface&&e.view.surface.hasPointerInput&&this._isPointerWithinInputRegion(e)&&window.parseInt(e.style.zIndex)>t&&(t=e.style.zIndex,i=e)}),i.view}setFocus(e){this.focus=e;const t=this.focus.surface.resource;e.onDestroy().then(()=>{if(!this.focus)return;if(e!==this.focus)return;const t=this.calculateFocus();t?this.setFocus(t):(this.unsetFocus(),this.setDefaultCursor())});const i=this._calculateSurfacePoint(e);this._doPointerEventFor(t,e=>{e.enter(this.seat.nextEnterSerial(),t,s.Fixed.parse(i.x),s.Fixed.parse(i.y))})}unsetFocus(){if(this.focus&&!this.focus.destroyed&&this.focus.surface){const e=this.focus.surface.resource;this._doPointerEventFor(e,t=>{t.leave(this.seat.nextSerial(),e),t.version>=5&&t.frame()})}this.focus=null,this.grab=null,this.view=null,this._btnDwnCount=0,this._cursorSurface&&(this._cursorSurface.implementation.role=null,this._cursorSurface=null)}setDefaultCursor(){window.document.body.style.cursor="auto"}_handleWheel(e){let t=!1;if(this.focus&&this.focus.surface){let i;switch(t=!0,e.deltaMode){case e.DOM_DELTA_LINE:i=(e=>18*e);break;case e.DOM_DELTA_PAGE:i=((e,t)=>t===Ye?e*this.focus.surface.size.h:e*this.focus.surface.size.w);break;case e.DOM_DELTA_PIXEL:default:i=(e=>e)}const n=this.focus.surface.resource;this._doPointerEventFor(n,t=>{const n=e.deltaX;if(n){const r=$e;t.version>=5&&t.axisDiscrete(r,n);const o=i(n,r);t.axis(e.timeStamp,r,s.Fixed.parse(o))}const r=e.deltaY;if(r){const n=Ye;t.version>=5&&t.axisDiscrete(n,r);const o=i(r,n);t.axis(e.timeStamp,n,s.Fixed.parse(o))}t.version>=5&&(t.axisSource(Ze),t.frame())})}return t}captureRoleState(){}setRoleState(e){}}var et=i(35),tt=i.n(et);const it=1,nt=1,st=2,rt=0,ot=0,at=1,ct=1,lt=2,ut=4,ht=128;class ft{static createFromResource(e){return new Promise((t,i)=>{const n=new window.XMLHttpRequest;n.onreadystatechange=(()=>{if(n.readyState===window.XMLHttpRequest.DONE&&200===n.status){const e=n.responseText;try{const n=ft.create(e);t(n)}catch(e){i(e)}}}),n.open("GET",`keymaps/${e}`),n.send()})}static create(e){const t=de._malloc(de.lengthBytesUTF8(e)+1);de.stringToUTF8(e,t,de.lengthBytesUTF8(e)+1);const i=de._xkb_context_new(nt|st),n=de._xkb_keymap_new_from_string(i,t,it,rt),s=de._xkb_state_new(n);return de._free(t),new ft(i,n,s)}constructor(e,t,i){this.xkbContext=e,this.keymap=t,this.state=i,this._stateComponentMask=0}asString(){const e=de._xkb_keymap_get_as_string(this.keymap,it);return de.Pointer_stringify(e)}keyUp(e){return 0!==de._xkb_state_update_key(this.state,e,ot)}keyDown(e){return 0!==de._xkb_state_update_key(this.state,e,at)}get modsDepressed(){return de._xkb_state_serialize_mods(this.state,ct)}get modsLatched(){return de._xkb_state_serialize_mods(this.state,lt)}get modsLocked(){return de._xkb_state_serialize_mods(this.state,ut)}get group(){return de._xkb_state_serialize_layout(this.state,ht)}}ft.linuxKeycode={Escape:9,Digit1:10,Digit2:11,Digit3:12,Digit4:13,Digit5:14,Digit6:15,Digit7:16,Digit8:17,Digit9:18,Digit0:19,Minus:20,Equal:21,Backspace:22,Tab:23,KeyQ:24,KeyW:25,KeyE:26,KeyR:27,KeyT:28,KeyY:29,KeyU:30,KeyI:31,KeyO:32,KeyP:33,BracketLeft:34,BracketRight:35,Enter:36,ControlLeft:37,KeyA:38,KeyS:39,KeyD:40,KeyF:41,KeyG:42,KeyH:43,KeyJ:44,KeyK:45,KeyL:46,Semicolon:47,Quote:48,Backquote:49,ShiftLeft:50,Backslash:51,KeyZ:52,KeyX:53,KeyC:54,KeyV:55,KeyB:56,KeyN:57,KeyM:58,Comma:59,Period:60,Slash:61,ShiftRight:62,NumpadMultiply:63,AltLeft:64,Space:65,CapsLock:66,F1:67,F2:68,F3:69,F4:70,F5:71,F6:72,F7:73,F8:74,F9:75,F10:76,NumLock:77,ScrollLock:78,Numpad7:79,Numpad8:80,Numpad9:81,NumpadSubtract:82,Numpad4:83,Numpad5:84,Numpad6:85,NumpadAdd:86,Numpad1:87,Numpad2:88,Numpad3:89,Numpad0:90,NumpadDecimal:91,IntlBackslash:94,F11:95,F12:96,IntlRo:97,Convert:100,KanaMode:101,NonConvert:102,NumpadEnter:104,ControlRight:105,NumpadDivide:106,PrintScreen:107,AltRight:108,Home:110,ArrowUp:111,PageUp:112,ArrowLeft:113,ArrowRight:114,End:115,ArrowDown:116,PageDown:117,Insert:118,Delete:119,NumpadEqual:125,Pause:127,IntlYen:132,OSLeft:133,OSRight:134,ContextMenu:135};const{pressed:dt,released:pt}=Ge.a.KeyState,{xkbV1:mt}=Ge.a.KeymapFormat;class _t extends tt.a{static create(e,t){const i=new _t(t,e);return i.updateKeymap("qwerty.xkb"),document.addEventListener("keyup",t=>{const n=t;i._handleKey(n,!1)&&(n.preventDefault(),n.stopPropagation(),e.flush())}),document.addEventListener("keydown",t=>{const n=t;i._handleKey(n,!0)&&(n.preventDefault(),n.stopPropagation(),e.flush())}),i}constructor(e,t){super(),this._dataDevice=e,this._session=t,this.resources=[],this._xkb=null,this._focus=null,this._keys=[],this._keyboardFocusListeners=[],this._keyboardFocusResolve=null,this._keyboardFocusPromise=null,this.seat=null}addKeyboardFocusListener(e){this._keyboardFocusListeners.push(e)}removeKeyboardFocusListener(e){const t=this._keyboardFocusListeners.indexOf(e);t>0&&this._keyboardFocusListeners.splice(t,1)}onKeyboardFocusChanged(){return this._keyboardFocusPromise||(this._keyboardFocusPromise=new Promise(e=>{this._keyboardFocusResolve=e}).then(()=>{this._keyboardFocusPromise=null,this._keyboardFocusResolve=null})),this._keyboardFocusPromise}release(e){e.destroy();const t=this.resources.indexOf(e);t>-1&&this.resources.splice(t,1)}updateKeymap(e){ft.createFromResource(e).then(e=>{this._xkb,this._xkb=e,this.resources.forEach(e=>{this.emitKeymap(e)})})}emitKeymap(e){const t=this._xkb.asString(),i=new TextEncoder("utf-8").encode(t).buffer,n=this._session.webFS.fromArrayBuffer(i);e.keymap(mt,n,i.byteLength),e.client.connection.flush()}focusGained(e){if(e.hasKeyboardInput&&this.focus!==e&&(this.focus&&this.focusLost(),e)){this.focus=e,this._dataDevice.onKeyboardFocusGained(e),e.resource.onDestroy().then(()=>{this.focus===e&&(this.focus=null)});const t=this.seat.nextSerial(),i=this.focus.resource,n=new Uint8Array(this._keys).buffer;this.resources.filter(e=>e.client===this.focus.resource.client).forEach(e=>{e.enter(t,i,n)}),this._keyboardFocusResolve&&this._keyboardFocusResolve(),this._keyboardFocusListeners.forEach(e=>{e()})}}focusLost(){if(this.focus){const e=this.seat.nextSerial(),t=this.focus.resource;this.resources.filter(e=>e.client===this.focus.resource.client).forEach(i=>{i.leave(e,t)}),this.focus=null}}set focus(e){this._focus=e,this._keyboardFocusResolve&&this._keyboardFocusResolve(),this._keyboardFocusListeners.forEach(e=>{e()})}get focus(){return this._focus}_handleKey(e,t){let i=!1;const n=e.code,s=ft.linuxKeycode[n];if(t&&this._keys.includes(s))return!1;const r=t?this._xkb.keyDown(s):this._xkb.keyUp(s);if(t)this._keys.push(s);else{const e=this._keys.indexOf(s);e>-1&&this._keys.splice(e,1)}if(this.focus){i=!0;const n=e.timeStamp,o=s-8,a=t?dt:pt,c=this.seat.nextKeySerial(t),l=this._xkb.modsDepressed,u=this._xkb.modsLatched,h=this._xkb.modsLocked,f=this._xkb.group;this.resources.filter(e=>e.client===this.focus.resource.client).forEach(e=>{e.key(c,n,o,a),r&&e.modifiers(c,l,u,h,f)})}return i}emitKeyRepeatInfo(e){e.version>=4&&e.repeatInfo(40,400)}}class gt{static create(){return new gt}constructor(){this.resources=[],this.seat=null}release(e){e.destroy();const t=this.resources.indexOf(e);t>-1&&this.resources.splice(t,1)}}var yt=i(32),wt=i.n(yt),bt=i(17),vt=i.n(bt),xt=i(7),St=i.n(xt),Tt=i(18),Et=i.n(Tt),Rt=i(33),Ct=i.n(Rt),At=i(34),Dt=i.n(At);const{copy:Ot,move:Mt,ask:kt,none:Pt}=St.a.DndAction,It=Ot|Mt|kt;class Lt extends Ct.a{static create(e,t,i){const n=new Lt(e),s=new Dt.a(i.client,t,i.version);return s.implementation=n,n.resource=s,s.onDestroy().then(()=>{n._handleDestroy()}),n}constructor(e){super(),this.resource=null,this.acceptMimeType=null,this.preferredAction=0,this.dndActions=Pt,this.wlDataSource=e,this._finished=!1,this.inAsk=!1}_handleDestroy(){if(!this.wlDataSource)return;const e=this.wlDataSource.implementation;e.wlDataOffer===this.resource&&(this.resource<3?e.notifyFinish():this.wlDataSource.resource&&this.wlDataSource.resource.version>=3&&this.wlDataSource.resource.cancelled(),e.wlDataOffer=null)}accept(e,t,i){this.wlDataSource&&this.wlDataSource.implementation.wlDataOffer&&(this._finished,this.acceptMimeType=i,this.wlDataSource.target(i),this.wlDataSource.implementation.accepted=null!==i)}receive(e,t,i){this._finished,this.wlDataSource?this.wlDataSource.send(t,i):this.wlDataSource.send("",-1)}destroy(e){e.destroy()}finish(e){if(!this.wlDataSource&&this.preferredAction&&this.acceptMimeType&&!this._finished&&this.wlDataSource.implementation.accepted){switch(this.wlDataSource.implementation.currentDndAction){case Pt:case kt:return}this.wlDataSource.implementation.notifyFinish()}}_bitCount(e){const t=e-(e>>1&3681400539)-(e>>2&1227133513);return(t+(t>>3)&3340530119)%63}setActions(e,t,i){this.wlDataSource&&(this._finished,t&~It||(!i||i&t&&!(this._bitCount(i)>1))&&(this.dndActions=t,this.preferredAction=i,this.updateAction()))}updateAction(){if(!this.wlDataSource)return;const e=this._chooseAction();this.wlDataSource.implementation.currentDndAction!==e&&(this.wlDataSource.implementation.currentDndAction=e,this.inAsk||(this.wlDataSource.version>=3&&this.wlDataSource.action(e),this.resource.version>=3&&this.resource.action(e)))}_chooseAction(){let e=Pt,t=Pt;this.resource>=3?(e=this.dndActions,t=this.preferredAction):e=Ot;let i=Pt;const n=e&(i=this.wlDataSource.version>=3?this.wlDataSource.implementation.dndActions:Ot);return n?0!=(t&n)?t:1<<Math.floor(Math.log2(n))-1:Pt}}const Bt=St.a.DndAction;class Ft extends wt.a{static create(){return new Ft}constructor(){super(),this.resources=[],this.seat=null,this.dndSource=null,this.selectionSource=null,this.dndFocus=null,this.dndSourceClient=null,this._selectionFocus=null,this._dndSourceDestroyListener=(()=>{this._handleDndSourceDestroy()}),this._selectionSourceDestroyListener=(()=>{this._handleSelectionSourceDestroy()})}_dataDeviceForClient(e){const t=this.resources.find(t=>t.client===e);return null==t?null:t}_handleDndSourceDestroy(){const e=this._dataDeviceForClient(this.dndSourceClient);null!==e&&(e.leave(),this.dndSourceClient=null)}_handleSelectionSourceDestroy(){if(null===this._selectionFocus)return;const e=this._selectionFocus.resource.client,t=this._dataDeviceForClient(e);null!=t&&(t.selection(null),this.selectionSource=null)}startDrag(e,t,i,n,s){if(n.implementation.role)return void e.postError(vt.a.Error.role,"Given surface has another role.");const r=this.seat.pointer;if(this.seat.serial!==s)return;if(r.grab.surface.resource!==i)return;const o=r.focus;r.unsetFocus(),null!==n&&r.setCursorInternal(n,0,0),this.dndSourceClient=e.client,this.dndSource&&this.dndSource.removeDestroyListener(this._dndSourceDestroyListener),this.dndSource=t,this.dndSource&&this.dndSource.addDestroyListener(this._dndSourceDestroyListener),o&&this._onFocusGained(o)}onMouseMotion(e){if(this.dndFocus!==e&&(this.dndFocus&&this._onFocusLost(),e&&this._onFocusGained(e)),this.dndFocus=e,!this.dndFocus)return;const t=this.dndFocus.surface.resource.client;if(null===this.dndSource&&t!==this.dndSourceClient)return;const i=this.seat.pointer,n=x.a.create(i.x,i.y),r=this.dndFocus.toSurfaceSpace(n);this.resources.filter(e=>e.client===t).forEach(e=>{e.motion(Date.now(),s.Fixed.parse(r.x),s.Fixed.parse(r.y))})}_onFocusGained(e){if(this.dndFocus=e,!this.dndSourceClient)return;const t=e.surface.resource,i=t.client;if(null===this.dndSource&&i!==this.dndSourceClient)return;const n=this.seat.pointer,r=x.a.create(n.x,n.y),o=e.toSurfaceSpace(r),a=this.seat.nextSerial(),c=s.Fixed.parse(o.x),l=s.Fixed.parse(o.y),u=this._dataDeviceForClient(i);if(null===u)return;let h=null;if(this.dndSource&&((h=this._createDataOffer(this.dndSource,u)).implementation.updateAction(),this.dndSource.accepted=!1),u.enter(a,t,c,l,h),h){const e=this.dndSource.implementation.dndActions;h.version>=3&&h.sourceActions(e)}}_onFocusLost(){if(!this.dndSourceClient)return;const e=this.dndFocus.surface.resource.client;if(null===this.dndSource&&e!==this.dndSourceClient)return;const t=this._dataDeviceForClient(e);t&&t.leave(),this.dndFocus=null}onMouseUp(){if(this.dndSource&&this.dndFocus){const e=this.dndFocus.surface.resource.client,t=this._dataDeviceForClient(e);if(t){const e=this.dndSource.implementation;if(e.accepted&&e.currentDndAction){t.drop(),this.dndSource.version>=3&&this.dndSource.dndDropPerformed(),e.wlDataOffer.implementation.inAsk=this.dndSource.currentDndAction===Bt.ask}else this.dndSource&&this.dndSource.version>=3&&this.dndSource.cancelled();t.leave()}}this.dndSourceClient=null;const e=this.seat.pointer;this.dndFocus?e.setFocus(this.dndFocus):e.setDefaultCursor()}_createDataOffer(e,t){const i=t.dataOffer(),n=Lt.create(e,i,t);return e.implementation.wlDataOffer=n.resource,e.implementation.mimeTypes.forEach(e=>{n.resource.offer(e)}),n.resource}setSelection(e,t,i){const n=t.implementation;t&&n.dndActions?t.postError(Et.a.Error.invalidSource,"Can not set selection when source has dnd actions active."):(this.selectionSource&&(this.selectionSource.removeDestroyListener(this._selectionSourceDestroyListener),this.selectionSource.cancelled()),this.selectionSource=t,this._selectionFocus&&(this.selectionSource.addDestroyListener(this._selectionSourceDestroyListener),this.onKeyboardFocusGained(this._selectionFocus)))}onKeyboardFocusGained(e){this._selectionFocus=e;const t=this._selectionFocus.resource.client,i=this._dataDeviceForClient(t);if(null!=i)if(null===this.selectionSource)i.selection(null);else{const e=this._createDataOffer(this.selectionSource,i);i.selection(e),this.selectionSource.implementation.wlDataOffer=e}}release(e){this.dndSource&&this.dndSource.removeDestroyListener(this._dndSourceDestroyListener);const t=this.resources.indexOf(e);t>-1&&this.resources.splice(t,1),e.destroy()}}const{keyboard:zt,pointer:Ut,touch:Nt}=ze.a.Capability;class jt extends Be.a{static create(e){const t=Ft.create(),i=_t.create(e,t),n=Je.create(e,t),s=gt.create(),r="ontouchstart"in document.documentElement,o=new jt(t,n,i,s,r);return t.seat=o,i.seat=o,n.seat=o,s.seat=o,o}constructor(e,t,i,n,s){super(),this.dataDevice=e,this.pointer=t,this.keyboard=i,this.touch=n,this.hasTouch=s,this._global=null,this._seatName="browser-seat0",this.serial=0,this.buttonPressSerial=0,this.buttonReleaseSerial=0,this.keyPressSerial=0,this.keyReleaseSerial=0,this.touchDownSerial=0,this.touchUpSerial=0,this.enterSerial=0,this._keyboardResourceListeners=[]}registerGlobal(e){this._global||(this._global=e.createGlobal(this,ze.a.protocolName,6,(e,t,i)=>{this.bindClient(e,t,i)}))}unregisterGlobal(){this._global&&(this._global.destroy(),this._global=null)}bindClient(e,t,i){const n=new ze.a(e,t,i);n.implementation=this,this._emitCapabilities(n),this._emitName(n)}_emitCapabilities(e){let t=Ut|zt;this.hasTouch&&(t|=Nt),e.capabilities(t)}_emitName(e){e.version>=2&&e.name(this._seatName)}nextSerial(){return this.serial++,this.serial&1<<24&&(this.serial=0),this.serial}isValidInputSerial(e){return e===this.buttonPressSerial||e===this.buttonReleaseSerial||e===this.keyPressSerial||e===this.keyReleaseSerial||e===this.touchDownSerial||e===this.touchUpSerial}nextEnterSerial(){return this.enterSerial=this.nextSerial(),this.enterSerial}nextButtonSerial(e){if(e){const e=1<<24;return this.buttonPressSerial=this.nextSerial()|e,this.buttonPressSerial}{const e=2<<24;return this.buttonReleaseSerial=this.nextSerial()|e,this.buttonReleaseSerial}}nextKeySerial(e){if(e){const e=3<<24;return this.keyPressSerial=this.nextSerial()|e,this.keyPressSerial}{const e=4<<24;return this.keyReleaseSerial=this.nextSerial()|e,this.keyReleaseSerial}}nextTouchSerial(e){if(e){const e=5<<24;return this.touchDownSerial=this.nextSerial()|e,this.touchDownSerial}{const e=6<<24;return this.touchUpSerial=this.nextSerial()|e,this.touchUpSerial}}getPointer(e,t){const i=new Ne.a(e.client,t,e.version);i.implementation=this.pointer,this.pointer.resources.push(i),i.onDestroy().then(()=>{const e=this.pointer.resources.indexOf(i);e>-1&&this.pointer.resources.splice(e,1)})}getKeyboard(e,t){const i=new Ge.a(e.client,t,e.version);i.implementation=this.keyboard,this.keyboard.resources.push(i),i.onDestroy().then(()=>{const e=this.keyboard.resources.indexOf(i);e>-1&&this.keyboard.resources.splice(e,1)}),this.keyboard.emitKeymap(i),this.keyboard.emitKeyRepeatInfo(i),this._keyboardResourceListeners.forEach(e=>e(i))}addKeyboardResourceListener(e){this._keyboardResourceListeners.push(e)}removeKeyboardResourceListener(e){const t=this._keyboardResourceListeners.indexOf(e);t>-1&&this._keyboardResourceListeners.splice(t,1)}getTouch(e,t){const i=new Ve.a(e.client,t,e.version);this.touch.resources.push(i),this.hasTouch&&(i.implementation=this.touch)}release(e){e.destroy()}}var Gt=jt,Wt=i(43),Vt=i.n(Wt),Kt=i(44),Xt=i.n(Kt);const{copy:qt,move:Ht,ask:$t,none:Yt}=St.a.DndAction,Zt=qt|Ht|$t;class Qt extends Xt.a{static create(e){const t=new Qt(e);return e.implementation=t,t}constructor(e){super(),this.resource=e,this.mimeTypes=[],this.dndActions=0,this._actionsSet=!1,this.currentDndAction=Yt,this.accepted=!1,this.wlDataOffer=null}offer(e,t){this.mimeTypes.push(t),this.wlDataOffer&&this.wlDataOffer.offer(t)}destroy(e){e.destroy()}setActions(e,t){this._actionsSet||this.dndActions&~Zt||(this.dndActions=t,this._actionsSet=!0)}notifyFinish(){this.dndActions&&(this.wlDataOffer.implementation.inAsk&&this.resource.version>=3&&this.resource.action(this.currentDndAction),this.resource>=3&&this.resource.dndFinished(),this.wlDataOffer=null)}}class Jt extends Vt.a{static create(){return new Jt}constructor(){super(),this._global=null}registerGlobal(e){this._global||(this._global=e.createGlobal(this,St.a.protocolName,3,(e,t,i)=>{this.bindClient(e,t,i)}))}unregisterGlobal(){this._global&&(this._global.destroy(),this._global=null)}bindClient(e,t,i){new St.a(e,t,i).implementation=this}createDataSource(e,t){const i=new Et.a(e.client,t,e.version);Qt.create(i)}getDataDevice(e,t,i){const n=new vt.a(e.client,t,e.version),s=i.implementation;n.implementation=s.dataDevice,s.dataDevice.resources.push(n)}}var ei=i(30),ti=i.n(ei);class ii extends ti.a{static create(){return new ii}constructor(){super(),this._global=null}registerGlobal(e){this._global||(this._global=e.createGlobal(this,b.a.protocolName,3,(e,t,i)=>{this.bindClient(e,t,i)}))}unregisterGlobal(){this._global&&(this._global.destroy(),this._global=null)}bindClient(e,t,i){const n=new b.a(e,t,i);n.implementation=this,this.emitSpecs(n)}emitSpecs(e){this._emitGeomtry(e),this._emitMode(e),e.version>=2&&e.done()}_emitMode(e){const t=b.a.Mode.current,i=Math.ceil(window.innerWidth*window.devicePixelRatio),n=Math.ceil(window.innerHeight*window.devicePixelRatio);e.mode(t,i,n,60)}_emitGeomtry(e){const t=Math.ceil(.2646*window.innerWidth),i=Math.ceil(.2646*window.innerHeight),n=b.a.Subpixel.unknown,s=window.navigator.userAgent,r=window.screen.orientation.type;let o=b.a.Transform.normal;switch(r){case"portrait-primary":o=b.a.Transform.normal;break;case"portrait-secondary":o=b.a.Transform[180];break;case"landscape-primary":o=b.a.Transform.normal;break;case"landscape-secondary":o=b.a.Transform[180]}e.geometry(0,0,t,i,n,"Greenfield",s,o)}release(e){e.destroy()}}var ni=i(45),si=i.n(ni),ri=i(22),oi=i.n(ri),ai=i(19),ci=i.n(ai),li=i(46),ui=i.n(li);class hi extends ui.a{static create(e,t,i){const n=new hi(e,t,i);return i.implementation=n,t.onDestroy().then(()=>{n._inert=!0}),e.onDestroy().then(()=>{}),t.implementation.role=n,n}constructor(e,t,i){super(),this.parentWlSurfaceResource=e,this.wlSurfaceResource=t,this.resource=i,this._sync=!0,this.pendingPosition=x.a.create(0,0),this._cachedState=t.implementation.state,this._inert=!1}onParentCommit(e,t){if(this._inert)return;const i=this.wlSurfaceResource.implementation;this._effectiveSync&&this._cachedState&&(i.render(t,this._cachedState),this._cachedState=null)}async onCommit(e,t,i){if(!this._inert)if(this._effectiveSync)this._cachedState||(this._cachedState=e.state),he.mergeState(this._cachedState,i);else{let n=i;this._cachedState&&(he.mergeState(this._cachedState,i),n=this._cachedState,this._cachedState=null),await e.render(t,n),t.fire(),await t,e.session.flush()}}destroy(e){e.destroy()}setPosition(e,t,i){this._inert||(this.pendingPosition=x.a.create(t,i))}placeAbove(e,t){const i=this.parentWlSurfaceResource.implementation,n=t.implementation,s=n.surfaceChildSelf;if(!i.subsurfaceChildren.includes(s)||n===i)return void e.postError(ci.a.Error.badSurface,"Surface is not a sibling or the parent.");if(this._inert)return;const r=this.wlSurfaceResource.implementation,o=i.pendingSubsurfaceChildren.indexOf(r.surfaceChildSelf);i.pendingSubsurfaceChildren.splice(o,1);const a=i.pendingSubsurfaceChildren.indexOf(s)+1;i.pendingSubsurfaceChildren.splice(a,0,r.surfaceChildSelf)}placeBelow(e,t){if(this._inert)return;const i=this.parentWlSurfaceResource.implementation,n=this.wlSurfaceResource.implementation,s=i.pendingSubsurfaceChildren.indexOf(n.surfaceChildSelf);i.pendingSubsurfaceChildren.splice(s,1);const r=t.implementation,o=i.pendingSubsurfaceChildren.indexOf(r.surfaceChildSelf);i.pendingSubsurfaceChildren.splice(o,0,n.surfaceChildSelf)}get _effectiveSync(){return this._sync||this._parentEffectiveSync}get _parentEffectiveSync(){let e=!1;const t=this.parentWlSurfaceResource.implementation.role;return t&&t instanceof hi&&(e=t._effectiveSync),e}setSync(e){this._inert||(this._sync=!0)}async setDesync(e){this._inert||(this._sync=!1)}captureRoleState(){}setRoleState(e){}}class fi extends si.a{static create(){return new fi}constructor(){super(),this._global=null}registerGlobal(e){this._global||(this._global=e.createGlobal(this,oi.a.protocolName,1,(e,t,i)=>{this.bindClient(e,t,i)}))}unregisterGlobal(){this._global&&(this._global.destroy(),this._global=null)}bindClient(e,t,i){new oi.a(e,t,i).implementation=this}getSubsurface(e,t,i,n){const s=i.implementation;if(s.role)return void e.postError(oi.a.Error.badSurface,"Given surface has another role.");const r=new ci.a(e.client,t,e.version);hi.create(n,i,r);const o=e=>{e.onDestroy().then(()=>{e.detach()})};n.implementation.addSubsurface(s.surfaceChildSelf).forEach(o),s.onViewCreated=o}}i(67);var di=i(49),pi=i.n(di),mi=i(5),_i=i.n(mi),gi=i(9),yi=i.n(gi),wi=i(51),bi=i.n(wi),vi=i(52),xi=i.n(vi),Si=i(16),Ti=i.n(Si),Ei=i(20),Ri=i.n(Ei),Ci=i(53),Ai=i.n(Ci);const{none:Di,bottom:Oi,bottomLeft:Mi,bottomRight:ki,left:Pi,right:Ii,top:Li,topLeft:Bi,topRight:Fi}=Ti.a.ResizeEdge,{fullscreen:zi,activated:Ui,maximized:Ni,resizing:ji}=Ti.a.State;class Gi extends Ai.a{static create(e,t,i,n){const s=t.wlSurfaceResource.implementation,r=n.manage(s),o=new Gi(e,t,i,r);return e.implementation=o,s.role=o,e.onDestroy().then(()=>{o.userShellSurface&&o.userShellSurface.destroy()}),r.onActivationRequest=(()=>{if(!o._activationRequested&&(o._activationRequested=!0,!o._configureState.state.includes(Ui))){const t=o._configureState.state.slice();t.push(Ui),o._emitConfigure(e,o._configureState.width,o._configureState.height,t,Di)}}),r.onInactive=(()=>{if(o._configureState.state.includes(Ui)){const t=o._configureState.state.slice(),i=t.indexOf(Ui);t.splice(i,1),o._emitConfigure(e,o._configureState.width,o._configureState.height,t,Di)}}),o}constructor(e,t,i,n){super(),this.resource=e,this.xdgSurface=t,this._session=i,this.userShellSurface=n,this._parent=null,this._title="",this._appId="",this._pendingMaxSize=x.a.create(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER),this._maxSize=x.a.create(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER),this._pendingMinSize=x.a.create(0,0),this._minSize=x.a.create(0,0),this._pendingConfigureStates=[],this._unfullscreenConfigureState=null,this._ackedConfigureState={serial:0,state:[],width:0,height:0,resizeEdge:0},this._configureState={serial:0,state:[],width:0,height:0,resizeEdge:0},this._previousGeometry=null,this.mapped=!1,this._activationRequested=!1}captureRoleState(){return{windowGeometry:this.xdgSurface.pendingWindowGeometry,maxSize:this._pendingMaxSize,minSize:this._pendingMinSize,configureState:this._ackedConfigureState}}setRoleState(e){this._minSize=e.minSize,this._maxSize=e.maxSize;const{x:t,y:i}=e.minSize;let{x:n,y:s}=e.maxSize;n=0===n?Number.MAX_SAFE_INTEGER:n,s=0===s?Number.MAX_SAFE_INTEGER:s,t<0||i<0||t>n||i>s?this.resource.postError(_i.a.Error.invalidSurfaceState,"Min size can not be greater than max size."):n<0||s<0||n<t||s<i?this.resource.postError(_i.a.Error.invalidSurfaceState,"Max size can not be me smaller than min size."):(this._minSize=x.a.create(t,i),this._maxSize=x.a.create(n,s),this._configureState=e.configureState,this.xdgSurface.updateWindowGeometry(e.windowGeometry),this._activationRequested&&this._configureState.state.includes(Ui)&&(this._activationRequested=!1,this.userShellSurface.activationAck()))}async onCommit(e,t,i){i.bufferContents?(this.mapped||this._map(e),i.roleState.configureState.state.includes(ji)?this._resizingCommit(e,t,i):i.roleState.configureState.state.includes(Ni)?this._maximizedCommit(e,t,i):i.roleState.configureState.state.includes(zi)?this._fullscreenCommit(e,t,i):this._normalCommit(e,t,i)):this.mapped&&this._unmap(),await e.render(t,i),t.fire(),await t,this._session.flush()}_map(e){this.mapped=!0,this.userShellSurface.mapped=!0}_unmap(){this.mapped=!1,this._configureState={serial:0,state:[],width:0,height:0,resizeEdge:0},this.userShellSurface.mapped=!1}_resizingCommit(e,t,i){const n=i.roleState,{w:s,h:r}=n.windowGeometry.size,{w:o,h:a}=this.xdgSurface.windowGeometry.size;let c=0,l=0;switch(this._configureState.resizeEdge){case Fi:case Li:l=a-r;break;case Mi:case Pi:c=o-s;break;case Bi:c=o-s,l=a-r}if(c||l){const{x:i,y:n}=e.surfaceChildSelf.position;e.surfaceChildSelf.position=x.a.create(i+c,n+l),e.views.forEach(e=>{e.applyTransformations(t)})}}_maximizedCommit(e,t,i){const n=i.roleState,{w:s,h:r}=n.windowGeometry.size;if(s!==n.configureState.width||r!==n.configureState.height)return void this.resource.postError(_i.a.Error.invalidSurfaceState,"Surface size does not match configure event.");this._previousGeometry||this._storePreviousGeometry(),this._unfullscreenConfigureState&&(this._unfullscreenConfigureState=null);const{y:o}=document.getElementById("workspace").getBoundingClientRect(),a=i.roleState.windowGeometry.position,c=e.views.find(e=>e.primary),l=c.toViewSpaceFromSurface(a);c.customTransformation=T.translation(0-l.x,o-l.y),c.applyTransformations(t)}_fullscreenCommit(e,t,i){const n=i.bufferContents.size,{x:s,y:r}=e.toSurfaceSpace(x.a.create(n.w,n.h));if(s>this._configureState.width||r>this._configureState.height)return void this.resource.postError(_i.a.Error.invalidSurfaceState,"Surface size does not match configure event.");this._unfullscreenConfigureState||(this._unfullscreenConfigureState=this._configureState),this._previousGeometry||this._storePreviousGeometry();const o=(window.innerWidth-s)/2,a=(window.innerHeight-r)/2;e.surfaceChildSelf.position=x.a.create(o,a),e.views.forEach(e=>{e.applyTransformations(t)})}_normalCommit(e,t,i){if(this._previousGeometry){const i=e.views.find(e=>e.primary);i.customTransformation=null,i.applyTransformations(t),this._previousGeometry=null}this._unfullscreenConfigureState&&(this._unfullscreenConfigureState=null)}ackConfigure(e){this._pendingConfigureStates=this._pendingConfigureStates.filter(t=>!(t.serial<e)&&(t.serial!==e||(this._ackedConfigureState=t,!1)))}_storePreviousGeometry(){this._previousGeometry=this.xdgSurface.windowGeometry}destroy(e){this._unmap(),e.destroy()}setParent(e,t){if(this._parent){const e=this._parent.implementation.xdgSurface.wlSurfaceResource.implementation,t=this.xdgSurface.wlSurfaceResource.implementation;e.removeChild(t.surfaceChildSelf)}if(t){const e=t.implementation.xdgSurface.wlSurfaceResource.implementation,i=this.xdgSurface.wlSurfaceResource.implementation;e.addToplevelChild(i.surfaceChildSelf)}this._parent=t}setTitle(e,t){this._title=t,this.userShellSurface.title=t}setAppId(e,t){this._appId=t,this.userShellSurface.appId=t}showWindowMenu(e,t,i,n,s){t.implementation.isValidInputSerial(i)&&this._showWindowMenuAt(x.a.create(n,s))}_showWindowMenuAt(e){}move(e,t,i){if(this._configureState.state.includes(zi)||this._configureState.state.includes(Ni))return;const n=t.implementation;if(!n.isValidInputSerial(i))return;const s=n.pointer,r=this.xdgSurface.wlSurfaceResource.implementation,o=r.surfaceChildSelf,a=o.position,c=s.x,l=s.y,u=()=>{if(!this.mapped)return void s.removeMouseMoveListener(u);const e=s.x-c,t=s.y-l;o.position=x.a.create(a.x+e,a.y+t);const i=Z.createRenderFrame();r.views.forEach(e=>{e.applyTransformations(i)}),i.fire()};s.onButtonRelease().then(()=>{r.hasPointerInput=!0,s.removeMouseMoveListener(u),s.setDefaultCursor()}),r.hasPointerInput=!1,s.unsetFocus(),s.addMouseMoveListener(u),window.document.body.style.cursor="move"}resize(e,t,i,n){if(this._configureState.state.includes(zi)||this._configureState.state.includes(Ni))return;const s=t.implementation,r=s.pointer;if(!s.isValidInputSerial(i))return;let o=null;switch(n){case ki:window.document.body.style.cursor="nwse-resize",o=((e,t,i,n)=>({w:e+i,h:t+n}));break;case Li:window.document.body.style.cursor="ns-resize",o=((e,t,i,n)=>({w:e,h:t-n}));break;case Oi:window.document.body.style.cursor="ns-resize",o=((e,t,i,n)=>({w:e,h:t+n}));break;case Pi:window.document.body.style.cursor="ew-resize",o=((e,t,i,n)=>({w:e-i,h:t}));break;case Bi:window.document.body.style.cursor="nwse-resize",o=((e,t,i,n)=>({w:e-i,h:t-n}));break;case Mi:window.document.body.style.cursor="nesw-resize",o=((e,t,i,n)=>({w:e-i,h:t+n}));break;case Ii:window.document.body.style.cursor="ew-resize",o=((e,t,i,n)=>({w:e+i,h:t}));break;case Fi:window.document.body.style.cursor="nesw-resize",o=((e,t,i,n)=>({w:e+i,h:t-n}));break;case Di:default:r.setDefaultCursor(),o=((e,t,i,n)=>({w:e,h:t}))}const a=r.x,c=r.y,{width:l,height:u}=this.xdgSurface.windowGeometry,h=()=>{const e=r.x-a,t=r.y-c,i=o(l,u,e,t),n=Math.max(this._minSize.x,Math.min(i.w,this._maxSize.x)),s=Math.max(this._minSize.y,Math.min(i.h,this._maxSize.y));return E.a.create(n,s)},f=()=>{if(!this.mapped)return void r.removeMouseMoveListener(f);const{w:t,h:i}=h();this._emitConfigure(e,t,i,[Ui,ji],n),this._session.flush()},d=this.xdgSurface.wlSurfaceResource.implementation;r.onButtonRelease().then(()=>{d.hasPointerInput=!0,r.removeMouseMoveListener(f),r.setDefaultCursor();const{w:t,h:i}=h();this._emitConfigure(e,t,i,[Ui],Di),this._session.flush()}),d.hasPointerInput=!1,r.unsetFocus(),r.addMouseMoveListener(f)}_emitConfigure(e,t,i,n,s){e.configure(t,i,Uint32Array.from(n)),this.xdgSurface.emitConfigureDone(),this._pendingConfigureStates.push({serial:this.xdgSurface.configureSerial,state:n,width:t,height:i,resizeEdge:s})}setMaxSize(e,t,i){this._pendingMaxSize=x.a.create(t,i)}setMinSize(e,t,i){this._pendingMinSize=x.a.create(t,i)}setMaximized(e){if(this._configureState.state.includes(ji))return;const{width:t,height:i}=document.getElementById("workspace").getBoundingClientRect(),n=Math.round(t),s=Math.round(i);this._configureState.state.includes(zi)?this._unfullscreenConfigureState={state:[Ni,Ui],width:n,height:s}:this._emitConfigure(e,n,s,[Ni,Ui],Di)}unsetMaximized(e){this._configureState.state.includes(ji)||(this._configureState.state.includes(zi)&&this._previousGeometry?this._unfullscreenConfigureState={state:[Ui],width:this._previousGeometry.width,height:this._previousGeometry.height}:this._configureState.state.includes(Ni)&&this._previousGeometry?this._emitConfigure(e,this._previousGeometry.width,this._previousGeometry.height,[Ui],Di):this._emitConfigure(e,0,0,[Ui],Di))}setFullscreen(e,t){this._emitConfigure(e,window.innerWidth,window.innerHeight,[zi,Ui],Di)}unsetFullscreen(e){this._configureState.state.includes(zi)&&(this._unfullscreenConfigureState?this._emitConfigure(e,this._unfullscreenConfigureState.width,this._unfullscreenConfigureState.height,this._unfullscreenConfigureState.state,Di):this._previousGeometry?this._emitConfigure(e,this._previousGeometry.width,this._previousGeometry.height,[Ui],Di):this._emitConfigure(e,0,0,[Ui],Di))}setMinimized(e){this.userShellSurface.minimize()}}var Wi=i(54),Vi=i.n(Wi);const{none:Ki,slideX:Xi,slideY:qi,flipX:Hi,flipY:$i,resizeX:Yi,resizeY:Zi}=yi.a.ConstraintAdjustment,Qi={0:0,1:2,2:1,3:3,4:4,5:6,6:5,7:8,8:7},Ji={0:0,1:1,2:2,3:4,4:3,5:7,6:8,7:5,8:6};class en extends Vi.a{static create(e,t,i,n,s,r){const o=new en(e,t,i,n,s,r);return e.implementation=o,t.wlSurfaceResource.implementation.role=o,o.ensureGeometryConstraints(i,n),t.emitConfigureDone(),o}constructor(e,t,i,n,s,r){super(),this.resource=e,this.xdgSurface=t,this.parent=i,this.positionerState=n,this.mapped=!1,this.dismissed=!1,this._session=s,this._seat=r}captureRoleState(){return{windowGeometry:this.xdgSurface.pendingWindowGeometry}}setRoleState(e){this.xdgSurface.updateWindowGeometry(e.windowGeometry)}async onCommit(e,t,i){this.dismissed||(i.bufferContents?this.mapped||this._map(e,i):this.mapped&&this._dismiss(),await e.render(t,i),t.fire(),await t,this._session.flush())}_map(e,t){for(const t of e.children)if(t!==e.surfaceChildSelf&&t.surface.role instanceof en)return void this.resource.postError(_i.a.Error.notTheTopmostPopup,"Client tried to map a non-topmost popup");this.mapped=!0;const i=this.parent.implementation,n=i.wlSurfaceResource.implementation;e.surfaceChildSelf.position=this.positionerState.surfaceSpaceAnchorPoint(i).minus(t.roleState.windowGeometry.position),n.addChild(e.surfaceChildSelf)}_dismiss(){if(!this.dismissed){if(this.dismissed=!0,this._seat.pointer){const e=this._seat.pointer.findPopupGrab(this.xdgSurface.wlSurfaceResource);e&&e.resolve()}this.resource.popupDone();const e=this.parent.implementation.wlSurfaceResource.implementation,t=this.xdgSurface.wlSurfaceResource.implementation;e.removeChild(t.surfaceChildSelf),this._seat.keyboard.focusGained(e)}}_updatePopupKeyboardFocus(){this._seat.keyboard.focusGained(this.xdgSurface.wlSurfaceResource.implementation),this._seat.keyboard.onKeyboardFocusChanged().then(()=>{this._seat.keyboard.focus&&this._seat.keyboard.focus.resource.client===this.resource.client||this._dismiss()})}destroy(e){const t=this.xdgSurface.wlSurfaceResource.implementation;for(const i of t.children)if(i!==t.surfaceChildSelf&&i.surface.role instanceof en)return void e.postError(_i.a.Error.notTheTopmostPopup,"Client tried to destroy a non-topmost popup");this._dismiss(),e.destroy()}async grab(e,t,i){const n=t.implementation,s=n.pointer;if(!n.isValidInputSerial(n.buttonPressSerial))return void this._dismiss();if(this.mapped)return void e.postError(Ri.a.Error.invalidGrab,"Client tried to grab popup after it being mapped.");const r=this.parent.implementation.wlSurfaceResource,o=r.implementation.role;if(o instanceof en){if(o.dismissed)return void this._dismiss();if(!s.findPopupGrab(r))return void e.postError(_i.a.Error.invalidPopupParent,"Popup parent is a popup that did not take an explicit grab.")}this._updatePopupKeyboardFocus(),s.popupGrab(this.xdgSurface.wlSurfaceResource).then(()=>this._dismiss())}ackConfigure(e){}ensureGeometryConstraints(e,t){if(t.constraintAdjustment===Ki)return;const i=e.implementation,n=i.wlSurfaceResource.implementation.views.find(e=>e.primary);let s=t.checkScreenConstraints(i,n);if(!(s.topViolation||s.rightViolation||s.bottomViolation||s.leftViolation))return;const r=0!=(t.constraintAdjustment|Hi),o=0!=(t.constraintAdjustment|$i),a=0!=(t.constraintAdjustment|Xi),c=0!=(t.constraintAdjustment|qi),l=0!=(t.constraintAdjustment|Yi),u=0!=(t.constraintAdjustment|Zi);if((s.leftViolation||s.rightViolation)&&t.size.width<window.document.body.clientWidth){if(r){const e=t.anchor,r=t.gravity;t.anchor=Ji[e],t.gravity=Ji[r],((s=t.checkScreenConstraints(i,n)).leftViolation||s.rightViolation)&&(t.anchor=e,t.gravity=r)}if(((s=t.checkScreenConstraints(i,n)).leftViolation||s.rightViolation)&&a){const e=s.rightViolation?-s.rightViolation:s.leftViolation,i=t.offset;t.offset=x.a.create(i.x+e,i.y)}}if(((s=t.checkScreenConstraints(i,n)).leftViolation||s.rightViolation)&&l){if(s.leftViolation){const e=t.offset;t.offset=x.a.create(e.x+s.leftViolation,e.y),t.size.x1=t.size.x1-s.leftViolation}s.rightViolation&&(t.size.x1=t.size.x1-s.rightViolation)}if(((s=t.checkScreenConstraints(i,n)).topViolation||s.bottomViolation)&&t.size.height<window.document.body.clientHeight){if(o){const e=t.anchor,r=t.gravity;t.anchor=Qi[e],t.gravity=Qi[r],((s=t.checkScreenConstraints(i,n)).topViolation||s.bottomViolation)&&(t.anchor=e,t.gravity=r)}if(((s=t.checkScreenConstraints(i,n)).topViolation||s.bottomViolation)&&c){const e=s.bottomViolation?-s.bottomViolation:s.topViolation,i=t.offset;t.offset=x.a.create(i.x,i.y+e)}}if(((s=t.checkScreenConstraints(i,n)).topViolation||s.bottomViolation)&&u){if(s.topViolation){const e=t.offset;t.offset=x.a.create(e.x,e.y+s.topViolation),t.size.y1=t.size.y1-s.topViolation}s.bottomViolation&&(t.size.y1=t.size.y1-s.bottomViolation)}const{x0:h,y0:f,width:d,height:p}=t.size;this.resource.configure(h,f,d,p)}}class tn extends xi.a{static create(e,t,i,n,s){const r=new tn(e,t,i,n,s);e.implementation=r;const o=t.implementation;return o.hasKeyboardInput=!0,o.hasPointerInput=!0,o.hasTouchInput=!0,r}constructor(e,t,i,n,s){super(),this.xdgSurfaceResource=e,this.wlSurfaceResource=t,this._session=i,this._userShell=n,this._seat=s,this.pendingWindowGeometry=S.a.create(Number.MIN_SAFE_INTEGER,Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER),this.configureSerial=0,this.windowGeometry=S.a.create(0,0,0,0)}destroy(e){e.destroy()}getToplevel(e,t){if(this.wlSurfaceResource.implementation.role)return void e.postError(_i.a.Error.role,"Given surface has another role.");const i=new Ti.a(e.client,t,e.version),n=Gi.create(i,this,this._session,this._userShell);i.implementation=n,this.ackConfigure=((e,t)=>n.ackConfigure(t))}getPopup(e,t,i,n){const s=this.wlSurfaceResource.implementation;if(s.role)return void e.postError(_i.a.Error.role,"Given surface has another role.");const r=n.implementation;if(null===r.size)return void e.postError(_i.a.Error.invalidPositioner,"Client provided an invalid positioner. Size is NULL.");if(null===r.anchorRect)return void e.postError(_i.a.Error.invalidPositioner,"Client provided an invalid positioner. AnchorRect is NULL.");const o=r.createStateCopy(),a=new Ri.a(e.client,t,e.version),c=en.create(a,this,i,o,this._session,this._seat);this.ackConfigure=((e,t)=>{c.ackConfigure(t)});const l=e=>{const t=Z.createRenderFrame();e.applyTransformations(t),t.fire(),e.onDestroy().then(()=>{e.detach()})};if(i){i.implementation.wlSurfaceResource.implementation.addChild(s.surfaceChildSelf).forEach(l)}else{l(s.createView())}s.onViewCreated=l}setWindowGeometry(e,t,i,n,s){n<=0||s<=0?e.postError(_i.a.Error.invalidSurfaceState,"Client provided negative window geometry."):this.pendingWindowGeometry=S.a.create(t,i,t+n,i+s)}updateWindowGeometry(e){this.windowGeometry=this._createBoundingRectangle().intersect(e)}_createBoundingRectangle(){const e=[0],t=[0],i=this.wlSurfaceResource.implementation,n=i.size;e.push(n.w),t.push(n.h),i.subsurfaceChildren.forEach(i=>{const n=i.position,s=i.surface.size;e.push(n.x),t.push(n.y),e.push(n.x+s.w),t.push(n.y+s.h)});const s=Math.min(...e),r=Math.max(...e),o=Math.min(...t),a=Math.max(...t);return S.a.create(s,o,r,a)}ackConfigure(e,t){}emitConfigureDone(){this.xdgSurfaceResource.configure(++this.configureSerial)}}var nn=i(50),sn=i.n(nn);const rn={0:e=>{const t=Math.round((e.x0+e.width)/2),i=Math.round((e.y0+e.height)/2);return x.a.create(t,i)},1:e=>{const t=Math.round((e.x0+e.width)/2),i=e.y0;return x.a.create(t,i)},2:e=>{const t=Math.round((e.x0+e.width)/2),i=e.y1;return x.a.create(t,i)},3:e=>{const t=e.x0,i=Math.round((e.y0+e.height)/2);return x.a.create(t,i)},4:e=>{const t=e.x1,i=Math.round((e.y0+e.height)/2);return x.a.create(t,i)},5:e=>{const t=e.x0,i=e.y0;return x.a.create(t,i)},6:e=>{const t=e.x0,i=e.y1;return x.a.create(t,i)},7:e=>{const t=e.x1,i=e.y0;return x.a.create(t,i)},8:e=>{const t=e.x1,i=e.y1;return x.a.create(t,i)}},on={0:(e,t,i)=>{const n=Math.round(i.x0+i.width/2),s=Math.round(i.y0+i.height/2);return e.minus(x.a.create(n,s))},1:(e,t,i)=>{const n=Math.round(i.x0+i.width/2),s=i.y1;return e.minus(x.a.create(n,s)).minus(x.a.create(0,t.y))},2:(e,t,i)=>{const n=Math.round(i.x0+i.width/2),s=i.y0;return e.minus(x.a.create(n,s)).plus(x.a.create(0,t.y))},3:(e,t,i)=>{const n=i.x1,s=Math.round(i.y0+i.height/2);return e.minus(x.a.create(n,s)).minus(x.a.create(t.x,0))},4:(e,t,i)=>{const n=i.x0,s=Math.round(i.y0+i.height/2);return e.minus(x.a.create(n,s)).plus(x.a.create(t.x,0))},5:(e,t,i)=>{const n=i.x1,s=i.y1;return e.minus(x.a.create(n,s)).minus(t)},6:(e,t,i)=>{const n=i.x1,s=i.y0;return e.minus(x.a.create(n,s)).plus(x.a.create(-t.x,t.y))},7:(e,t,i)=>{const n=i.x0,s=i.y1;return e.minus(x.a.create(n,s)).plus(x.a.create(t.x,-t.y))},8:(e,t,i)=>{const n=i.x0,s=i.y0;return e.minus(x.a.create(n,s)).plus(x.a.create(t.x,t.y))}};class an extends sn.a{static create(e){const t=new an;return e.implementation=t,t}constructor(){super(),this.size=null,this.anchorRect=null,this.anchor=0,this.gravity=0,this.constraintAdjustment=0,this.offset=x.a.create(0,0)}destroy(e){e.destroy()}setSize(e,t,i){t<=0||i<=0?e.postError(yi.a.Error.invalidInput,"Size width or height of positioner can not be negative."):this.size=S.a.create(0,0,t,i)}setAnchorRect(e,t,i,n,s){n<=0||s<=0?e.postError(yi.a.Error.invalidInput,"Anchor rect width or height of positioner can not be negative."):this.anchorRect=S.a.create(t,i,t+n,i+s)}setAnchor(e,t){this.anchor=t}setGravity(e,t){this.gravity=t}setConstraintAdjustment(e,t){this.constraintAdjustment=t}setOffset(e,t,i){this.offset=x.a.create(t,i)}createStateCopy(){return{size:this.size,anchorRect:this.anchorRect,anchor:this.anchor,gravity:this.gravity,constraintAdjustment:this.constraintAdjustment,offset:this.offset,surfaceSpaceAnchorPoint:function(e){const t=e.windowGeometry.position.plus(this.anchorRect.position),{x:i,y:n}=t,s=S.a.create(i,n,i+this.anchorRect.width,n+this.anchorRect.height),r=rn[this.anchor](s);return on[this.gravity](r,this.offset,this.size)},checkScreenConstraints:function(e,t){const i=this.surfaceSpaceAnchorPoint(e),n=i.plus(this.size.position),s=i.plus(x.a.create(this.size.x1,this.size.y1)),r=t.toSurfaceSpace(x.a.create(0,0)),o=t.toSurfaceSpace(x.a.create(window.document.body.clientWidth,window.document.body.clientHeight));let a=0,c=0,l=0,u=0;return n.x<r.x&&(u=Math.abs(r.x-n.x)),n.y<r.y&&(a=Math.abs(r.y-n.y)),s.x>o.x&&(c=s.x-o.x),s.y>o.y&&(l=s.y-o.y),{topViolation:a,rightViolation:c,bottomViolation:l,leftViolation:u}}}}}class cn extends pi.a{static create(e,t,i){return new cn(e,t,i)}constructor(e,t,i){super(),this._session=e,this._userShell=t,this._seat=i,this._wlSurfaceResources=[],this._global=null,this._clientPingStates=new Map}registerGlobal(e){this._global||(this._global=e.createGlobal(this,_i.a.protocolName,1,(e,t,i)=>{this.bindClient(e,t,i)}))}unregisterGlobal(){this._global&&(this._global.destroy(),this._global=null)}bindClient(e,t,i){const n=new _i.a(e,t,i);if(n.implementation=this,!this._clientPingStates.has(e)){e.onClose().then(()=>{const t=this._clientPingStates.get(e);window.clearTimeout(t.timeoutTimer),window.clearTimeout(t.pingTimer),this._clientPingStates.delete(e)});const t={timeoutTimer:0,pingTimer:0,pingTimeoutActive:!1};this._clientPingStates.set(e,t),this._doPing(n,t)}}destroy(e){this._wlSurfaceResources.length>0?e.postError(_i.a.Error.defunctSurfaces,"xdg_wm_base was destroyed before children."):e.destroy()}createPositioner(e,t){const i=new yi.a(e.client,t,e.version);an.create(i)}getXdgSurface(e,t,i){const n=i.implementation;if(n.pendingWlBuffer||n.state.bufferContents)return void e.postError(cn.Error.invalidSurfaceState,"Surface had a buffer attached before xdg surface was created.");const s=new bi.a(e.client,t,e.version);tn.create(s,i,this._session,this._userShell,this._seat),this._wlSurfaceResources.push(i),i.onDestroy().then(()=>{const e=this._wlSurfaceResources.indexOf(i);e>-1&&this._wlSurfaceResources.splice(e,1)})}pong(e,t){const i=this._clientPingStates.get(e.client);i.pingTimeoutActive&&(this._setUnresponsive(e.client,!1),i.pingTimeoutActive=!1),window.clearTimeout(i.timeoutTimer),i.pingTimer=window.setTimeout(()=>{this._doPing(e,i)},5e3)}_doPing(e,t){t.timeoutTimer=window.setTimeout(()=>{t.pingTimeoutActive||(t.pingTimeoutActive=!0,this._setUnresponsive(e.client,!0))},5e3),e.ping(0),this._session.flush()}_setUnresponsive(e,t){this._wlSurfaceResources.filter(t=>t.client===e).forEach(e=>{const i=e.implementation.role;i instanceof Gi&&(i.userShellSurface.unresponsive=t)})}}class ln{set title(e){}set appId(e){}set mapped(e){}set unresponsive(e){}set onActivationRequest(e){}set onInactive(e){}activationAck(){}destroy(){}minimize(){}}class un extends ln{static create(e,t){const i=e.createView();this._detachViewOnDestroy(i),i.attachTo(document.body);const n=document.createElement("div");n.style.display="none",n.classList.add("entry"),this._detachEntryOnDestroy(i,n);const s=new un(i,n,t);s._activateOnPointerButton(),n.addEventListener("mousedown",()=>s._activeCallback()),e.resource.onDestroy().then(()=>s.destroy()),un.desktopUserShellSurfaces.push(s);const r=e=>{s.mainView.surface.resource.client===e.client&&(s.wlKeyboardResource=e)};return t.addKeyboardResourceListener(r),s.mainView.onDestroy().then(()=>t.removeKeyboardResourceListener(r)),t.keyboard.resources.forEach(r),s}static _removeClassRecursively(e,t){e.views.forEach(e=>{e.bufferedCanvas.removeCssClass(t)}),e.children.forEach(i=>{i.surface!==e&&this._removeClassRecursively(i.surface,t)})}static _addClassRecursively(e,t){e.views.forEach(e=>{e.bufferedCanvas.addCssClass(t)}),e.children.forEach(i=>{i.surface!==e&&this._addClassRecursively(i.surface,t)})}static _detachEntryOnDestroy(e,t){e.onDestroy().then(()=>{t.parentElement&&t.parentElement.removeChild(t)})}static _detachViewOnDestroy(e){e.onDestroy().then(()=>e.detach())}constructor(e,t,i){super(),this.mainView=e,this.divElement=t,this._activeCallback=null,this._inactivateCallback=(()=>{}),this._wlKeyboardResource=null,this.active=!1,this._seat=i}_activateOnPointerButton(){this._seat.pointer.onButtonPress().then(()=>{this.mainView.destroyed||(!this.active&&this._seat.pointer.focus&&this._seat.pointer.focus.surface===this.mainView.surface&&this._activeCallback(),this._activateOnPointerButton())})}activationAck(){this.mainView.destroyed||this.active||(this.active=!0,this.mainView.show(),this.mainView.raise(),this.divElement.classList.add("entry-focus"),this._wlKeyboardResource&&this._giveKeyboardFocus(),un.desktopUserShellSurfaces.forEach(e=>{e!==this&&e._deactivate()}))}set wlKeyboardResource(e){this.mainView.destroyed||(this._wlKeyboardResource=e,this._wlKeyboardResource.onDestroy().then(()=>this._wlKeyboardResource=null),this.active&&this._wlKeyboardResource&&this._wlKeyboardResource.implementation.focus!==this.mainView.surface&&this._giveKeyboardFocus())}_giveKeyboardFocus(){this._wlKeyboardResource.implementation.focusGained(this.mainView.surface)}_deactivate(){this.active&&(this.active=!1,this.divElement.classList.remove("entry-focus"),this._inactivateCallback())}set mapped(e){e?(this.divElement.style.display="inline",this.divElement.classList.remove("entry-removed")):(this.divElement.addEventListener("transitionend",()=>{this.divElement.style.display="none"}),this.divElement.classList.add("entry-removed"))}set onActivationRequest(e){this._activeCallback=e,this.active||this._activeCallback()}set onInactive(e){this._inactivateCallback=e}set appId(e){}set title(e){this.divElement.textContent=e}minimize(){this.mainView.destroyed||this.mainView.hide()}destroy(){const e=un.desktopUserShellSurfaces.indexOf(this);e>-1&&un.desktopUserShellSurfaces.splice(e,1)}set unresponsive(e){e?un._addClassRecursively(this.mainView.surface,"fadeToUnresponsive"):un._removeClassRecursively(this.mainView.surface,"fadeToUnresponsive")}}un.desktopUserShellSurfaces=[];var hn=un;i(70);class fn{static create(e,t){const i=document.body,n=document.getElementById("workspace"),s=document.createElement("div");s.classList.add("hpanel"),i.insertAdjacentElement("afterbegin",s);const r=document.createElement("div");return r.classList.add("entry-container"),s.appendChild(r),new fn(i,n,s,r,t)}constructor(e,t,i,n,s){this.body=e,this.workspace=t,this.panel=i,this.entryContainer=n,this._seat=s}manage(e){const t=hn.create(e,this._seat);return this.entryContainer.appendChild(t.divElement),t}}var dn=i(61),pn=i(55),mn=i.n(pn),_n=i(26),gn=i.n(_n),yn=i(57),wn=i.n(yn),bn=i(56),vn=i.n(bn),xn=i(12);class Sn extends xn.a{static create(e,t){return new Sn(e,t)}constructor(e,t){super(),this._size=E.a.create(e,t),this._pixelContent=new ImageData(new Uint8ClampedArray(new ArrayBuffer(e*t*4)),e,t)}get size(){return this._size}get pixelContent(){return this._pixelContent}get mimeType(){return"image/rgba"}get serial(){return 0}async attach(e){const t=await e.getTransferable();this._pixelContent=new ImageData(new Uint8ClampedArray(t),this._size.w,this._size.h)}}class Tn extends vn.a{static async create(e,t,i,n){const s=Sn.create(i,n),r=new Tn(e,t,s);return e.implementation=r,r}constructor(e,t,i){super(),this.resource=e,this.bufferResource=t,this._pixelContent=null,this._webShmFrame=i}destroy(e){e.destroy()}async attach(e,t){this._pixelContent=t,await this._webShmFrame.attach(t)}async getContents(e){return Promise.resolve(this._webShmFrame)}release(){this.resource.detach(this._pixelContent),this.bufferResource.release()}}var En=i(11),Rn=i.n(En);class Cn extends mn.a{static create(){return new Cn}constructor(){super(),this._global=null,this._resources=[]}registerGlobal(e){this._global||(this._global=e.createGlobal(this,gn.a.protocolName,1,(e,t,i)=>{this.bindClient(e,t,i)}))}bindClient(e,t,i){const n=new gn.a(e,t,i);n.implementation=this,this._resources.push(n)}async createBuffer(e,t,i,n,s){const r=new Rn.a(e.client,t,e.version),o=await Tn.create(i,r,n,s);r.implementation=o,i.implementation=o}createWebArrayBuffer(e,t){new wn.a(e.client,t,e.version).implementation={attach:()=>{throw new Error("web shm buffer not wrapped.")}}}}class An{static create(e){return new An(e)}constructor(e){this._session=e}onWebAppWorker(e){const t=this._session.display.createClient(t=>e.postMessage(t,[t]));e.onmessage=(e=>{const i=e.data;if(i.protocolMessage instanceof ArrayBuffer){const e=new Uint32Array(i.protocolMessage),n=i.meta.map(e=>{if(e instanceof ArrayBuffer)return this._session.webFS.fromArrayBuffer(e);if(e instanceof ImageBitmap)return this._session.webFS.fromImageBitmap(e);throw new Error(`Unsupported transferable: ${e}`)});t.connection.message({buffer:e,fds:n}),n.forEach(e=>e.close())}else console.error("[web-worker-connection] client send an illegal message object. Expected ArrayBuffer."),t.close()});const i=[];t.connection.onFlush=(async t=>{if(i.push(t),!(i.length>1))for(;i.length;){const t=i[0],n=t.reduce((e,t)=>e+t.buffer.byteLength,0),s=new Uint32Array(new ArrayBuffer(n));let r=0;const o=[];for(const e of t){for(const t of e.fds){const e=await t.getTransferable();o.push(e),t.close()}const t=new Uint32Array(e.buffer);s.set(t,r),r+=t.length}e.postMessage({protocolMessage:s.buffer,meta:o},[s.buffer].concat(o)),i.shift()}})}}class Dn{static create(e){return new Dn(e)}constructor(e){this._webAppSocket=e,this.webAppWorkers={},this._nextWebAppId=1}launch(e){const t=new Worker(e),i=this._nextWebAppId++;return this.webAppWorkers[i]=t,this._webAppSocket.onWebAppWorker(t),i}terminate(e){this.webAppWorkers[e].terminate(),delete this.webAppWorkers[e]}}var On=i(58),Mn=i.n(On),kn=i(27),Pn=i.n(kn),In=i(60),Ln=i.n(In),Bn=i(59),Fn=i.n(Bn);class zn extends xn.a{static create(){return new zn}constructor(){super(),this._size=E.a.create(0,0),this._imageBitmap=null}update(e){this._imageBitmap=e,this._size=E.a.create(e.width,e.height)}get mimeType(){return"image/bitmap"}get pixelContent(){return this._imageBitmap}get serial(){return 0}get size(){return this._size}}class Un extends Fn.a{static create(e,t){const i=zn.create();return new Un(e,t,i)}constructor(e,t,i){super(),this.resource=e,this.bufferResource=t,this._webGLFrame=i}async transfer(e,t){const i=await t.getTransferable();this._webGLFrame.update(i)}destroy(e){this.resource.destroy(),this.bufferResource.destroy()}async getContents(e){return this._webGLFrame}release(){this.bufferResource.release()}}class Nn extends Mn.a{static create(){return new Nn}constructor(){super(),this._global=null,this._resources=[]}registerGlobal(e){this._global||(this._global=e.createGlobal(this,Pn.a.protocolName,1,(e,t,i)=>{this.bindClient(e,t,i)}))}bindClient(e,t,i){const n=new Pn.a(e,t,i);n.implementation=this,this._resources.push(n)}createBuffer(e,t,i){const n=new Rn.a(e.client,t,e.version),s=Un.create(i,n);i.implementation=s,n.implementation=s}createWebGlBuffer(e,t){new Ln.a(e.client,t,e.version).implementation={transfer:()=>{throw new Error("web gl buffer not wrapped.")}}}}function jn(){window.onbeforeunload=(e=>{return e.returnValue="",""});try{!async function(e){const t=ii.create(),i=Gt.create(e),n=fe.create(e,i),s=Jt.create(),r=fi.create(),o=fn.create(e,i),a=Ie.create(e,o),c=cn.create(e,o,i),l=Cn.create(),u=Nn.create();t.registerGlobal(e.display.registry),n.registerGlobal(e.display.registry),s.registerGlobal(e.display.registry),i.registerGlobal(e.display.registry),a.registerGlobal(e.display.registry),r.registerGlobal(e.display.registry),c.registerGlobal(e.display.registry),l.registerGlobal(e.display.registry),u.registerGlobal(e.display.registry),dn.a.create(e);const h=An.create(e),f=Dn.create(h);f.launch("clients/simple.web.shm.js"),f.launch("clients/simple.web.gl.js")}(o.create())}catch(e){console.error("Failed to setup compositor session.",e)}}function Gn(e){return new Promise(t=>{e.calledRun?t():e.onRuntimeInitialized=(()=>{t()})})}window.onload=(async()=>{await Gn(D),await Gn(de),await jn()})}]);